{
    "componentChunkName": "component---src-templates-blog-article-tsx",
    "path": "/blog/entity-framework-4-3-update-a-complex-object-from-asp-mvc-controller",
    "result": {"data":{"mdx":{"frontmatter":{"title":"Entity Framework 4.3 Update a complex object from Asp.Mvc controller","date":"March 27, 2012"},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Entity Framework 4.3 Update a complex object from Asp.Mvc controller\",\n  \"date\": \"2012-03-27\",\n  \"categories\": [\"asp-mvc\", \"entity-framework\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Having to update an object from an edit action is pretty standard. In fact, it's also very straight forward with basic object (without containing other object). You could use the FormCollection way to do it:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \"[AcceptVerbs(HttpVerbs.Post)] public ActionResult Edit(FormCollection form) { \\n  // Get movie to update \\n  var id = Int32.Parse(form[\\\"id\\\"]); \\n  var movieToUpdate =_db.MovieSet.First(m => m.Id == id);\\n\\n// Deserialize (Include white list!) \\nTryUpdateModel(movieToUpdate, new string[] { \\\"Title\\\", \\\"Director\\\" }, form.ToValueProvider());\\n\\n// If valid, save movie to database \\nif (ModelState.IsValid) {\\n  _db.SaveChanges(); \\n  //... \\n} \\n\")), mdx(\"p\", null, \"Or, you could use the ability of auto binding each http parameters:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \"[HttpPost] \\npublic ActionResult Edit(Course course) { \\n  if (ModelState.IsValid) { \\n    b.Entry(course).State = EntityState.Modified; db.SaveChanges(); \\n    //... \\n} \\n\")), mdx(\"p\", null, \"However, the problem remain that these two examples are only good for object with scalar properties. This mean that it works fine until you have object that reference other object. In real life, you have a lot of change that you will handle complex object that contain reference to many to many others objects or to optional object or to 1 to 1 object.\"), mdx(\"p\", null, \"To be able to handle those scenario, you need to handle scalar data and reference object separately. Here is an example of saving a complex object and its references.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \"public void Update(MyObject obj) { \\n  //Update all but not relationship (scalar properties are updated) \\n  var fromDatabase = Database.Customers.Where(p=>p.Id==customer.ID); \\n  Database.Entry(fromDatabase).CurrentValues.SetValues(obj);\\n\\n  //Update reference \\n  if (obj.OtherObject!= null) { \\n    Database.OtherObjects.Attach(obj.OtherObject); \\n  } \\n  fromDatabase.OtherObject = obj.OtherObject;\\n\\n  return Database.SaveChanges(); \\n} \\n\")), mdx(\"p\", null, \"This check if the reference is null from the form. If yes, it mean that we need to save NULL to be able to have NULL in the foreign key of the database. If not, you need to attach to the Database Context the object (even if this one is not fully loaded, we just need the primary key to be available).\"));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"id":"7ddbd110-642c-5b36-9f52-18df690913fd","totalPages":74}},
    "staticQueryHashes": ["3159585216"]}
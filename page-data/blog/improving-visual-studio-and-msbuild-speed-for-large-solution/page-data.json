{
    "componentChunkName": "component---src-templates-blog-article-tsx",
    "path": "/blog/improving-visual-studio-and-msbuild-speed-for-large-solution",
    "result": {"data":{"mdx":{"frontmatter":{"title":"Improving Visual Studio and MsBuild Speed for Large Solution","date":"April 13, 2016"},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Improving Visual Studio and MsBuild Speed for Large Solution\",\n  \"date\": \"2016-04-13\",\n  \"categories\": [\"msbuild\", \"visual-studio\"],\n  \"tags\": [\"msbuild\", \"performance\", \"visualstudio\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"I am working on a side project that is a single solution with 51 projects. The amount of project is considered \\\"big\\\" for 2016 while it was still considered \\\"medium\\\" few years ago. For some reason, Visual Studio doesn't handles very well project with more than 50 projects. I could refactor the solution by consolidating some projects and having a single project for unit testing instead of 12. Nevertheless, this take some time and before optimizing the design of the solution, let's start by understand what is happening.\"), mdx(\"p\", null, \"First, we need some basic metric. One useful extension to add in Visual Studio is the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://visualstudiogallery.msdn.microsoft.com/b0c87e47-f4ee-4935-9a59-f2c81ce692ab\"\n  }, \"Build Monitor Extension\"), \" by Daniel Vinntreus. This will give you an additional Output with the time of each project to be compiled. The second tool is also free, it is called \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://technet.microsoft.com/en-us/sysinternals/processmonitor.aspx\"\n  }, \"Process Monitor\"), \". This can be download from Microsoft TechNet website. This tool lets you see what the process write on the hard drive (and more). Here was the data from both of these tool. \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"00h 00m 01s 253ms -- MySqlToMsSql \\n00h 00m 03s 898ms -- ModelContracts \\n00h 00m 04s 277ms -- ComplexTypes \\n00h 00m 04s 901ms -- CrossLayer \\n00h 00m 00s 871ms -- TestHelpers \\n00h 00m 01s 139ms -- ComplexTypesUnitTest \\n00h 00m 01s 248ms -- ValueObjects \\n00h 00m 03s 053ms -- CrossLayerUnitTest \\n00h 00m 01s 481ms -- ComplexTypesWithValueObjects \\n00h 00m 03s 586ms -- ComplexTypesWithValueObjectsUnitTest \\n00h 00m 05s 555ms -- ValueObjectsUnitTest \\n00h 00m 05s 747ms -- Model \\n00h 00m 01s 884ms -- ModelBuilders \\n00h 00m 10s 744ms -- ModelUnitTest \\n00h 00m 12s 927ms -- ViewModel \\n00h 00m 12s 527ms -- ModelBuildersTest \\n00h 00m 03s 407ms -- Mapping \\n00h 00m 14s 751ms -- DataAccess \\n00h 00m 03s 980ms -- ViewModelBuilders \\n00h 00m 10s 642ms -- MappingUnitTest \\n00h 00m 10s 708ms -- ViewModelUnitTest \\n00h 00m 11s 235ms -- Services \\n00h 00m 12s 411ms -- WebServicesCore \\n00h 00m 25s 328ms -- DataAccessMigration \\n00h 00m 25s 943ms -- DataAccessUnitTest \\n00h 00m 03s 291ms -- ScriptCleanExpiredOrders \\n00h 00m 16s 434ms -- ServicesIntegrationTest \\n00h 00m 18s 438ms -- ServicesUnitTest \\n00h 00m 20s 570ms -- IoC \\n00h 00m 08s 155ms -- ScriptDailyPerformance \\n00h 00m 05s 538ms -- ScriptBuyOrders \\n00h 00m 08s 966ms -- ScriptInitializeCache \\n00h 00m 08s 522ms -- ScriptEndContests \\n00h 00m 09s 063ms -- ScriptIndiceMarketPoint \\n00h 00m 15s 038ms -- ScriptBotRegisterContest \\n00h 00m 15s 665ms -- ScriptSymbolChange \\n00h 00m 12s 100ms -- ScriptFindUpcomingSplit \\n00h 00m 12s 101ms -- ScriptFindUpcomingSymbolRename \\n00h 00m 12s 011ms -- ScriptBotBuyContest \\n00h 00m 12s 070ms -- ScriptBuyShortOrders \\n00h 00m 14s 895ms -- ScriptEndOfDayBadges \\n00h 00m 21s 934ms -- FrontEndSharingLayer \\n00h 00m 12s 243ms -- ScriptUpdateCompanyInformation \\n00h 00m 23s 498ms -- ScriptSellShortOrders \\n00h 00m 23s 583ms -- ScriptSellOrders \\n00h 00m 34s 100ms -- ScriptSymbolSplit \\n00h 00m 34s 153ms -- ScriptInterdayStatisticPortefolios \\n00h 00m 30s 416ms -- DataAccessIntegrationTest \\n00h 00m 29s 488ms -- WebSite \\n00h 00m 08s 063ms -- Architectures \\n00h 00m 08s 267ms -- WebSiteUnitTest -- Time Elapsed: 00h 02m 51s 635ms \\n\")), mdx(\"p\", null, \"To get these statistics, I first clean up the solution to have the build rebuild everything. The total amount of time is 2 minutes 51 seconds. A lot of time is one project starting with \\\"Script\\\" which are webjob that run in the background. These ones are in Visual Studio under a folder and could be disabled in the future. This is something I was not doing and thus wasting a lot of build time when working on the main project : the website. Process Monitor is also educational by showing how many bytes is written when building the solution. To do so, open Process Monitor, click Filter (Ctrl+L) and add Visual Studio process (Devenv.exe) and MsBuild (msbuild.exe). \"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"995px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/f1b4c04f925f003613f68985b397d700/4cdf7/ProcessMonitorFilter.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"29.666666666666668%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA5UlEQVQY032LS07EMBBEc/+zsOcODIJFRoocJ+7JAo8dy5+M823HNkpArIBXUqukV1047xFxXddlXfY9ppxijPu/xBhTSiGEgrWMENK2LW2a49JGSOm9f/yG934YBq21UkprXRBCLpdXxgAAGEDXdUKIv56dc0IIACjLEgAKKWTbsF6p4XTOOeuctVZrbYxxzv0UYwwA1JRyzquqqiktPjgXSizzkXXbEHEcR875dhYpewxhmicp+3XDQyN+zaZ5Lt7Iy/P7062+8fs9nxximnPOy7Jcy6uxNiDWlCJizjml/D0L4RN4tE/Y4Q50RwAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"ProcessMonitorFilter\",\n    \"title\": \"ProcessMonitorFilter\",\n    \"src\": \"/static/f1b4c04f925f003613f68985b397d700/4cdf7/ProcessMonitorFilter.png\",\n    \"srcSet\": [\"/static/f1b4c04f925f003613f68985b397d700/5a46d/ProcessMonitorFilter.png 300w\", \"/static/f1b4c04f925f003613f68985b397d700/0a47e/ProcessMonitorFilter.png 600w\", \"/static/f1b4c04f925f003613f68985b397d700/4cdf7/ProcessMonitorFilter.png 995w\"],\n    \"sizes\": \"(max-width: 995px) 100vw, 995px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1024px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/70bb3fc9c25210866d999dde9090c6f2/2bef9/WriteFileDuringCompile-1024x601.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"58.666666666666664%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACOklEQVQoz0WRW2/TQBBG80/hqYD4VYgHxOUZCSFVArUVJGmoSEgcbxonttM4ttdeX3J3fNCu29TSJ+/M7pydb7b19sOIl+/+8eL9mIuPDhefZme9/uIavfo8N2ri+Tl+zs9586hWFi1hX1CXEqoS2DWqt5xKSVXEsE1hq6jXCWyaNTt1zrNJmniX0cryksVKkh8gO4Dc1KQ7CNSO69sBv+5G9Ib3dAeCkbOk2xfcWQ594RnZbshwusCNCvwoowU1E1/ytT3j5n5Dbwm3DzVd/8i32xmX/SWX/YDvfzyuRcaPYcjPUcyVlXAjMq5sxbVQdPyKnpPRquuaIs8R1hAVh+gLGlVMhYU/vyd48PBnU9Z5ipIhSRRQKMl+U7DJU8osMefLPG2AaaqwbcHDMmC3Pxjc8VhhjW1mszmev8AWApmkBMGKYBWSpIpUZahHHY6VybUAkiSld9tDxlKH6EtOpwrLsphOp3iejxCCNNXAgNVqhZTSSOeUUhyPR1KVNkCZJLR/t83hZ+AJezzGdV0jDdfFq3BFGIYNTCmT0yPTNUma0NL2tOX+3wHb7e4MrDXQ1pYdPM/DcRxTHEcRURSRyIQsy8iy/Nyh/psZ6hn0+wPKcm02dHf60zZdd47v+0wmEwPU3Rlg0gA1JM9zqqoy+2dgp9NlbI3N4Seg7krDXM9FCNsUa6txHJ9np6FlWZoaM8OnV27/7hDHsrFb1wa4WCyM3anjmG41QD+I7vIJWhQFeZGz3+8p1yX/AUrRdgRXx75GAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"WriteFileDuringCompile 1024x601\",\n    \"title\": \"WriteFileDuringCompile 1024x601\",\n    \"src\": \"/static/70bb3fc9c25210866d999dde9090c6f2/2bef9/WriteFileDuringCompile-1024x601.png\",\n    \"srcSet\": [\"/static/70bb3fc9c25210866d999dde9090c6f2/5a46d/WriteFileDuringCompile-1024x601.png 300w\", \"/static/70bb3fc9c25210866d999dde9090c6f2/0a47e/WriteFileDuringCompile-1024x601.png 600w\", \"/static/70bb3fc9c25210866d999dde9090c6f2/2bef9/WriteFileDuringCompile-1024x601.png 1024w\"],\n    \"sizes\": \"(max-width: 1024px) 100vw, 1024px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"This give us 893 megs written. I am on a SSD drive so it still not bad, but to be honest quite a lot of writing. From here, I noticed few things. First, I have a lot of bin folder with the same files. Second, that we are rebuilding the same file because they referenced them. To improve, I decided to edit all projects to output on the same bin folder. Third, the jobs folder that contains all scripts are heavy on the writing.\"), mdx(\"p\", null, \"I decided to have every project to output in the bin folder of the website. The reason is that I have IIS taking the bin folder as source so every time I build I can just refresh the browser to get the website with the latest version without deploying. After that, I went into all projects references and click reference to other projects and changing the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Copy Local to false\"), \".\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1024px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/281671918506a2dadfd3a2a83ea20fea/2bef9/CopyLocal-1024x377.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"36.66666666666667%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABfElEQVQozz2QS4/TQBCE/f+PHBDSRqzgkOWAuK3gwHLKCYkkSIsgmDg4MZnJ+DmOx6+x8yFPFlrqLqlGU13V3pfP7/jx7YEwWPA7WBDLJfFpRSxXKLl0nao1v/wFs/k9s/lHXrx+z7Pbe57fvuXm1Rte3n3gZv6J2d0D3vrrIwdRIpThqAwirjmeKoSqUGnteJW2bLYx33+GFEVBeTacTUPbNti+pu8tnR0xdYsXxwltW3Ot0c08z8iziqYeGIYnTmuEVJzLhGAXIIWg6zr3drlcpunQk/LEVbRlHEdHGlNzPluqypLnHboYCA85/lZRGcs22LHfH5wzaweHvR3oOouXphlVVbltk+BUWmvqxjjH1lq3Xaqc5XpHFGk2mz2r9SPBLkLIDBVrlCo4qRwvSVKMMUyux/HiBMuyROuSpmlpmulOPVIlrqfKsgzf9wmCgDAMnaF/0b2i0E5gGAYneI1s6Pv+acnVdZaX/JHJ/wRRFCGEcHg8Hl2S6f9fz6cNNWZUy4IAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"CopyLocal 1024x377\",\n    \"title\": \"CopyLocal 1024x377\",\n    \"src\": \"/static/281671918506a2dadfd3a2a83ea20fea/2bef9/CopyLocal-1024x377.png\",\n    \"srcSet\": [\"/static/281671918506a2dadfd3a2a83ea20fea/5a46d/CopyLocal-1024x377.png 300w\", \"/static/281671918506a2dadfd3a2a83ea20fea/0a47e/CopyLocal-1024x377.png 600w\", \"/static/281671918506a2dadfd3a2a83ea20fea/2bef9/CopyLocal-1024x377.png 1024w\"],\n    \"sizes\": \"(max-width: 1024px) 100vw, 1024px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"From there, I cleaned up everything (all bin folder empty) and re-build everything to see how the performance improved. First, the Build Monitor extension is showing some improvements: \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"- 00h 00m 00s 505ms -- ComplexTypes \\n00h 00m 00s 601ms -- ModelContracts \\n00h 00m 00s 352ms -- ComplexTypesUnitTest \\n00h 00m 01s 453ms -- MySqlToMsSql \\n00h 00m 01s 383ms -- ValueObjects \\n00h 00m 03s 002ms -- CrossLayer \\n00h 00m 01s 402ms -- ComplexTypesWithValueObjects \\n00h 00m 01s 488ms -- CrossLayerUnitTest \\n00h 00m 01s 940ms -- TestHelpers \\n00h 00m 02s 924ms -- Model \\n00h 00m 01s 637ms -- ValueObjectsUnitTest \\n00h 00m 01s 806ms -- ComplexTypesWithValueObjectsUnitTest \\n00h 00m 01s 184ms -- ModelBuilders \\n00h 00m 03s 282ms -- ViewModel \\n00h 00m 05s 198ms -- ModelUnitTest \\n00h 00m 02s 993ms -- Mapping \\n00h 00m 05s 746ms -- ModelBuildersTest \\n00h 00m 03s 516ms -- ViewModelBuilders \\n00h 00m 06s 564ms -- DataAccess \\n00h 00m 00s 788ms -- ViewModelUnitTest \\n00h 00m 03s 636ms -- MappingUnitTest \\n00h 00m 03s 634ms -- Services \\n00h 00m 04s 583ms -- DataAccessMigration \\n00h 00m 04s 983ms -- DataAccessUnitTest \\n00h 00m 04s 610ms -- ServicesIntegrationTest \\n00h 00m 06s 222ms -- IoC \\n00h 00m 06s 657ms -- WebServicesCore \\n00h 00m 11s 568ms -- ServicesUnitTest \\n00h 00m 04s 573ms -- ScriptIndiceMarketPoint \\n00h 00m 06s 860ms -- DataAccessIntegrationTest \\n00h 00m 04s 658ms -- ScriptCleanExpiredOrders \\n00h 00m 04s 715ms -- ScriptEndContests \\n00h 00m 05s 408ms -- ScriptInitializeCache \\n00h 00m 05s 637ms -- ScriptDailyPerformance \\n00h 00m 01s 181ms -- ScriptBuyOrders \\n00h 00m 01s 760ms -- ScriptSymbolChange \\n00h 00m 01s 831ms -- ScriptBotRegisterContest \\n00h 00m 01s 770ms -- ScriptFindUpcomingSplit \\n00h 00m 01s 766ms -- ScriptFindUpcomingSymbolRename \\n00h 00m 07s 225ms -- FrontEndSharingLayer \\n00h 00m 09s 518ms -- ScriptEndOfDayBadges \\n00h 00m 09s 531ms -- ScriptBuyShortOrders \\n00h 00m 09s 540ms -- ScriptBotBuyContest \\n00h 00m 08s 867ms -- ScriptUpdateCompanyInformation \\n00h 00m 11s 291ms -- ScriptSymbolSplit \\n00h 00m 11s 304ms -- ScriptSellShortOrders \\n00h 00m 10s 675ms -- ScriptSellOrders \\n00h 00m 02s 717ms -- ScriptInterdayStatisticPortefolios \\n00h 00m 10s 860ms -- WebSite \\n00h 00m 03s 206ms -- WebSiteUnitTest \\n00h 00m 03s 952ms -- Architectures -- Time Elapsed: 00h 01m 32s 275ms \\n\")), mdx(\"p\", null, \"The time to build is cut by half. This is already better. If we take the Process Monitor we can see the reason: we write only 51 megs.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1024px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/9b82793e63c47d7b2e947c2f1def6cee/2bef9/CompileAfterCopyReference-1024x546.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"53.333333333333336%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABxklEQVQoz42T626rMBCEef9X61GiJKUNJmBICPeLgUDumWqWEvXnWckyeNnP41ljJUmCoijQ9z3GccQwDDLO5/N/D9ZxzrMcVl3XaNsWXdfher3icrnIzHVulOcFmqZBVVXyzmfmpnlabxqDru+RxAmsoihlkZDxj7pAa3x+2rBtG0o5CIIAjuPge/uN3W6HIAyhtUYQaKRpKowkjmF1XY+Pj3/wfS1KuTNnz/Ow3mwEuFqtoJQrAHfnSm6/38smYRAgyzKkWToB7/cHlKPgOArDMGKOtjU4RJF8TEBZlmIHraFn19sN/Wny/fV64fF4oMgLWLfbDa7rii9cZJLR1LUoOB6P8H1fwKfT6e0fn9u2k2aSwc2YE+B6vYHWAZ7P5xvYGoMw3ONwOMDzdkizTIonSwxOwwBjjIBnIEVY9/sdi8USzlbhb5imQRiGiKIISikkaSrFBHZti2Ec5fhsIoFsap5mE9C2v0QNk0wwWBTH8e+RPRRliWGYgFTKmzADyWAdc9KU5WIpXZyTjL7vRB2hyp0U8lrJvTVGmsHbwHk+Mi0QhdutIwppsvgICJx/EYfWPvI8fx/ZmEY8pNLr5fI+clVW+AHsHj/zzTCr+QAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"CompileAfterCopyReference 1024x546\",\n    \"title\": \"CompileAfterCopyReference 1024x546\",\n    \"src\": \"/static/9b82793e63c47d7b2e947c2f1def6cee/2bef9/CompileAfterCopyReference-1024x546.png\",\n    \"srcSet\": [\"/static/9b82793e63c47d7b2e947c2f1def6cee/5a46d/CompileAfterCopyReference-1024x546.png 300w\", \"/static/9b82793e63c47d7b2e947c2f1def6cee/0a47e/CompileAfterCopyReference-1024x546.png 600w\", \"/static/9b82793e63c47d7b2e947c2f1def6cee/2bef9/CompileAfterCopyReference-1024x546.png 1024w\"],\n    \"sizes\": \"(max-width: 1024px) 100vw, 1024px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"Finally, if I unload all jobs project (scripts) one, I have a build time of 1m13sec. Not a huge improvement, but still 20 seconds less! The initial performance of \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"2 minutes 51 seconds\"), \" to \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"1 minute 13 secconds\"), \" is quite appreciable. With all these changes some problems raised. First, when pushing the code in the continuous integration (ci) environment, the build server is not able to build the whole solution. This is because the build server builds the startup project which doesn't copy local any references. The second problem is when you deploy. Visual Studio Publish mechanism build the main project too, whence the same consequences. So, we need to add additional steps to build everything and we will come back to have some performance lost.\"), mdx(\"p\", null, \"An other direction is to remove the most possible projects. This approach is fine but limited to what you can group together. For example, I have 1 web project, and about 14 web jobs. This mean a minimum of 15 projects. If we want to divide unit tests from the code, we can add 1 more project. If we want to share webjobs and website logic we add one more project. Still, we have half the number of project and while working on the shared tier and website, it is always possible to unload from the main solution every webjob projects. The best way to move everything is to create a shared project, that I called \\\"ApplicationTier\\\". The website project remains the same but refers this new project. Inside Visual Studio, we need to go one by one in each project to drag-and-drop all files in a folder with the same name of the project. The final result is easy to read and consolidate a lot of project within one but with familiar structure. At the end, the result was very impressive. Instead of taking \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"2 minutes 51 seconds\"), \" the build time was at \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"54 seconds\"), \".\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \" - 00h 00m 00s 775ms -- MySqlToMsSql \\n00h 00m 06s 799ms -- ApplicationTier \\n00h 00m 06s 064ms -- DataAccessMigration \\n00h 00m 03s 400ms -- ApplicationTierUnitTest \\n00h 00m 09s 714ms -- WebServicesCore \\n00h 00m 11s 656ms -- WebSite \\n00h 00m 02s 612ms -- ScriptCleanExpiredOrders \\n00h 00m 02s 312ms -- ScriptFindUpcomingSymbolRename \\n00h 00m 05s 217ms -- ScriptEndContests \\n00h 00m 05s 271ms -- ScriptBuyShortOrders \\n00h 00m 05s 345ms -- ScriptBuyOrders \\n00h 00m 03s 508ms -- ScriptFindUpcomingSplit \\n00h 00m 07s 308ms -- ScriptDailyPerformance \\n00h 00m 08s 350ms -- ScriptSymbolChange \\n00h 00m 08s 447ms -- ScriptBotRegisterContest \\n00h 00m 03s 731ms -- ScriptEndOfDayBadges \\n00h 00m 03s 327ms -- ScriptSymbolSplit \\n00h 00m 04s 775ms -- ScriptBotBuyContest \\n00h 00m 04s 728ms -- ScriptUpdateCompanyInformation \\n00h 00m 02s 835ms -- ScriptSellOrders \\n00h 00m 02s 907ms -- ScriptSellShortOrders \\n00h 00m 01s 714ms -- ScriptInterdayStatisticPortefolios \\n00h 00m 01s 608ms -- ScriptInitializeCache \\n00h 00m 01s 579ms -- ScriptIndiceMarketPoint \\n00h 00m 04s 239ms -- Architectures \\n00h 00m 05s 405ms -- WebSiteUnitTest -- [3] Time Elapsed: 00h 00m 54s 059ms \\n\")), mdx(\"p\", null, \"By reducing the amount of project, we have a lot less references that needs to be cut. The number of megs written on disk is about 550 megs now. The main bottle neck is all the scripts for webjobs. Since all jobs are just entry points to the ApplicationTier, if they share the same bin folder, it will reduce by a lot the building time. This is because that the first script project to build will get the binary files in the bin folder, and subsequent scripts will just build the executable project without building again the references. The result is the following \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"31 seconds\"), \", mainly because only 196 megs go written on the disk.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \" - 00h 00m 01s 633ms -- MySqlToMsSql \\n00h 00m 06s 483ms -- ApplicationTier \\n00h 00m 06s 696ms -- DataAccessMigration \\n00h 00m 01s 458ms -- ApplicationTierUnitTest \\n00h 00m 08s 610ms -- WebServicesCore \\n00h 00m 09s 298ms -- WebSite \\n00h 00m 01s 044ms -- ScriptCleanExpiredOrders \\n00h 00m 00s 719ms -- ScriptFindUpcomingSymbolRename \\n00h 00m 01s 140ms -- ScriptFindUpcomingSplit \\n00h 00m 02s 132ms -- ScriptDailyPerformance \\n00h 00m 02s 282ms -- ScriptBuyOrders \\n00h 00m 02s 216ms -- ScriptBotRegisterContest \\n00h 00m 02s 477ms -- ScriptBuyShortOrders \\n00h 00m 02s 295ms -- ScriptSymbolChange \\n00h 00m 00s 771ms -- ScriptEndOfDayBadges \\n00h 00m 02s 619ms -- ScriptEndContests \\n00h 00m 00s 811ms -- ScriptUpdateCompanyInformation \\n00h 00m 00s 858ms -- ScriptBotBuyContest \\n00h 00m 00s 764ms -- ScriptSymbolSplit \\n00h 00m 03s 963ms -- ScriptSellShortOrders \\n00h 00m 04s 022ms -- ScriptSellOrders \\n00h 00m 03s 957ms -- ScriptInitializeCache \\n00h 00m 04s 030ms -- ScriptInterdayStatisticPortefolios \\n00h 00m 03s 683ms -- ScriptIndiceMarketPoint \\n00h 00m 04s 649ms -- WebSiteUnitTest \\n00h 00m 01s 533ms -- Architectures -- Time Elapsed: 00h 00m 31s 471ms \\n\")), mdx(\"p\", null, \"I quickly started the RamDisk tool to see if having the scripts bin folder could benefit of it and I haven't see any improvement. Finally, I am pretty happy of the end result. I can always unload all scripts and this can be done easily since they are inside a folder. Inside Visual Studio, right click the folder that contain these folders and click \\\"unload project\\\". This will unload all of them in 1 operation. For further optimization, we could also unload the migration project and unit tests and by doing so having less than 20 seconds of total build time.\"));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"id":"660e5dc7-9036-5c2b-bbc2-a66c04b7e3c7","totalPages":73}},
    "staticQueryHashes": ["3159585216"]}
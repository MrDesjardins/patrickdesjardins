{
    "componentChunkName": "component---src-templates-blog-article-tsx",
    "path": "/blog/c-system-transactions-namespace",
    "result": {"data":{"mdx":{"frontmatter":{"title":"C# System.Transactions namespace","date":"October 1, 2011"},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"C# System.Transactions namespace\",\n  \"date\": \"2011-10-01\",\n  \"categories\": [\"c-sharp\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"You can use you DbConnection to get your transaction but the System.Transactions namespace give you an other option for handling transaction.\"), mdx(\"p\", null, \"This namespace work with SQL Server 2005 and later and offers support for \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"distributed transactions\"), \". At first, this transactions namespace will handle the transaction has a \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"local lightweight transaction\"), \" but if detect that multiple connection is open that the transaction switch to \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"distributed transactions\"), \". This behavior is also known as \\\"implicit transaction\\\" because the developer does not explicit how to handle it.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"382px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/7d6b56d74da40938fc4f9d71933849ae/77edc/dtc.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"29.000000000000004%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABO0lEQVQY03XPS06DQACAYe7o2oXRVI0H8QLGZRPjQk18NOpWTbqwUWzLo0BbBsoMwwClPGbAtkJhXKhLv/wX+AXgBmhmzwBwLIAcxwGgLEv+n6bhnGdx5GPoObYwcUNVA7IOhqo5MZ3RBBkmNExo2t7YwmzdLCuernmQ15LpiTryaDV1k9eh+a7awoOxanWqg055eF/v3latzmbvZr19tdq5Lvfvvo4e+dZlc/y8uhh8njwFpy/zs4/luVi0e1m7RwUVRl0JimP/TfeteOMVnBQcUQ4pRxmHaTONarLIc5ZrqgaRlxfLjOaUFZQVwoxEEcEEQeK6oYeTRRgFJInmoY+b38+aMrZIKSZ+MI+TjMUp/UnQHV+W5L7YVyRZUUYDsS/LsqqohjY2dAO7eFPXjLE0TS0ALGBRSrM/3z4NO7sTXuALAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"dtc\",\n    \"title\": \"dtc\",\n    \"src\": \"/static/7d6b56d74da40938fc4f9d71933849ae/77edc/dtc.png\",\n    \"srcSet\": [\"/static/7d6b56d74da40938fc4f9d71933849ae/5a46d/dtc.png 300w\", \"/static/7d6b56d74da40938fc4f9d71933849ae/77edc/dtc.png 382w\"],\n    \"sizes\": \"(max-width: 382px) 100vw, 382px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"For example, here is the example we previously did with the SqlDbConnection with the use of the System.Transactions instead of the one provided by the connection.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \"public int SaveCustomers(IEnumerable<Customer> customers) { ConnectionStringSettings connectionStringSettings = ConfigurationManager.ConnectionStrings[\\\"ApplicationServices\\\"];\\n\\nint rowsAffected=0; using (var connection = new SqlConnection(connectionStringSettings.ConnectionString)) { connection.Open(); using (System.Transactions.TransactionScope ts = new System.Transactions.TransactionScope()) { using (var command = new SqlCommand()) { command.Connection = connection; foreach (var customer in customers) { if (customer.IsNew) { command.CommandText = \\\"INSERT INTO customers (CustomerID, CompanyName) VALUES (@id, @name)\\\"; } else { command.CommandText = \\\"UPDATE customers SET CompanyName = @name WHERE CustomerID = @id\\\"; } command.CommandType = System.Data.CommandType.Text; command.Parameters.Clear(); //Remove command.Parameters.Add(new SqlParameter(\\\"id\\\", customer.Id)); command.Parameters.Add(new SqlParameter(\\\"name\\\", customer.Name)); rowsAffected += command.ExecuteNonQuery(); }\\n\\nts.Complete(); } } connection.Close(); } return rowsAffected; } \\n\")), mdx(\"p\", null, \"As you can see, few lines have been removed and some changed. You will notice that we do not have anymore any try-catch. That's right, the USING handle any problem and if the \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Transaction.Complete()\"), \" is not called, it's automatically a RollBack. If multiple connections are inside the transaction using, all of them will be under the scope of the transaction distributed transactions coordinator.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"400px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/3f869d5f1dad931bcc8c6e78de6c7730/e17e5/transactionDLL-400x339.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"84.66666666666669%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAADZUlEQVQ4y02Ta0/jRhSG8/+/VOqHqn+gqrSVulVvLKwWlgAhhFxJnMR3O7Ed32+JHWAXnsqTgGrp1cyZGb/nvOfS+uPzkJMriU/XQ/5tD/jUXfJ3f82HG5OP/Q1/jiI+9n1+6zr8em3xS9vg957D2TTicplyKfn8ddLm8uef+PLjD7RuhgssJ2Dlhei2i2K5LM0Nku4h6S6yHTA3NswND9WJMbxUYBUUOFGJG5e4YY4XZthuSGs0k0lCnziKmU2njIZDRoM+vW6X8XDAcNBnNn2g3+vhuQ5lnpEl8TvSI7I0xfd9WoOHBYHvI83m2LaNrukYhoGiqGiaTpIkFGVJud2SZRlJkpLluYDYZznp8dz1NrQm0pI0TVnZKwzdxDQtLGvFdldR13t2VS0eq6pGGCXsqgpdMzB0S9ytV2tBFIThgbA3WYqQm8hMw8I0TRRZxdRNXNclimKKYitIttsdLy8vwrk0k8iLkiROsC2bOI4PhLfjJVmaYOiG8NZAkRVcx+Xp8Ylvz89UVY1lWiLi5mscLSRJOCqLAssw8TzvQNgdy4JQ0zRMwxSQlzLyQhaR7naVQHNeV7UgXK3WzKW5iLAoCqFuvT5Ib7V7E/KsiVBnZdusbAtdUVlZFvv9gaCuGkLj3XYdB2k6pSy3FHkm3r5L7owWwpjLOrJqMV9qRGlJ9fid/Teon16Isx1LxSDJK/bPr+imw2g8w48L/ChDUU3Ct6LcDuesvYjTzoKvfZ2zzoLznsLd3GfuPqLHr4z0nPOeysQqkf1nLocmJ+0HBmrKQI1p9xX84Eh41Xsgz9KDZMtCUxSx11UVf+NR7bZst1ss02Rf/0/y7E1yLv6LouhN8rFtjlVWZUUkuamqpmjiLE0y0RrVsSiO4zKXmrbZkue5cNZMiSC8vp+SxLFo3GY6Fosly6bKsiKavPHc9GKTo2ZqmhGLwlAgjhOR/81mQxgeI2zfTcSjjR8I+Me1QRCEBGEk1uaHJk+OH+IGMW4QsWnuj3dhFOG4G1o3A4nX70/U1Y7HumJ/xOO+ft/XjV3vSIqSqRvTW+hM7A1LN2C9sphOxuiaKpq79eGfC677D1x0R7TvxlyJdcTFzT1fO33a3aGwbwczrvtTzjojTq8HnHZGfLkdc9Hp87l9x/nNPRedIf8B7STUQk21SiQAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"transactionDLL 400x339\",\n    \"title\": \"transactionDLL 400x339\",\n    \"src\": \"/static/3f869d5f1dad931bcc8c6e78de6c7730/e17e5/transactionDLL-400x339.png\",\n    \"srcSet\": [\"/static/3f869d5f1dad931bcc8c6e78de6c7730/5a46d/transactionDLL-400x339.png 300w\", \"/static/3f869d5f1dad931bcc8c6e78de6c7730/e17e5/transactionDLL-400x339.png 400w\"],\n    \"sizes\": \"(max-width: 400px) 100vw, 400px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"Unfortunately, this namespace is only pertinent if you use Sql Server 2005 and more. In fact, you should always use this one if you are in a Microsoft Sql server 2005, 2008 and more. The only time that it's not possible to use it is with other type of database. The reason to use this one instead of the ADO.NET transactions is the automatic handling of lightweight transaction and distributed transactions.\"), mdx(\"h2\", null, \"Transaction Scope Options\"), mdx(\"p\", null, \"System.Transactions let you set you set a type for you transaction via the enumeration TransactionScopeOption.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"400px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/d20ef0e4f6585d5fe21d216c714885a2/e17e5/transactionScopeOption-400x68.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"17%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAtUlEQVQI1x2KYW+CMABE+f+/a3HgomkWFxcIFOoqtWpoSUekoG9ZP7y8u8tlzg147xjHEe99wjmX8MNAnGdezyfrurIskSVGYowpT9PE/XbhZnt+g2d+BLLN25b3zQdFsSfPdxT5Lnlb7NMuxBeHwzfHY01VtchWI+UPUmqapqOpPpFNRX8+8VofZF13put6klWfzv9dKYM6GdpWU9cquTd3rHVc7IC9erS2lGWJEAJjDCEE/gCmeNy/32JYUAAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"transactionScopeOption 400x68\",\n    \"title\": \"transactionScopeOption 400x68\",\n    \"src\": \"/static/d20ef0e4f6585d5fe21d216c714885a2/e17e5/transactionScopeOption-400x68.png\",\n    \"srcSet\": [\"/static/d20ef0e4f6585d5fe21d216c714885a2/5a46d/transactionScopeOption-400x68.png 300w\", \"/static/d20ef0e4f6585d5fe21d216c714885a2/e17e5/transactionScopeOption-400x68.png 400w\"],\n    \"sizes\": \"(max-width: 400px) 100vw, 400px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Required\\nIf a transaction exist, a new declaration of the a transaction will simply join the first one. If none is defined, a new transaction will be initiated. This can be useful in the scenario that you that you have 1 method that call 2 methods. You put the a transaction and inside you add the two methods. Inside those methods you can have some database call with or without transaction scope. At the end, all will be under the same transaction. This is very powerful and let you have atomic transaction over multiple methods.- RequiresNew\\nThis will create a new independent transaction. This can be useful if you want to execute something what ever the state of the existing transaction. For example, you have a logging system that log data into the database. You may want to log even if they are problem.- Suppress\\nThis remove the transaction behavior for all call inside the transaction. This give you the leverage to do stuff outside the transaction while being inside an existing transaction.\")), mdx(\"p\", null, \"The use of System.Transactions to handle DTC is very useful. First, it let you use Lightweight Transaction Manager(LTM) instead of DTC when possible. This give you a big performance boost. Second, you do not need to inherit from ServicedComponent, so you can have cleaner object with the possibility to inherit from what you desire. The last thing is that it does not use any COM+ object. So nothing is loaded in the Component Services.\"));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"id":"98c0a73f-aa17-5466-9e2b-45ee10ab005e","totalPages":68}},
    "staticQueryHashes": ["3159585216"]}
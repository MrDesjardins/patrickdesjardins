{
    "componentChunkName": "component---src-templates-blog-article-tsx",
    "path": "/blog/application-insights-build-version-on-all-telemetry",
    "result": {"data":{"mdx":{"frontmatter":{"title":"Application Insights Build Version on all telemetry","date":"December 15, 2016"},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Application Insights Build Version on all telemetry\",\n  \"date\": \"2016-12-15\",\n  \"categories\": [\"asp-mvc\", \"azure\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Something very interesting is to know which version was affected by a telemetry. This is good for custom events, traces and very interesting for exceptions. However, adding this information on every calls are redundant and not clean. That is why, Application Insights allows you to add a \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"telemetry initializer\"), \".\"), mdx(\"p\", null, \"A telemetry initializer is a a piece of code that is executed when a telemetry starts. There is two steps to make it works. First, create a class that inherit \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ITelemetryInitializer\"), \". Second, register the class to Application Insights.\"), mdx(\"p\", null, \"To accomplish the goal of having the system version in every telemetry, let's create a class that will add in Application Insights' context a property named \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"BuildVersion\"), \". I place this class in my website project which allows me to grap the assembly version. Indeed, you need to use the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"AssemblyInfo.cs\"), \" file and its versions on every release to have this method to work. \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \"public class AssemblyVersionInitializer : ITelemetryInitializer { \\n   public void Initialize(Microsoft.ApplicationInsights.Channel.ITelemetry telemetry) { \\n     telemetry.Context.Properties[\\\"BuildVersion\\\"] = this.GetType().Assembly.GetName().Version.ToString(); \\n  }\\n} \\n``` The next and final step is to use this class.\\n\\n\\n```csharp\\n public class MvcApplication : System.Web.HttpApplication { \\n   protected void Application_Start() { \\n     TelemetryConfiguration.Active.TelemetryInitializers.Add(new AssemblyVersionInitializer()); \\n  } \\n} \\n\")), mdx(\"p\", null, \"From there, what ever you add or not custom properties, it will always have also the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"BuildVersion\"), \" one. The goal of having this BuildVersion is primary to see difference in your telemetries between version. You can clearly identify if a problem is resolve or is created between version. You can also see if the performance goes worse. However, this only work if you release often since Application Insights retention of the information if very limited with most of the data is restricted to 7 days (or 14 days).\"));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"id":"89fdc6c7-90bd-50e4-b111-6ef0639b3c56","totalPages":68}},
    "staticQueryHashes": ["3159585216"]}
{
    "componentChunkName": "component---src-templates-blog-article-tsx",
    "path": "/blog/entity-framework-and-detectchanges",
    "result": {"data":{"mdx":{"frontmatter":{"title":"Entity Framework and DetectChanges","date":"June 24, 2014"},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Entity Framework and DetectChanges\",\n  \"date\": \"2014-06-24\",\n  \"categories\": [\"entity-framework\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"DetectChanges\"), \" can be set to false inside the configuration of the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"DbContext\"), \".\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \" public class YourContext : DbContext { public YourContext(): base(\\\"DefaultConnection\\\") { this.Configuration.AutoDetectChangesEnabled = false; } } \\n\")), mdx(\"p\", null, \"or can be turned off for the context life cycle:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \" using (var context = new YourContext()) { context.Configuration.AutoDetectChangesEnabled = false; } \\n``` This will increase the overall performance of Entity Framework because it will not execute the verification of changes of the entities inside the **DbContext** and the database. Disabling the auto detection of changes come with the cost that if you do not call it manually that you will not have the good result.\\n\\nIn the case that the AutoDetectChangesEnabled is kept to true, or set to true again, than you can be sure that a verification is done when:\\n\\n- DbSet.Add\\n- DbSet.Find\\n- DbSet.Remove\\n- DbSet.Local\\n- DbSet.Attach\\n- DbContext.SaveChanges\\n- DbContext.GetValidationErrors\\n- DbContext.Entry\\n- Any Linq query on DbSet\\n\\nIf you are doing few queries or that you add several new entities you may want to detect change only after all commands instead of letting Entity Framework detecting change on every command.\\n\\nTo tell Entity Framework to detect changes, you must use the **DbContext** and call the **ChangeTracker** property that has the **DetectChanges** method.\\n\\nThe followed example will not update the user. \\n```csharp\\n private static void DetectChangesExample() { using (var context = new YourContext()) { context.Configuration.AutoDetectChangesEnabled = false; var personToModify = context.Persons.Find(1); personToModify.BirthDate = new DateTime(3050,12,12); context.SaveChanges(); } } \\n``` This is because the DbContext does not know about the change of the Person Id 1. If we change the above code by adding the DetectChanges than the database is notified of the changes.\\n\\n\\n```csharp\\n private static void DetectChangesExample() { using (var context = new YourContext()) { context.Configuration.AutoDetectChangesEnabled = false; var personToModify = context.Persons.Find(1); personToModify.BirthDate = new DateTime(3050,12,12); context.ChangeTracker.DetectChanges(); context.SaveChanges(); } } \\n\")), mdx(\"p\", null, \"It is also possible to get from the Entry collection the state of the entity. If we execute both example by adding a simple check of the state, the one that has auto detect changes to false will return an unmodified state while the other one will have a modified state.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"400px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/d826455da0faec3bb11003df794e241c/e17e5/Unchanged-400x96.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"24%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA+0lEQVQY043QTU6DUBiFYVZj68S4q1qLiZp0Fa7HgSb+hMahcaq01UKhFywXepFCQbivaaMMnOiXPDlnePIZUmqUAqVKVokikoqsKPhsGn5Oa/1vRppWBCLG91x8PyCSKa4IcBcCEYTIJCZbNxQbTaM19R+Msqp4my+wx2Ns22Y6HeO9eoi5YDaZ4Lw8k4gQnRfbrbBdrn9p6jaNotzgLH1mgYPt2nihy1MccPnucZMsuY4EV0vBfRpjZSusj4RRphh9dytLuE0ld6nksdEYdV1TbkqqqmKd57ufXVgPHJwNOTwf0u2b7B+f0OmbdI4GO3u9QdtbvQFd85Qv58ZjaOgwrj8AAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Unchanged 400x96\",\n    \"title\": \"Unchanged 400x96\",\n    \"src\": \"/static/d826455da0faec3bb11003df794e241c/e17e5/Unchanged-400x96.png\",\n    \"srcSet\": [\"/static/d826455da0faec3bb11003df794e241c/5a46d/Unchanged-400x96.png 300w\", \"/static/d826455da0faec3bb11003df794e241c/e17e5/Unchanged-400x96.png 400w\"],\n    \"sizes\": \"(max-width: 400px) 100vw, 400px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"With DetectChanges: \", mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"400px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/3901ee40a64a2e793f748a6a8bb74e12/e17e5/StateChanged-400x157.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"39.333333333333336%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjUlEQVQoz5WRTY7TQBCFO9JsuAMs2MAB2A0r0CAOwQlGsOAAHI0j4IjJn53YsR1P8DjTdtuJ48Ttv29kDyyGDeJJn0qqbr0qvRJJUhKGR9K0Ic/hcIA0zUhVQhJLiqLgj7qu+yfidKoGIyk1+33N4VCS5zl5XqL2Ofm5pKxbqqriqbqBtnuK6JtZViHlCaWOxPE9cRyTJGfSwxmZ7YlUOvT6bXu01hyLDq1b/pZo23aYFP5SOI6DbdvcTCZ43pqN72KvHFw3YLVeYy6XmKY1RKJUw7lsSbsGqSviqh4QTdPQNC13MiEII1zPw/d9fM/H81yiSOHfJgS7ezbhHbazwg8CdtEtnlR8M5Z8mS74PLW4/jlH9EH2csOIhRcwn8/5YRjMplNmsxmWZTKZ3DA2xnj+mvFyjLVZYfsm340Fl5++8ubqHa8v3/Ls+YtHw35LlWbsZIyUku12O9Afp3/TVTUcpc9OlyW61LRaExY1r95/RAjBSIihiv5TXdf8j7rfdQ+8vPrwaHhxgRiNeACnI0IEbZDGlQAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"StateChanged 400x157\",\n    \"title\": \"StateChanged 400x157\",\n    \"src\": \"/static/3901ee40a64a2e793f748a6a8bb74e12/e17e5/StateChanged-400x157.png\",\n    \"srcSet\": [\"/static/3901ee40a64a2e793f748a6a8bb74e12/5a46d/StateChanged-400x157.png 300w\", \"/static/3901ee40a64a2e793f748a6a8bb74e12/e17e5/StateChanged-400x157.png 400w\"],\n    \"sizes\": \"(max-width: 400px) 100vw, 400px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"Something interesting about \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Complex Type\"), \" is that the whole class has a simple state. If you change one property of the whole class that is marked as complex type, the whole complex type is market has modified. The reason is that Entity Framework does not create a proxy object for complex type.\"), mdx(\"p\", null, \"This say, you must use DetectChanges before saving otherwise your changes will never reach the database. You can find the code in this post on \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/MrDesjardins/EntityFrameworkTestConsole/tree/94af9ed008a3cd021a7cd8732cbb1f9a3f375e03\"\n  }, \"GitHub\"), \" or get the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/MrDesjardins/EntityFrameworkTestConsole/archive/94af9ed008a3cd021a7cd8732cbb1f9a3f375e03.zip\"\n  }, \"Zip file\"), \".\"));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"id":"52b86c23-458e-5472-b142-385378c9724d","totalPages":69}},
    "staticQueryHashes": ["3159585216"]}
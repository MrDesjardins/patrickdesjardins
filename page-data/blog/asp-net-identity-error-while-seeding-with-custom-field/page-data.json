{
    "componentChunkName": "component---src-templates-blog-article-tsx",
    "path": "/blog/asp-net-identity-error-while-seeding-with-custom-field",
    "result": {"data":{"mdx":{"frontmatter":{"title":"Asp.Net Identity error while seeding with custom field","date":"January 21, 2014"},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Asp.Net Identity error while seeding with custom field\",\n  \"date\": \"2014-01-21\",\n  \"categories\": [\"asp-mvc\", \"entity-framework\", \"identity\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"If you are using the new Asp.Net Identity framework which is working with OWIN, you may fall with a SQL exception. This exception look like this :\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"System.Data.SqlClient.SqlException: Invalid column name 'UserId'\")), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"400px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/eb1b8df2a9c37fc8392ce972a84d9be7/e17e5/SeedingError-400x58.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"14.666666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAApklEQVQI1z2OQQ7CMAwE+376BX7ABxBC4gAImqQVidPWTlPgABck3rAoRnBYjde2VlsZa2FdC9d2uPiAKc+QNGEYWcmSlHm+qtKU/z9fZkgS5HkNlg0q52oYu0Db1SqKB1Bk+BDQDyN8IIwskJQQKCL2g5JiD6IIH8pMCLQEywqV9w2M3eNw3OJ03sHYRoNKw6ISxiwapP63k6S+3EZOuN1feDzf+AB5J8/wlT4L6AAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"SeedingError 400x58\",\n    \"title\": \"SeedingError 400x58\",\n    \"src\": \"/static/eb1b8df2a9c37fc8392ce972a84d9be7/e17e5/SeedingError-400x58.png\",\n    \"srcSet\": [\"/static/eb1b8df2a9c37fc8392ce972a84d9be7/5a46d/SeedingError-400x58.png 300w\", \"/static/eb1b8df2a9c37fc8392ce972a84d9be7/e17e5/SeedingError-400x58.png 400w\"],\n    \"sizes\": \"(max-width: 400px) 100vw, 400px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"The UserId is a column that is ignored in the configuration of the entity. Why does it try to read from it?\"), mdx(\"p\", null, \"Here is how the DbContext looks like: \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \" public class Configuration : DbMigrationsConfiguration<DatabaseContext> { public Configuration() { }\\n\\nprotected override void Seed(DatabaseContext context) { var userStore = new UserStore<ApplicationUser>(); var manager = new UserManager<ApplicationUser>(userStore);\\n\\nvar role = new IdentityUserRole { Role = new IdentityRole(Model.Roles.ADMINISTRATOR) }; var user = new ApplicationUser() { UserName = \\\"123123\\\", Email = \\\"123123@123.com\\\", Language = \\\"en-US\\\" }; user.Roles.Add(role); IdentityResult result = manager.Create(user, \\\"123123\\\");\\n\\nvar role2 = new IdentityUserRole { Role = new IdentityRole(Model.Roles.NORMAL) }; var user2 = new ApplicationUser() { UserName = \\\"qweqwe\\\", Email = \\\"qweqwe@qweqwe.com\\\", Language = \\\"fr-CA\\\" }; user.Roles.Add(role2); IdentityResult result2 = manager.Create(user2, \\\"qweqwe\\\"); //... } } \\n\")), mdx(\"p\", null, \"The problem reside on the first line of the seeding method. The UserStore takes in its first parameter the database context. Since I am not explicitly telling the UserStore to take the one passed by parameter, it does not know about the configuration defined in the DatabaseContext.\"), mdx(\"p\", null, \"To solve the problem just change the first line with this line:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \" var userStore = new UserStore<ApplicationUser>(context); \\n\")));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"id":"45f06cb3-e501-5e40-bba1-09c807ce5026","totalPages":69}},
    "staticQueryHashes": ["3159585216"]}
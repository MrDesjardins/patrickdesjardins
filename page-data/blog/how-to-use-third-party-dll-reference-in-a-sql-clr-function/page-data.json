{
    "componentChunkName": "component---src-templates-blog-article-tsx",
    "path": "/blog/how-to-use-third-party-dll-reference-in-a-sql-clr-function",
    "result": {"data":{"mdx":{"frontmatter":{"title":"How to Use Third Party Dll Reference in a SQL CLR Function","date":"September 9, 2015"},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"How to Use Third Party Dll Reference in a SQL CLR Function\",\n  \"date\": \"2015-09-09\",\n  \"categories\": [\"sql\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"In a previous article, I was using a SQL CLR function written in C# to be executed by SQL server during a migration of account. The reason was to use the hashing code from Asp.Net Identity that is used by Entity Framework and Asp.Net. In that article, instead of using a copy of the code of the real implementation, we are going to use the real Asp.Net Identity dll. Our C# Dll will just be a proxy to the third party.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \" [Microsoft.SqlServer.Server.SqlFunction] public static SqlString HashPassword2(string plainPassword) { var hasher = new Microsoft.AspNet.Identity.PasswordHasher(); return hasher.HashPassword(plainPassword); } \\n\")), mdx(\"p\", null, \"The code is way simpler, and reuse the Microsoft Asp.Net code which is interesting. The problem is that SQL project does not allow to use NuGet. It's not possible to get the reference from a NuGet package. So, we need to select the DLL from the browse window of the reference. The simple way to do it is to select the one in the Bin folder of you Asp.Net MVC project. Once done, we still need to do something to allow SQL to read it. If you do not, it will compile but not publish.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \" Creating [MySqlToMsSql]... (63,1): SQL72014: .Net SqlClient Data Provider: Msg 6503, Level 16, State 12, Line 1 Assembly 'microsoft.aspnet.identity.core, version=2.0.0.0, culture=neutral, publickeytoken=31bf3856ad364e35.' was not found in the SQL catalog. (63,0): SQL72045: Script execution error. The executed script: CREATE ASSEMBLY [MySqlToMsSql] AUTHORIZATION [dbo] FROM 0x4D5A9000... An error occurred while the batch was being executed. \\n\")), mdx(\"p\", null, \"To fix that issue, we need to go in the property of the third-party DLL added to the project.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"400px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/fa494921db593b9effa5feb95a4c6320/e17e5/PropertyOfThirdParty-400x130.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"32.666666666666664%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABlklEQVQoz1WR24vTUBDG85f7oIgoKFovT1YX0QdBsOu++KD45LKuD9q11Hbb7eWkae5NsjlJTprLT04sggMfH8wM33wzY9y8f8SNu31uPXjFnd4bbj98zb2nb3n84phef0Cvf3zAgEfPBzx5+YFnRydcjCbEnslamChVoKNtW4yV6SM2PpttiOVEWPYO20sIohw/lHih7DiIMoJdRpQolsJnOJrgbJcsFkuuU0ndNDRa0HVD0rQgSTKSRHYcxxLLcvC8AM8PCYIdaZp1yAuF7QQMf40R60vGFz/wHQtoOpeG63pUVUVd1/8hCHzyPEepEqUUUmpBSaEFtzafv885v4r48nPFb2fPIoJZ0GJMp7POslL7rrkoSvJcIYSDEBamucGybLKs6HqqqsH3fN6frvg0r3n3dcnHUcy3DZyKFmM+nyOl7Ow2TdtxmlZMJhauK6mqPWVZ0ugbHepBGDObLaBMEYspvi0OK7cY+qh6Zf2huv6bTJKSs7NLXC//9z0tpkV1xHHK+XDMdHXFei24TjP0rLpp+QOAJQQlPU0HswAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"PropertyOfThirdParty 400x130\",\n    \"title\": \"PropertyOfThirdParty 400x130\",\n    \"src\": \"/static/fa494921db593b9effa5feb95a4c6320/e17e5/PropertyOfThirdParty-400x130.png\",\n    \"srcSet\": [\"/static/fa494921db593b9effa5feb95a4c6320/5a46d/PropertyOfThirdParty-400x130.png 300w\", \"/static/fa494921db593b9effa5feb95a4c6320/e17e5/PropertyOfThirdParty-400x130.png 400w\"],\n    \"sizes\": \"(max-width: 400px) 100vw, 400px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"The property about \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Model Aware\"), \", \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Is Visible\"), \" and \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Generate Sql Script\"), \" must be set to true.\"));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"id":"2517568c-9be6-560b-aee9-e0a17669cc23","totalPages":68}},
    "staticQueryHashes": ["3159585216"]}
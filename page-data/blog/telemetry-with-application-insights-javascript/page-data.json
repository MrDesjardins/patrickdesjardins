{
    "componentChunkName": "component---src-templates-blog-article-tsx",
    "path": "/blog/telemetry-with-application-insights-javascript",
    "result": {"data":{"mdx":{"frontmatter":{"title":"Telemetry with Application Insights JavaScript","date":"February 2, 2016"},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Telemetry with Application Insights JavaScript\",\n  \"date\": \"2016-02-02\",\n  \"categories\": [\"azure\"],\n  \"tags\": [\"applicationinsights\", \"azure\", \"telemetry\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Application Insights is a system that run on Azure that lets you send information about your application. I will not go in detail in that post about all its capability. I suggest you read the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://azure.microsoft.com/en-us/documentation/articles/app-insights-overview/\"\n  }, \"overview\"), \" page from the official documentation. This article goal is to use Application Insights to collection information about two buttons that go to the the same page to figure out which one is the most popular. Since both links are normal Html link, we need to use JavaScript to bind the click event to both buttons and send the telemetry before moving to the actual page.\"), mdx(\"p\", null, \"The first step is well documented which is to add the Telemetry to the web project. The detail are also explained in the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://azure.microsoft.com/en-us/documentation/articles/app-insights-asp-net/\"\n  }, \"documentation\"), \". In short, it consists to get the right Nuget Package, create the Azure Application Insights account (needed to get a key) and then setup the Global.asax.cs + set the JavaScript that will collect client side telemetry. What is not really well clear is that you need to setup the maxBathSizeInBytes to zero if you want to get the telemetry sent very fast. This is required if you want it on a click event that leave the page. This is not required if you have a single page application that remains on the same page. The setup code look like the following:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"<script type=\\\"text/javascript\\\"> var appInsights=window.appInsights||function(config){ function r(config){t[config]=function(){var i=arguments;t.queue.push(function(){t[config].apply(t,i)})}}var t={config:config},u=document,e=window,o=\\\"script\\\",s=u.createElement(o),i,f;for(s.src=config.url||\\\"//az416426.vo.msecnd.net/scripts/a/ai.0.js\\\",u.getElementsByTagName(o)[0].parentNode.appendChild(s),t.cookie=u.cookie,t.queue=[],i=[\\\"Event\\\",\\\"Exception\\\",\\\"Metric\\\",\\\"PageView\\\",\\\"Trace\\\"];i.length;)r(\\\"track\\\"+i.pop());return r(\\\"setAuthenticatedUserContext\\\"),r(\\\"clearAuthenticatedUserContext\\\"),config.disableExceptionTracking||(i=\\\"onerror\\\",r(\\\"_\\\"+i),f=e[i],e[i]=function(config,r,u,e,o){var s=f&&f(config,r,u,e,o);return s!==!0&&t[\\\"_\\\"+i](config,r,u,e,o),s}),t }({ instrumentationKey: \\\"@Microsoft.ApplicationInsights.Extensibility.TelemetryConfiguration.Active.InstrumentationKey\\\", maxBatchSizeInBytes: 0 });\\n\\nwindow.appInsights=appInsights; appInsights.trackPageView(); </script> \\n\")), mdx(\"p\", null, \"The second step is to add event on each link that you want to collect the click.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"function attachTelemetries() { $('#all-contests').click(function () { appInsights.trackEvent(\\\"BestLinkLocation\\\", { LinkDestination: \\\"Contest/List\\\", LinkPageLocation: \\\"DirectTopMenu\\\" } ); appInsights.flush() }); $('#user-contests').click(function () { appInsights.trackEvent(\\\"BestLinkLocation\\\", { LinkDestination: \\\"Contest/List\\\", LinkPageLocation: \\\"SubMenu\\\" } ); appInsights.flush() });\\n\\n} \\n\")), mdx(\"p\", null, \"You can use the \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"appInsights\"), \" variable, defined when setuping Application Insights with the method \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"trackEvent\"), \". The method take a name for the telemetry captured following by properties and if needed some metric. In our case, we can just sum the each properties (each link location) and determine which one is the most popular. Something not clear in the documentation is that it is required to call the \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"flush\"), \" method. The reason is that once the click event is done, the browser move to the next page. Flush ensures that the telemetry is sent. \", mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"465px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/fc2bb42d6717df1fbc718abdc4495cb5/9ff85/Events.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"176.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAjCAIAAAAblL1PAAAACXBIWXMAABYlAAAWJQFJUiTwAAAD2UlEQVRIx5VUTW/cRBj2vX+BU0m6u971fnh3k7BpkiZBAQkCCpQoCAoS5cYP6JETXDj0UIkbd/5CDz0AhwpQ1ZANSA0pYTebzcZfY3vGnhnPF9hOqiQk6fLokS2N/cy87/O+82pFwywa5mSlVjQak3p9Uq/lzwm9NlGqFsr1/IeiYRrmVKHSmJpd6Mwvl6rN9mvzWtEwS0ZzprmsV1rtznxnfmmqszB989bsrdfnFlcaU7OFSiMXVxrtUrWp11rlertomOV6WysYjbLR/nL9m+n60sLKGx9s3FldW39zde32xp2PPvlsbnFlUq+Vqs2iYea7FCrmi+20fHW6uVgom+b07MzcUruzcKNcv16oXC9UJvXai7D/Sy1/6Y1Wvd1JU6g2T/MKZSrWa60JvTYzt/Txp3dfLRp6rXVOfwW1otEo11tvvfv+2u2NqdmFQqVeqppjUtNrzRvlxs3FlXfeW89t/B8nb251t7Z/3+qm7G7/sdXd3tzqnuFv3acnPPdJU0rFUYTjmFIKAAjCUCklpVRjQOOc+74fBAEAwLIsCKGUklJKCGEZYkwAih0UeyimCeOnoAkhEsYcx4MIcc7CMBwODzHGlNLhkaVi+H0/vPbQmX7sX3to/3SElFL8JCxNSimEwBgTSvOjIEKEEEopRJGguOvFXz0Lv92DXz8L+pCmSalT4iAIIIRh9rRsmyaJGg+p2HVdz/Ns2/YBcByHUpqHk4NxkZyQZysyw7EYQgR8n3Oer3LOGTtjzGkIIXzfj+M4FaeliuMgCBhjQoh8i1x/ITjnEEKMcSoWQkCEMCEoiiCKEEKO6yaMjZszCUDsA+J7kQ9cz3Mcd0zPNJSwt3/xVp8Encf+/T8DJZgHApqV7eXiKGFrv3rrT8Pln/0Hu6FKiOW4hBDO+VhhCxwxHAsSR0GQZ5vXYzxxCBhwBHCs/f74HZKKMRNfbId3N/0PN8Pvdr3QPtofDEajESFkHMO4+aNTenT4yiPn3pOhO+jt7D7v9Xp5G1wdvKakVDxRQijOCI5zn8bNWQjhZPA876+9vXFMPtskWXvF2TChlMYYJ0nCLgchJMl8TcVhCAcHw35/0Ov1R6Oj/f0BAIBzfuEWXHDbcRBCx2KMcUKpyK5EHo/M7uRlTG3Kr6SQcmi7I8eLCGVKUSFzJlJdRioUk3mdhRpRYcP4b8t9fmiFXIVcwSuJuDpKJJNKS4SyMLMjfODDwyAMGfRZDCh/CRMh82EglaKM7vWtKNrZ35kY9j5PhOJScKnOkaUS5YLg4HB0PEmygcWzWwgx+gFH3cwULqW4kCKbZf+K/wF/Jm1a2rUcwAAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Events\",\n    \"title\": \"Events\",\n    \"src\": \"/static/fc2bb42d6717df1fbc718abdc4495cb5/9ff85/Events.png\",\n    \"srcSet\": [\"/static/fc2bb42d6717df1fbc718abdc4495cb5/5a46d/Events.png 300w\", \"/static/fc2bb42d6717df1fbc718abdc4495cb5/9ff85/Events.png 465w\"],\n    \"sizes\": \"(max-width: 465px) 100vw, 465px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"You can add a chart in the Metric blade, see a the top. Select Sum, in a grid, and group by the property you want to get the data. In our example, it is the property that change which is the location of the link. What can be confusing is to be able to select the property you need to go at the bottom of that blade and select the metric \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"event\"), \".\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"784px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/7eb44166857a6f157c4bfa9845429b4a/4971b/GridTelemetry.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"31.333333333333336%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAwElEQVQY02WP7W7DIAxF8/4vWa1Z1cKm4A8gOMT21LBUlXp0fxlfjjxxqZQzcqYjS8KEBMSUi7mru9pHzvkkTUoptdZSqjTZtq2tTUR67/uBH5iZn/Te9ZhPRHR/hEeIIUQR8TeIGQBGU1Xt/GJJaUkwypwAhmEsDdwNsF2/6WvGy4zXG7Um7qZqxLzvu5lNABBiRKLeu73xNMA63wiwIT0jIuMJAMfyxMyAEH9+SylD/ionWO8hv64dNlUl+jf/AdrMXWZjEzjAAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"GridTelemetry\",\n    \"title\": \"GridTelemetry\",\n    \"src\": \"/static/7eb44166857a6f157c4bfa9845429b4a/4971b/GridTelemetry.png\",\n    \"srcSet\": [\"/static/7eb44166857a6f157c4bfa9845429b4a/5a46d/GridTelemetry.png 300w\", \"/static/7eb44166857a6f157c4bfa9845429b4a/0a47e/GridTelemetry.png 600w\", \"/static/7eb44166857a6f157c4bfa9845429b4a/4971b/GridTelemetry.png 784w\"],\n    \"sizes\": \"(max-width: 784px) 100vw, 784px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"The result is a table that contains only the data that has been collected. Hence, you need to have people clicking the buttons to see anything. Also, it can take some time (about 30 minutes) to see the information into the Azure portal.\"));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"id":"04f223f5-5344-5022-aa7d-24df3ecc15cf","totalPages":71}},
    "staticQueryHashes": ["3159585216"]}
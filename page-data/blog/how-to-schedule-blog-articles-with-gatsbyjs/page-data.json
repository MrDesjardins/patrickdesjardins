{
    "componentChunkName": "component---src-templates-blog-article-tsx",
    "path": "/blog/how-to-schedule-blog-articles-with-gatsbyjs",
    "result": {"data":{"mdx":{"frontmatter":{"title":"How to schedule blog articles with GatsbyJS","date":"October 5, 2021"},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"How to schedule blog articles with GatsbyJS\",\n  \"date\": \"2021-10-05\",\n  \"categories\": [\"react\", \"gatsby\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Coming from writing my blog articles on WordPress, I was rapidly disappointed that I couldn't write down a blog article in advance. Indeed, I could write the article without pushing to the master branch or leverage Git by creating a branch for each article and merge when ready to publish. However, I wanted to be able to write an article, set a date, maybe do some modification here and there, and forget about it. I wanted the article to be deployed automatically.\"), mdx(\"p\", null, \"Each blog article has a header portion called frontmatter. The frontmatter has a date which is the date of the article. Thus, we can program some logic to only display articles before or equal to the frontmatter date.\"), mdx(\"p\", null, \"The filtering needs to appear everywhere we have a list of articles. In my case, I have a list by year and a list that paginate all blog articles chronologically. The former GraphQL looks like this:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\",\n    \"metastring\": \"{2,7}\",\n    \"{2,7}\": true\n  }, \"export const query = graphql`\\n  query BlogsInYear($yearStart: Date!, $yearEnd: Date!, $currentDate: Date!) {\\n    allMdx(\\n      sort: { fields: frontmatter___date, order: DESC }\\n      filter: {\\n        frontmatter: {\\n          date: { gte: $yearStart, lt: $yearEnd, lte: $currentDate }\\n        }\\n      }\\n    ) {\\n      nodes {\\n        frontmatter {\\n          date(formatString: \\\"MMMM D, YYYY\\\")\\n          title\\n          categories\\n        }\\n        id\\n        fields {\\n          slug\\n        }\\n      }\\n    }\\n  }\\n`;\\n\")), mdx(\"p\", null, \"And the chronological pagingation:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\",\n    \"metastring\": \"{2,7}\",\n    \"{2,7}\": true\n  }, \"export const query = graphql`\\n  query TopXBlogArticles($limit: Int!, $skip: Int!, $currentDate: Date!) {\\n    allMdx(\\n      sort: { fields: frontmatter___date, order: DESC }\\n      limit: $limit\\n      skip: $skip\\n      filter: { frontmatter: { date: { lte: $currentDate } } }\\n    ) {\\n      nodes {\\n        frontmatter {\\n          date(formatString: \\\"MMMM D, YYYY\\\")\\n          title\\n          categories\\n        }\\n        id\\n        fields {\\n          slug\\n        }\\n      }\\n    }\\n  }\\n`;\\n\")), mdx(\"p\", null, \"As you can see, in both cases, we pass the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$currentDate\"), \". Here is the twist if you are new to GatsbyJS: the GraphQL is not dynamic in the client environment but when we build the whole website. Inside the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"gatsby-node.js\"), \", in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"createPages\"), \" function we are parsing the current date. Here is the code for the chronological per year page\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\",\n    \"metastring\": \"{1-2,16}\",\n    \"{1-2,16}\": true\n  }, \"const currentDate = new Date();\\nconst formattedCurrentDate = currentDate.toISOString().split(\\\"T\\\")[0];\\n\\nconst year = node.frontmatter.date.substr(0, 4);\\nif (!years.has(year)) {\\n  const yearStart = year + \\\"-01-01\\\";\\n  const yearEnd = year + 1 + \\\"-01-01\\\";\\n  createPage({\\n    path: URL_PER_YEAR.replace(\\\"{year}\\\", year),\\n    component: path.resolve(`./src/templates/BlogsByYear.tsx`),\\n    context: {\\n      yearStart: yearStart,\\n      yearEnd: yearEnd,\\n      year,\\n      totalPages: totalPageCount,\\n      currentDate: formattedCurrentDate,\\n    },\\n  });\\n  years.set(year, year);\\n}\\n\\n\")), mdx(\"p\", null, \"The last part is that once the code is sent in Github, there is a task to build the website and publish it. But the problem is that if I have an article with a release date in one week, the build needs to be executed on that specific day to have the code in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"gatsby-node.js\"), \" to be executed to pass the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"currentDate\"), \" to the GraphQL query. \"), mdx(\"p\", null, \"Thus, we need to alter our build script to trigger a build when the code or article changes and every day. It means that inside the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".github/workflows/main.yml\"), \" the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"on\"), \" property changes to\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yaml\",\n    \"metastring\": \"{4-5}\",\n    \"{4-5}\": true\n  }, \"on:\\n  push:\\n    branches: [master]\\n  schedule:\\n    - cron: '0 8 * * *'\\n\")), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"schedule\"), \" uses a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"cron\"), \" that executes every day at 8 UTC (which is during the night in the USA the build. So, in short, the whole website is built every day. The following picture shows how the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Actions\"), \" tab looks, and you can see many \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Scheduled\"), \" tasks and one commit by me (MrDesjardins), which is when I write and push the MardownX file.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1200px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/d3cbeb0cdfb25ba1cc294151352353c4/191e2/github-actions-daily.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"49.33333333333333%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABFElEQVQoz5WSbW+EIBCE/f+/sj3vVFCs8qIgrHPZ9XK1aZpYkv0GwzMzW6l5wKNpobRGjAmFCPu+Xx7nA5zzKKWgFEJl3IT7o4FSGt4HpJSuCwKwzmG2DkQEoh2VtgaftxpN2x2C23ZZkM80WxkWZHfV6Gexa8YvrDEi5/wvywyxrKvQieAULDqlMQwGISxIaZOfrxI670+WCVXvRrGrdY8Yo4TLl+k1V0phSi7kZfkoRffDD8Lz4YeFdrH1uxQPeybkUj5uNcw4YtsywrLAhyDiTlo/PjALwSVi+ZMoMFv7tiyEvTWo7w+0nRIxbjmXckzOcvHPCCTDIDm+18YuHkr3MGaULGJK36VcKIfpeBeFsBQ8AbJvDy4AuPGgAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"github actions daily\",\n    \"title\": \"github actions daily\",\n    \"src\": \"/static/d3cbeb0cdfb25ba1cc294151352353c4/c1b63/github-actions-daily.png\",\n    \"srcSet\": [\"/static/d3cbeb0cdfb25ba1cc294151352353c4/5a46d/github-actions-daily.png 300w\", \"/static/d3cbeb0cdfb25ba1cc294151352353c4/0a47e/github-actions-daily.png 600w\", \"/static/d3cbeb0cdfb25ba1cc294151352353c4/c1b63/github-actions-daily.png 1200w\", \"/static/d3cbeb0cdfb25ba1cc294151352353c4/d61c2/github-actions-daily.png 1800w\", \"/static/d3cbeb0cdfb25ba1cc294151352353c4/191e2/github-actions-daily.png 1836w\"],\n    \"sizes\": \"(max-width: 1200px) 100vw, 1200px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"To conclude, the possibility to schedule blog articles with GatsbyJS is possible. Like most features, it is not out-of-the-box but not a very excessive demanding workflow to implement.\"));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"id":"7eab58a8-5074-5734-bee3-ea26d19cd54b","totalPages":73}},
    "staticQueryHashes": ["3159585216"]}
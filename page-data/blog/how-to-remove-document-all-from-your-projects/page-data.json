{
    "componentChunkName": "component---src-pages-blog-mdx-slug-tsx",
    "path": "/blog/how-to-remove-document-all-from-your-projects",
    "result": {"data":{"mdx":{"frontmatter":{"title":"How to remove document.all from your projects?","date":"November 7, 2011"},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"How to remove document.all from your projects?\",\n  \"date\": \"2011-11-07\",\n  \"categories\": [\"regex\", \"visual-studio\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Recently, I had to work on pages which contained a lot of code that were using the famous Internet Explorer 4 document.all javascript method. It's not supported by all browser and should not be used. You should use unique identifier but I couldn't because time was limited for the change.\"), mdx(\"p\", null, \"We already user JQuery so I knew that I can search by attribute.\"), mdx(\"p\", null, \"The plan was to replace all \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"document.all\", \"[\\\"XYZ\\\"]\"), \" to \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"$('input\", \"[name=\\\"XYZ\\\"]\", \"')\"), \". As you see, the XYZ change between each files. The solution is with Visual Studio (or other software that do replace with Regex) to use the Replace tool with a Regex expression.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"//this document.all\\\\\\\\[\\\\\\\\\\\"{(.+)}\\\\\\\\\\\"\\\\\\\\] //to $(\\\\\\\\'input\\\\\\\\[name=\\\"\\\\\\\\1\\\"\\\\\\\\]\\\\\\\\') \\n\")), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"300px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/84043c37b7d5ccb3f836a998fc831f3f/5a46d/regex-300x400.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"133.33333333333331%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD/klEQVRIx52Ua3PaOBSG/ev3d+yX7pe2aS6kk5KkbCFcDTYBY2NswBbG9wsYQ9Im4d2RuDQJzU6nnnksjSUdnfPqlbmz8yMU/z3F1+sTXOY/4uryE4rfchCaV2jx12g2rtBsXG65At+g3y8hNvMb+DwqxROUCu9xcXEMrlo6wlTNYap+hqXmMJaO4Y8vkfk1rPwSnuZ1rNMG43FWAxYNrKImfEdC6EoIHAmW0YJt8CiXr8B9PvsbuvAPhr0vIGoeevcMhnKBRvkY18d/QW4eodP4gKF0jn77FEYvB6lbxkmhh/NvO2TkqxrenVbB3VRqsMwBFKULXVPgOhM4NoHjWHAd2hLYU5N9o2OubcK2LRDL2WNMbLhegJv6LbhKXcBoNILSV6EPR5jPUyTJDLP5HLPZhnSRIU0Xe+icOIqQxDHSlM6Z4fv9Cu1uH1y3N4DruiBkwgIPR0OYxITrephMJvB8Hw8PD3uenp6QzGYQ220Mh0MWLIpiLJcZWrcyuBrfhuNMQSYWptMpbNvBPE0xn88ZdMGuv4Nm6fs+giBg43EcY7XMINwq4Mq1FnpSFz1ZgaYNoGk625FO2rV00XOiKGLQsSRJXgYUO30kScTKM0wCwzRhmgS+H8CyLFbyer3G4+Mjg/ZpBd2uhPF4fJhhU5QQ+B5bHMcJ2/F1Rq9J0xTTqc20PwhYLDcwUFXour7XZDNpU8qv+bnpQcmd3gBJHME0DEwsC8Qk7LRdzwd96Kk+hz7USlRrQshhhvQVxxErgerleR4c14XjOGwiLe811Ic0mG3brwLK4ISOjCgMYJomsw2dSPU0DIMF3ZWUJM9J9pbal7za+rBSb7MTlph1euh0OsywG9tECMPwTWiwAw3rzQ7iaDPoBz6iMHwh+P+d9psBJ4Sg1+tB1zRouo6+osCm5bIsww1hyDaOt6Y+MPZquQlY42/hODYzKdXPJIS11EJBFMOPEwTJDOFszvpeGO3l2FzDlAVdZouNhu2Ogu/3d/tBSrZI4cUJeG8JfhKhOLBQ6BPUzRCt4B4KseE5NiRJYgwGGsu+XBfAid0++1PQe8vSp7olCdwoRt5Iket7+NQh+CCOcSo7+EKWENQRNLWPer2GarUKQRBhjEcoFGvg2pLKBN3psWd7I6IkwdR24Hgek4BuSG2lqn0IgsCc0WoJmBAT5ZoArt39dUB2xbYt9SM1fLh1ANVYlmXwPA9RFNHgeYyGOooV/u2Az5ntTfzTSvS2ZFmGxWLzF7+/W0HoKL8X8C12a+iJv/gfZosFwjBCRO3wG8Sv+nRtRm3TlsHJ6hDrxx/spO9Wyz+Crl0//UBX1sB9zBVQqooolHgUbpp/xNcSj1JNxPvTa/wHCZy6jsIMVPUAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"regex 300x400\",\n    \"title\": \"regex 300x400\",\n    \"src\": \"/static/84043c37b7d5ccb3f836a998fc831f3f/5a46d/regex-300x400.png\",\n    \"srcSet\": [\"/static/84043c37b7d5ccb3f836a998fc831f3f/5a46d/regex-300x400.png 300w\"],\n    \"sizes\": \"(max-width: 300px) 100vw, 300px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"What it does is that it search for the string document.all\", \"[\\\"???\\\"]\", \" and replace with input\", \"[name=\\\"???\\\"]\", \" and the ??? is replaced with what is found in the search and used in the replacement. This way, the name change every time it founds a new string with document.all.\"), mdx(\"p\", null, \"This can will be good for some situation but not for code like this:\"), mdx(\"p\", null, \"document.all\", \"[\\\"???\\\"]\", \".value because in JQuery the value is get by val() and set by val('new value');\"), mdx(\"p\", null, \"To be able to do this correctly, 2 Replaces is required.\"), mdx(\"p\", null, \"The first one for the setter of the value:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \" document.all\\\\\\\\[\\\\\\\\\\\"{(.+)}\\\\\\\\\\\"\\\\\\\\].value(:b)@={(.+)}; //Search $(\\\\\\\\'input\\\\\\\\[name=\\\"\\\\\\\\1\\\"\\\\\\\\]\\\\\\\\').val(\\\\\\\\2); //Replace \\n\")), mdx(\"p\", null, \"The second one for the getter of the value\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \" [^\\\\\\\\.]document.all\\\\\\\\[\\\\\\\\\\\"{(.+)}\\\\\\\\\\\"\\\\\\\\].value //search $(\\\\\\\\'input\\\\\\\\[name=\\\"\\\\\\\\1\\\"\\\\\\\\]\\\\\\\\').val() //Replace \\n\")), mdx(\"p\", null, \"This is ain't perfect for all situations. Multiples concatenations of \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"document.all\"), \" may not be replaced correctly. But, I think it does the job for most of the situation.\"));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"id":"aeea5031-70f7-553c-b7b7-2a94f0280fa4"}},
    "staticQueryHashes": ["3159585216"]}
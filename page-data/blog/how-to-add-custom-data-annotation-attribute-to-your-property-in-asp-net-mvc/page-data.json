{
    "componentChunkName": "component---src-templates-blog-article-tsx",
    "path": "/blog/how-to-add-custom-data-annotation-attribute-to-your-property-in-asp-net-mvc",
    "result": {"data":{"mdx":{"frontmatter":{"title":"How to add custom Data Annotation attribute to your property in Asp.Net MVC","date":"February 22, 2013"},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"How to add custom Data Annotation attribute to your property in Asp.Net MVC\",\n  \"date\": \"2013-02-22\",\n  \"categories\": [\"asp-mvc\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"In many scenarios the ViewModel will need to provide to the View some additional information could be useful. The case of having an UIHint attribut with the conjunction of this additional information is probably the situation where most people will face at some point.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \" [DoSomething] public MyClass MyProperty { get; set; } \\n\")), mdx(\"p\", null, \"Let say you have a template that display multiple information from your view model (in the example above \\\"MyClass\\\"). If this one require to display something more (or less) depending of who use it, and that the view model know this information, the only way to pass this information is by data annotation.\"), mdx(\"p\", null, \"Let's base the theory on the following example. \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \" [DisableShape(\\\"Heavy\\\")] [UIHint(\\\"ShapeSelector\\\")] public Shape TopShape { get; set; } [UIHint(\\\"ShapeSelector\\\")] public Shape BottomShape { get; set; } \\n\")), mdx(\"p\", null, \"The view model class has two properties which define 2 shapes. One must be selected from a list of shape but only accept light shape while the other require to have strong shape. We could create two templates but we could also create a simple template and allow to disable some shape. This is the case of the property \\\"TopShape\\\" where we will disable all heavy shape but keep everything selectable for the \\\"BottomShape\\\".\"), mdx(\"p\", null, \"The first thing to keep in mind is that we will change \\\"ModelMetadataProviders\\\" of MVC to use a custom one when we will be able to add multiple attribute for the whole application. Since we do not want to bind a single attribute we will create a custom meta data provider.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \" public class CustomModelMetadataProvider : DataAnnotationsModelMetadataProvider { protected override ModelMetadata CreateMetadata( IEnumerable<Attribute> attributes, Type containerType, Func<object> modelAccessor, Type modelType, string propertyName) { var modelMetadata = base.CreateMetadata(attributes, containerType, modelAccessor, modelType, propertyName); attributes.OfType<MetadataAttribute>().ToList().ForEach(x => x.Process(modelMetadata)); return modelMetadata; } } \\n\")), mdx(\"p\", null, \"This code lets you have multiple attributes of type \\\"MetadataAttribute\\\".\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \" public abstract class MetadataAttribute : Attribute { public abstract void Process(ModelMetadata modelMetaData); } } \\n\")), mdx(\"p\", null, \"As you can see, it's simply an abstract class that lets you define a Process method which is executed in the CreateMetadata method.\"), mdx(\"p\", null, \"From there, you can define what parameter you want for your custom attribute.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \" public class DisableShapeAttribute : MetadataAttribute { public bool TypeShape { get; set; } public DisableShapeAttribute(string type) { TypeShape = type; }\\n\\npublic DisableShapeAttribute() { TypeShape = \\\"\\\"; }\\n\\npublic override void Process(ModelMetadata modelMetaData) { modelMetaData.AdditionalValues.Add(\\\"DisableShape\\\", TypeShape); } } \\n\")), mdx(\"p\", null, \"The last step is to register the CustomModelMetadataProvider that loop every MetadataAttribute. This is done via the Global.asax.cs, inside the Application_Start method.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \" ModelMetadataProviders.Current = new CustomModelMetadataProvider(); \\n\")), mdx(\"p\", null, \"From here you can read the attribute from your view or template.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \" var attr = ViewData.ModelMetadata.AdditionalValues.SingleOrDefault(x => x.Key == \\\"DisableShape\\\").Value; var attrValue = attr != null && (string)attr; \\n\")));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"id":"33e68577-5230-5a72-bf16-3f2192a91713","totalPages":69}},
    "staticQueryHashes": ["3159585216"]}
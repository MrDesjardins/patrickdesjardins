{
    "componentChunkName": "component---src-templates-blog-article-tsx",
    "path": "/blog/how-to-unit-test-a-method-that-is-not-from-an-interface-neither-virtual-with-visual-studio-2012",
    "result": {"data":{"mdx":{"frontmatter":{"title":"How to unit test a method that is not from an interface, neither virtual with Visual Studio 2012","date":"September 3, 2013"},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"How to unit test a method that is not from an interface, neither virtual with Visual Studio 2012\",\n  \"date\": \"2013-09-03\",\n  \"categories\": [\"visual-studio\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Microsoft has the ability to fake method but as the disadvantage that it requires to be from an interface or to be virtual. This is the case of most testing framework. Nevertheless, Microsoft has the principle of Shim which allow to replace the method behavior by yours for the time of a test. You can get additional information on \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://msdn.microsoft.com/en-us/library/hh549175.aspx\"\n  }, \"MSDN\"), \". This blog article explains briefly how to use shim.\"), mdx(\"p\", null, \"For the purpose of this article, let say that we have a library with a single class which contain a single method :\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \"namespace ShimpProjectClassesToShim { \\n  public class MyClass { \\n    public string MyMethod(string variable) { \\n      return \\\"From MyClass = \\\" + variable; \\n    } \\n  } \\n  \\n  public class MyClass2 { \\n    public string ToTest() { \\n      var m = new MyClass();\\n      return m.MyMethod(\\\"InsideMyClass2\\\"); \\n    } \\n  } \\n}\\n\")), mdx(\"p\", null, \"This method is not virtual, but could have been because shim can be bound to static method. As you can see, the purpose of the test would be to change the inside of the method for the time of a test method.\"), mdx(\"p\", null, \"To continue with our example, we need a second project, the one of the test. This one will have a reference to the library previously created. Once done, right click the reference and click \\\"\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Add Fake Assembly\"), \"\\\".\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"400px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/f185f90fdd0d271a72a3cf6cdbba7697/e17e5/AddFakesAssembly-400x308.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"77%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACpElEQVQ4y32T227bRhBA9f9fEPQhKAr0qQjSh+bBbVoEdVMHjR1ZlEyKpEXKyzslURS5vFgXnoAryY3RwgQOdoAlD2dmdwb7w4Gew4n9/kDXddR1g65bjNyEK13w92TO5Z3gtxuLi89TPt8n/KEJLm49RiLnxlkydBYMoIPuX3pZ/zRNi+8nrNKYRRySLRKyNGaVRBTZkrrIqYsNZb6G3SPdtqWRBYPuJPmWszAIErzAZ6gNmYzvGI3GmKaFZdnEccJyuSJJU4pSIqsKKauXhZ4XUVU1ni+YGjqu69I0DW3bqvVMVVVPDA7f9O9M34a+h0LErLIVlnuPaTk4joeULaWsnuize4rlSdgLzpl13UGtvfDhIaQsKwzzI5PxW0zzF5rahl0NWwk7CYcW9vUx3kkGu/0BWbUq3bKUNG3LdrdTcV+ySGt0d87V7RX/aJ+4HE/44a+YH68WvL5M+O7C4tV7wasPCd9/XDCo6pap7aONLb580bnTHZx5jOcv8YMUz08IwhVBlBMnG/RZyp92xa/jFT99Cnj97pqfr2Pe2zt+txoG221Htnaw7TfY928xrTeE0Tvy4pIsz8nWBZtC4s4F1zdDtJGGmBkswzl56nFoy+cl17JmZowxpkPcuYHn2wThkThZIbyQKF4SxQs8P1JsipK6aWnaR2RVPzukQVU1TE0XTTO5HU0xpi6mJTAMl/lDyIMImTmCIFoosRD9QZWq51LKZ1dGXZu23armD4caw9sJM+dBZXNkqYSu6xGehd5RWNf1f2RK2DSP+EGiXhReRBilpxKPBGGq9ty5r/b7kl8U9pNgTG1Gmo4xnamP+lJ7hBerC61pOvczgTP3VfkvCvf7PUVRsl7n5PlGzWP/kyzL1WQkyeI4t6uM1Yn/E52FXwGXFmHOwL1jRAAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"AddFakesAssembly 400x308\",\n    \"title\": \"AddFakesAssembly 400x308\",\n    \"src\": \"/static/f185f90fdd0d271a72a3cf6cdbba7697/e17e5/AddFakesAssembly-400x308.png\",\n    \"srcSet\": [\"/static/f185f90fdd0d271a72a3cf6cdbba7697/5a46d/AddFakesAssembly-400x308.png 300w\", \"/static/f185f90fdd0d271a72a3cf6cdbba7697/e17e5/AddFakesAssembly-400x308.png 400w\"],\n    \"sizes\": \"(max-width: 400px) 100vw, 400px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"Do no worry, you have already added the reference from the unit project to the library project. Maybe a better naming of the action should have been \\\"Transform to Fake Assembly. When done, you will see a Fakes folder created with the fake reference.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"382px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/93ea54220b22382b63ee619734e67fcb/77edc/fakesFolder.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"57.00000000000001%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABm0lEQVQoz42Ry27TQBSG86as2SA27oN0UwmhlBVrHgGxQIIFAttz5uK5NXfs2I4zM8fjpBEojlpV7QJ+/To6m+9c9E/23Z4Uec4yozQFCgCr1TrGGELAf2kSvL+rysJoTmkhBMlJWW1j7PE/NOn7vuscAP318wchwClbrlaXzaPw8YSXl0wQ0TvXtq2UMkszpZTg/FyFUFJZY43WSknBuDV3AdF7/zA3nOEQwvF4XC4XWZoqJSkA55wCJXnOuWAAWZpxzgohtNJFUWittDqPvMC+78NsZoFkjAKQnDNgdDTkAERJIZXY7XYhBD/KOee9v8DxcPizWKyBME4lZ6oorJRW6ZksrNFz52IIA2J8+XPv3LLrhFLfKHzW+mtVZYeDjdHEaIbh7LHXiBvE/hl833UfGXtFyWut35ZV0jZXTZPU26Spk7pOttukrq+a5k3AT4gnRP8UPuz3X3bu9nf5QcmbNL1m9MboqTVTo99bM7X2dqzvvP+OeHwa2TnntnVV223K7Xy2ns/Xm02NeByGU4ynGO8ffEIcnoX9FzDEUzRnExc0AAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"fakesFolder\",\n    \"title\": \"fakesFolder\",\n    \"src\": \"/static/93ea54220b22382b63ee619734e67fcb/77edc/fakesFolder.png\",\n    \"srcSet\": [\"/static/93ea54220b22382b63ee619734e67fcb/5a46d/fakesFolder.png 300w\", \"/static/93ea54220b22382b63ee619734e67fcb/77edc/fakesFolder.png 382w\"],\n    \"sizes\": \"(max-width: 382px) 100vw, 382px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"If you are curious about what contain this file, here is the one of the example :\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-xml\"\n  }, \" <Fakes xmlns=\\\"http://schemas.microsoft.com/fakes/2011/\\\"> \\n  <Assembly Name=\\\"ShimpProjectClassesToShim\\\"/> \\n </Fakes> \\n\")), mdx(\"p\", null, \"So the test will consist of shimming MyClass that is used by MyClass2. This is a common scenario that you want to test a method that use an other class that you do not want to test. In our case, we want to test MyClass2 and not MyClass, we shim MyClass to have a known return value.\"), mdx(\"p\", null, \"The test my be inside the scope of a ShimContext to be able to set the shim inside the test.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \"[TestClass] public class UnitTest1 { \\n  [TestMethod] public void TestMethod1() { \\n    //Shim \\n    using (ShimsContext.Create()) { \\n      //Arrange \\n      ShimMyClass.AllInstances.MyMethodString = (theClass, s) => \\\"FAKE \\\" + s; \\n      var classToUnitTest = new MyClass2();\\n\\n      //Act \\n      string result = classToUnitTest.ToTest();\\n\\n      //Assert \\n      Assert.AreEqual(\\\"FAKE InsideMyClass2\\\", result); \\n    } \\n  } \\n} \\n\")), mdx(\"p\", null, \"The arrange section set for all instances of the method the desired return value. As you can see we use \\\"ShimMyClass\\\" class to set all instances. In your case, if you class is called \\\"XYZ\\\", you will have to use \\\"ShimXYZ\\\". This is by design that a class has been created for you with the prefix Shim. From there, you will be able to set return value for all methods. The rest of the unit test is as usual.\"));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"id":"cad657b5-0479-53d3-b0b0-a5aecc33b2af","totalPages":74}},
    "staticQueryHashes": ["3159585216"]}
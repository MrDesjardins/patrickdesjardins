{"expireTime":9007200886478379000,"key":"gatsby-plugin-mdx-entire-payload-1421221561f169abb856f98f2be8fba4--undefined","val":{"mdast":{"type":"root","children":[{"type":"paragraph","children":[{"type":"text","value":"I had to integrate Google Analytic in one of our website at Netflix. It's been a while I had to use Google Analytic and the last time was simply copy-pasting the code snippet provided by Google when creating the Analytic \"provider\" account. The last time was a few years ago and the website was not a single-page application (spa). Furthermore, I the application is using Create-React App (TypeScript version) with Redux. I took a quick look and found few examples on the web but I wasn't satisfied. The reason is that all examples I found were hooking Google Analytic at the component level. I despise having anything in the user interface (UI), React that is not related to the UI.","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":684,"offset":684},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":684,"offset":684},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The first step is to use a library instead of dropping the JavaScript directly into the code.","position":{"start":{"line":4,"column":1,"offset":686},"end":{"line":4,"column":94,"offset":779},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":686},"end":{"line":4,"column":94,"offset":779},"indent":[]}},{"type":"code","lang":null,"meta":null,"value":" npm install --save react-ga ","position":{"start":{"line":6,"column":1,"offset":781},"end":{"line":8,"column":5,"offset":820},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Next step is to configure the library to set the unique identifier provided by Google. I am using the create-react-app scaffolding and I found the best place to initialize Google Analytic to be in the constructor of the App.ts file. It is a single call that needs to be executed once for the life of the spa.","position":{"start":{"line":10,"column":1,"offset":822},"end":{"line":10,"column":309,"offset":1130},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":822},"end":{"line":10,"column":309,"offset":1130},"indent":[]}},{"type":"code","lang":"typescript","meta":null,"value":"class App extends React.Component {\n  public constructor(props: {}) { \n    super(props); \n    ReactGA.initialize(process.env.NODE_ENV === Environment.Production ? \"UA-1111111-3\" : \"UA-1111111-4\"); \n  } \n\n  public render(): JSX.Element { \n    return <Provider store={store}> <ConnectedRouter history={history}> <AppRouted /> </ConnectedRouter> </Provider>; \n  } \n}\n\nexport default App; ","position":{"start":{"line":12,"column":1,"offset":1132},"end":{"line":25,"column":5,"offset":1536},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The last step is to have react-router to call the page change when the routing change. React-router is mainly configured in React, but I didn't want to have any more ReactGA code in React. The application I am working uses Redux and I have a middleware that handles route. At the moment, it checks if the route change and analyzes the URL to start fetching data on the backend.","position":{"start":{"line":28,"column":1,"offset":1539},"end":{"line":28,"column":378,"offset":1916},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":1539},"end":{"line":28,"column":378,"offset":1916},"indent":[]}},{"type":"code","lang":"typescript","meta":null,"value":"return (api: MiddlewareAPI<AppReduxState>) => (next: Dispatch<AppReduxState>) => \n  <A extends Action>(action: A): A => { \n  // Logic here that check for action.type === LOCATION_CHANGE to fetch the proper data \n  // ... \n  // If action.type === LOCATION_CHANGE we also call the following line: ReactGA.pageview(actionTyped.payload.pathname); \n}; ","position":{"start":{"line":30,"column":1,"offset":1918},"end":{"line":37,"column":5,"offset":2284},"indent":[1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The previous code is clean. Indeed, I would rather not have anything inside React, but App.tsx is the entry point and the initialize function injects into the DOM Google's code. The Redux solution works well because the react-router-redux used gives the pathname which is the URL. By using the function \"pageview\" we are manually sending to Google Analytic a page change.","position":{"start":{"line":39,"column":1,"offset":2286},"end":{"line":39,"column":372,"offset":2657},"indent":[]}}],"position":{"start":{"line":39,"column":1,"offset":2286},"end":{"line":39,"column":372,"offset":2657},"indent":[]}},{"type":"export","value":"export const _frontmatter = {\"title\":\"Google Analytic with React and Redux\",\"date\":\"2018-08-28\",\"categories\":[\"react\",\"redux\",\"typescript\"]}","position":{"start":{"line":42,"column":1,"offset":2660},"end":{"line":42,"column":141,"offset":2800},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":42,"column":141,"offset":2800}}},"scopeImports":["import * as React from 'react'"],"scopeIdentifiers":["React"],"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Google Analytic with React and Redux\",\n  \"date\": \"2018-08-28\",\n  \"categories\": [\"react\", \"redux\", \"typescript\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"I had to integrate Google Analytic in one of our website at Netflix. It's been a while I had to use Google Analytic and the last time was simply copy-pasting the code snippet provided by Google when creating the Analytic \\\"provider\\\" account. The last time was a few years ago and the website was not a single-page application (spa). Furthermore, I the application is using Create-React App (TypeScript version) with Redux. I took a quick look and found few examples on the web but I wasn't satisfied. The reason is that all examples I found were hooking Google Analytic at the component level. I despise having anything in the user interface (UI), React that is not related to the UI.\"), mdx(\"p\", null, \"The first step is to use a library instead of dropping the JavaScript directly into the code.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \" npm install --save react-ga \\n\")), mdx(\"p\", null, \"Next step is to configure the library to set the unique identifier provided by Google. I am using the create-react-app scaffolding and I found the best place to initialize Google Analytic to be in the constructor of the App.ts file. It is a single call that needs to be executed once for the life of the spa.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"class App extends React.Component {\\n  public constructor(props: {}) { \\n    super(props); \\n    ReactGA.initialize(process.env.NODE_ENV === Environment.Production ? \\\"UA-1111111-3\\\" : \\\"UA-1111111-4\\\"); \\n  } \\n\\n  public render(): JSX.Element { \\n    return <Provider store={store}> <ConnectedRouter history={history}> <AppRouted /> </ConnectedRouter> </Provider>; \\n  } \\n}\\n\\nexport default App; \\n\")), mdx(\"p\", null, \"The last step is to have react-router to call the page change when the routing change. React-router is mainly configured in React, but I didn't want to have any more ReactGA code in React. The application I am working uses Redux and I have a middleware that handles route. At the moment, it checks if the route change and analyzes the URL to start fetching data on the backend.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"return (api: MiddlewareAPI<AppReduxState>) => (next: Dispatch<AppReduxState>) => \\n  <A extends Action>(action: A): A => { \\n  // Logic here that check for action.type === LOCATION_CHANGE to fetch the proper data \\n  // ... \\n  // If action.type === LOCATION_CHANGE we also call the following line: ReactGA.pageview(actionTyped.payload.pathname); \\n}; \\n\")), mdx(\"p\", null, \"The previous code is clean. Indeed, I would rather not have anything inside React, but App.tsx is the entry point and the initialize function injects into the DOM Google's code. The Redux solution works well because the react-router-redux used gives the pathname which is the URL. By using the function \\\"pageview\\\" we are manually sending to Google Analytic a page change.\"));\n}\n;\nMDXContent.isMDXComponent = true;","rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nexport const _frontmatter = {\n  \"title\": \"Google Analytic with React and Redux\",\n  \"date\": \"2018-08-28\",\n  \"categories\": [\"react\", \"redux\", \"typescript\"]\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n    <p>{`I had to integrate Google Analytic in one of our website at Netflix. It's been a while I had to use Google Analytic and the last time was simply copy-pasting the code snippet provided by Google when creating the Analytic \"provider\" account. The last time was a few years ago and the website was not a single-page application (spa). Furthermore, I the application is using Create-React App (TypeScript version) with Redux. I took a quick look and found few examples on the web but I wasn't satisfied. The reason is that all examples I found were hooking Google Analytic at the component level. I despise having anything in the user interface (UI), React that is not related to the UI.`}</p>\n    <p>{`The first step is to use a library instead of dropping the JavaScript directly into the code.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{` npm install --save react-ga \n`}</code></pre>\n    <p>{`Next step is to configure the library to set the unique identifier provided by Google. I am using the create-react-app scaffolding and I found the best place to initialize Google Analytic to be in the constructor of the App.ts file. It is a single call that needs to be executed once for the life of the spa.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-typescript\"\n      }}>{`class App extends React.Component {\n  public constructor(props: {}) { \n    super(props); \n    ReactGA.initialize(process.env.NODE_ENV === Environment.Production ? \"UA-1111111-3\" : \"UA-1111111-4\"); \n  } \n\n  public render(): JSX.Element { \n    return <Provider store={store}> <ConnectedRouter history={history}> <AppRouted /> </ConnectedRouter> </Provider>; \n  } \n}\n\nexport default App; \n`}</code></pre>\n    <p>{`The last step is to have react-router to call the page change when the routing change. React-router is mainly configured in React, but I didn't want to have any more ReactGA code in React. The application I am working uses Redux and I have a middleware that handles route. At the moment, it checks if the route change and analyzes the URL to start fetching data on the backend.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-typescript\"\n      }}>{`return (api: MiddlewareAPI<AppReduxState>) => (next: Dispatch<AppReduxState>) => \n  <A extends Action>(action: A): A => { \n  // Logic here that check for action.type === LOCATION_CHANGE to fetch the proper data \n  // ... \n  // If action.type === LOCATION_CHANGE we also call the following line: ReactGA.pageview(actionTyped.payload.pathname); \n}; \n`}</code></pre>\n    <p>{`The previous code is clean. Indeed, I would rather not have anything inside React, but App.tsx is the entry point and the initialize function injects into the DOM Google's code. The Redux solution works well because the react-router-redux used gives the pathname which is the URL. By using the function \"pageview\" we are manually sending to Google Analytic a page change.`}</p>\n\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}
{"data":{"mdx":{"frontmatter":{"title":"Silverlight communication with Javascript","date":"October 16, 2011"},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Silverlight communication with Javascript\",\n  \"date\": \"2011-10-16\",\n  \"categories\": [\"silverlight\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"You may have some situation that you need to communicate with the page that your Silverlight reside.\"), mdx(\"p\", null, \"This can be done by three methods:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Passing parameter to Silverlight\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Silverlight call a Javascript method of your page\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The Javascript call a Silverlight method\")), mdx(\"h2\", null, \"Silverlight parameter\"), mdx(\"p\", null, \"All Silverlight application contain a startup method that has a StartupEventArgs. This class has a InitParam dictionary (IDictionary) that contains all parameters.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \" private void Application_Startup(object sender, StartupEventArgs e) { if (e.InitParams.ContainsKey(\\\"debug\\\")) { Debug.WriteLine(e.InitParams[\\\"debug\\\"]); } } \\n\")), mdx(\"p\", null, \"To pass parameters you need to add in the html a new element with the attribute name \\\"initParams\\\".\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \"<div id=\\\"silverlightControlHost\\\"> <object data=\\\"data:application/x-silverlight-2,\\\" type=\\\"application/x-silverlight-2\\\" width=\\\"100%\\\" height=\\\"100%\\\"> <param name=\\\"source\\\" value=\\\"ClientBin/MyProject.xap\\\"/> <param name=\\\"onError\\\" value=\\\"onSilverlightError\\\" /> <param name=\\\"background\\\" value=\\\"white\\\" /> <param name=\\\"minRuntimeVersion\\\" value=\\\"4.0.50826.0\\\" /> <param name=\\\"autoUpgrade\\\" value=\\\"true\\\" /> <a href=\\\"http://go.microsoft.com/fwlink/?LinkID=149156&v=4.0.50826.0\\\" style=\\\"text-decoration:none\\\"> <img src=\\\"http://go.microsoft.com/fwlink/?LinkId=161376\\\" alt=\\\"Get Microsoft Silverlight\\\" style=\\\"border-style:none\\\"/> </a> <param name=\\\"initParams\\\" value=\\\"debug=false, secondParameter=2 \\\" />\\n\\n</object> <iframe id=\\\"_sl_historyFrame\\\" style=\\\"visibility:hidden;height:0px;width:0px;border:0px\\\"></iframe> </div> \\n\")), mdx(\"p\", null, \"As you can see in this example, if you need more than one parameter you need to use a comma between all parameter. The value is automatically a string. You will need to parse it to the desired type inside Silverlight.\"), mdx(\"h2\", null, \"Silverlight communicate with Javascript\"), mdx(\"p\", null, \"The communication between Silverlight and Javascript is straight forward. You need to use the Invoke method of HtmlPage.Window.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \" System.Windows.Browser.HtmlPage.Window.Invoke(\\\"MyFunction\\\", \\\"Parameter1\\\"); System.Windows.Browser.HtmlPage.Window.Invoke(\\\"MyFunction\\\", \\\"Parameter1\\\", \\\"Parameter2\\\"); \\n\")), mdx(\"p\", null, \"The invoke method has a params[] for its second parameter. That let you add has many parameter value that the function in Javascript require. \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \" public virtual object Invoke(string name, params object[] args); \\n\")), mdx(\"h2\", null, \"Javascript to communicate with Silverlight\"), mdx(\"p\", null, \"Javascript can also call method inside a Silverlight application. To do, you need to first declare an entry point name.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-csharp\"\n  }, \" System.Windows.Browser.HtmlPage.RegisterScriptableObject(\\\"Page123\\\", this); \\n``` This code can be added at the beginning of the constructor of the method that will be called. It specifies a unique identifier that will be used in the Javascript.\\n\\nThe second thing that need to be done inside Silverlight is to add an attribute to the method that you want to expose to the external.\\n\\n```csharp\\n[ScriptableMember] public void JavascriptWillCallThisMethod(string textFromJavaScript) { \\n  Debug.WriteLine(textFromJavaScript); \\n} \\n\")), mdx(\"p\", null, \"The third and last step is to call this method from the Javascript code.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"var control = document.getElementById(\\\"silverlightControl\\\"); control.Content.Page123.JavascriptWillCallThisMethod(\\\"Hello from Javascript!\\\"); \\n\")), mdx(\"p\", null, \"As you can see, you find the \\\"Page123\\\" again here. It's the name declared in the Silverlight application when calling the \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"RegisterScriptableObject\"), \" method.\"));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"id":"65548627-6b43-51d6-8493-f229eee789ef","slug":"2011/silverlight-communication-with-javascript","__params":{"slug":"2011"}}}
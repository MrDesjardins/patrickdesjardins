3:I[5613,[],""]
5:I[1778,[],""]
4:["slug","c-transaction-for-sql-query","d"]
0:["U9WHEHP9m9dAVmOepwIU5",[[["",{"children":["blog",{"children":[["slug","c-transaction-for-sql-query","d"],{"children":["__PAGE__?{\"slug\":\"c-transaction-for-sql-query\"}",{}]}]}]},"$undefined","$undefined",true],["",{"children":["blog",{"children":[["slug","c-transaction-for-sql-query","d"],{"children":["__PAGE__",{},["$L1","$L2",null]]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","$4","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/e917b4f00bcb2347.css","precedence":"next","crossOrigin":""}]]}]]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]},[null,["$","html",null,{"lang":"en","children":[["$","head",null,{"children":[["$","title",null,{"children":"Patrick Desjardins Website and Blog"}],["$","meta",null,{"name":"viewport","content":"width=device-width, initial-scale=1, shrink-to-fit=no"}]]}],["$","body",null,{"className":"layout_bodystyle__4ncsS","children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[],"styles":null}]}]]}],null]],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/f7004a68ac8d367c.css","precedence":"next","crossOrigin":""}]],"$L6"]]]]
6:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","meta","2",{"name":"next-size-adjust"}]]
1:null
7:I[5250,["674","static/chunks/674-a46cce5ee161a346.js","308","static/chunks/app/blog/%5Bslug%5D/page-e23445258eb56deb.js"],""]
8:I[1749,["674","static/chunks/674-a46cce5ee161a346.js","308","static/chunks/app/blog/%5Bslug%5D/page-e23445258eb56deb.js"],"Image"]
2:["$","div",null,{"className":"__className_aaf875","children":["$","div",null,{"className":"layout_container__Tovb9","children":[["$","header",null,{"className":"layout_siteTitle__k5U8g","children":"Patrick Desjardins Blog"}],["$","nav",null,{"children":["$","ul",null,{"className":"layout_navLinks__mf70r","children":["$","li",null,{"className":"layout_navLinkItem__1L8fB","children":[["$","$L7",null,{"className":"layout_navLinkText__bt28R","href":"/","children":"Main Page"}],["$","$L7",null,{"className":"layout_navLinkText__bt28R","href":"/blog","children":"Blog"}],[["$","$L7","2024",{"className":"layout_navLinkText__bt28R","href":"/blog/for/2024","children":2024}],["$","$L7","2023",{"className":"layout_navLinkText__bt28R","href":"/blog/for/2023","children":2023}],["$","$L7","2022",{"className":"layout_navLinkText__bt28R","href":"/blog/for/2022","children":2022}],["$","$L7","2021",{"className":"layout_navLinkText__bt28R","href":"/blog/for/2021","children":2021}],["$","$L7","2020",{"className":"layout_navLinkText__bt28R","href":"/blog/for/2020","children":2020}],["$","$L7","2019",{"className":"layout_navLinkText__bt28R","href":"/blog/for/2019","children":2019}],["$","$L7","2018",{"className":"layout_navLinkText__bt28R","href":"/blog/for/2018","children":2018}],["$","$L7","2017",{"className":"layout_navLinkText__bt28R","href":"/blog/for/2017","children":2017}],["$","$L7","2016",{"className":"layout_navLinkText__bt28R","href":"/blog/for/2016","children":2016}],["$","$L7","2015",{"className":"layout_navLinkText__bt28R","href":"/blog/for/2015","children":2015}],["$","$L7","2014",{"className":"layout_navLinkText__bt28R","href":"/blog/for/2014","children":2014}],["$","$L7","2013",{"className":"layout_navLinkText__bt28R","href":"/blog/for/2013","children":2013}],["$","$L7","2012",{"className":"layout_navLinkText__bt28R","href":"/blog/for/2012","children":2012}],["$","$L7","2011",{"className":"layout_navLinkText__bt28R","href":"/blog/for/2011","children":2011}]]]}]}]}],["$","div",null,{"children":["$","$L8",null,{"className":"layout_blogTopPicture__RJHNN","alt":"Patrick Desjardins picture from a conference","src":"/images/backgrounds/patrickdesjardins_conference_bw.jpeg","width":1000,"height":300}]}],["$","main",null,{"className":"layout_main__mXTwS","children":[["$","h1",null,{"children":"C# Transaction for SQL query"}],["$","div",null,{"className":"layout_blogPostContainer__WYELx","children":[["$","p",null,{"className":"layout_blogPostDate__LUvx5","children":["Posted on: ","2011-09-30"]}],[["$","p",null,{"children":["Transaction lets you rollback if a problem occur. That mean that if you insert 100 entries into the database and 1 of them is wrong, the whole list of entry will be not saved in the persistence. This is very interesting because most of the time you want to have your action to be ",["$","a",null,{"href":"http://en.wikipedia.org/wiki/ACID#Atomicity","title":"Wikipedia Atomicity","children":"atomic"}],"."]}],"\n",["$","p",null,{"children":"This is an example of a good practice method that should been in a data access layer. To simplify, all will be written in the same file and the database used is the Northwind database."}],"\n",["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#fff","color":"#24292e"},"tabIndex":"0","data-language":"csharp","data-theme":"github-light","children":["$","code",null,{"data-language":"csharp","data-theme":"github-light","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#D73A49"},"children":"public"}],["$","span",null,{"style":{"color":"#D73A49"},"children":" class"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" Customer"}],["$","span",null,{"style":{"color":"#24292E"},"children":" { "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#D73A49"},"children":"  public"}],["$","span",null,{"style":{"color":"#D73A49"},"children":" string"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" Id"}],["$","span",null,{"style":{"color":"#24292E"},"children":" { "}],["$","span",null,{"style":{"color":"#D73A49"},"children":"get"}],["$","span",null,{"style":{"color":"#24292E"},"children":"; "}],["$","span",null,{"style":{"color":"#D73A49"},"children":"set"}],["$","span",null,{"style":{"color":"#24292E"},"children":"; } "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#D73A49"},"children":"  public"}],["$","span",null,{"style":{"color":"#D73A49"},"children":" string"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" Name"}],["$","span",null,{"style":{"color":"#24292E"},"children":" { "}],["$","span",null,{"style":{"color":"#D73A49"},"children":"get"}],["$","span",null,{"style":{"color":"#24292E"},"children":"; "}],["$","span",null,{"style":{"color":"#D73A49"},"children":"set"}],["$","span",null,{"style":{"color":"#24292E"},"children":"; } "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#D73A49"},"children":"  public"}],["$","span",null,{"style":{"color":"#D73A49"},"children":" bool"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" IsNew"}],["$","span",null,{"style":{"color":"#24292E"},"children":" { "}],["$","span",null,{"style":{"color":"#D73A49"},"children":"get"}],["$","span",null,{"style":{"color":"#24292E"},"children":"; "}],["$","span",null,{"style":{"color":"#D73A49"},"children":"set"}],["$","span",null,{"style":{"color":"#24292E"},"children":"; } "}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#24292E"},"children":"}"}]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#D73A49"},"children":"public"}],["$","span",null,{"style":{"color":"#D73A49"},"children":" partial"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" class_Default"}],["$","span",null,{"style":{"color":"#24292E"},"children":" : System.Web.UI.Page { "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#24292E"},"children":"  protected "}],["$","span",null,{"style":{"color":"#D73A49"},"children":"void"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" Page_Load"}],["$","span",null,{"style":{"color":"#24292E"},"children":"("}],["$","span",null,{"style":{"color":"#D73A49"},"children":"object"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" sender"}],["$","span",null,{"style":{"color":"#24292E"},"children":", "}],["$","span",null,{"style":{"color":"#6F42C1"},"children":"EventArgs"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" e"}],["$","span",null,{"style":{"color":"#24292E"},"children":") { "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#6F42C1"},"children":"    List"}],["$","span",null,{"style":{"color":"#24292E"},"children":"<"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":"Customer"}],["$","span",null,{"style":{"color":"#24292E"},"children":"> "}],["$","span",null,{"style":{"color":"#6F42C1"},"children":"customers"}],["$","span",null,{"style":{"color":"#D73A49"},"children":" ="}],["$","span",null,{"style":{"color":"#D73A49"},"children":" new"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" List"}],["$","span",null,{"style":{"color":"#24292E"},"children":"<"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":"Customer"}],["$","span",null,{"style":{"color":"#24292E"},"children":">(){ "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#D73A49"},"children":"      new"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" Customer"}],["$","span",null,{"style":{"color":"#24292E"},"children":"(){Id"}],["$","span",null,{"style":{"color":"#D73A49"},"children":"="}],["$","span",null,{"style":{"color":"#032F62"},"children":"\"ID001\""}],["$","span",null,{"style":{"color":"#24292E"},"children":", Name"}],["$","span",null,{"style":{"color":"#D73A49"},"children":"="}],["$","span",null,{"style":{"color":"#032F62"},"children":"\"Name001\""}],["$","span",null,{"style":{"color":"#24292E"},"children":", IsNew"}],["$","span",null,{"style":{"color":"#D73A49"},"children":"="}],["$","span",null,{"style":{"color":"#005CC5"},"children":"true"}],["$","span",null,{"style":{"color":"#24292E"},"children":"} , "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#D73A49"},"children":"      new"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" Customer"}],["$","span",null,{"style":{"color":"#24292E"},"children":"(){Id"}],["$","span",null,{"style":{"color":"#D73A49"},"children":"="}],["$","span",null,{"style":{"color":"#032F62"},"children":"\"ID002\""}],["$","span",null,{"style":{"color":"#24292E"},"children":", Name"}],["$","span",null,{"style":{"color":"#D73A49"},"children":"="}],["$","span",null,{"style":{"color":"#032F62"},"children":"\"Name002\""}],["$","span",null,{"style":{"color":"#24292E"},"children":", IsNew"}],["$","span",null,{"style":{"color":"#D73A49"},"children":"="}],["$","span",null,{"style":{"color":"#005CC5"},"children":"true"}],["$","span",null,{"style":{"color":"#24292E"},"children":"} , "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#D73A49"},"children":"      new"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" Customer"}],["$","span",null,{"style":{"color":"#24292E"},"children":"(){Id"}],["$","span",null,{"style":{"color":"#D73A49"},"children":"="}],["$","span",null,{"style":{"color":"#032F62"},"children":"\"ID003\""}],["$","span",null,{"style":{"color":"#24292E"},"children":", Name"}],["$","span",null,{"style":{"color":"#D73A49"},"children":"="}],["$","span",null,{"style":{"color":"#032F62"},"children":"\"Name003\""}],["$","span",null,{"style":{"color":"#24292E"},"children":", IsNew"}],["$","span",null,{"style":{"color":"#D73A49"},"children":"="}],["$","span",null,{"style":{"color":"#005CC5"},"children":"true"}],["$","span",null,{"style":{"color":"#24292E"},"children":"} "}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#24292E"},"children":"    }; "}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#6F42C1"},"children":"    SaveCustomers"}],["$","span",null,{"style":{"color":"#24292E"},"children":"(customers); "}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#24292E"},"children":"  }"}]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#24292E"},"children":"  public "}],["$","span",null,{"style":{"color":"#D73A49"},"children":"int"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" SaveCustomers"}],["$","span",null,{"style":{"color":"#24292E"},"children":"("}],["$","span",null,{"style":{"color":"#6F42C1"},"children":"IEnumerable"}],["$","span",null,{"style":{"color":"#24292E"},"children":"<"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":"Customer"}],["$","span",null,{"style":{"color":"#24292E"},"children":"> "}],["$","span",null,{"style":{"color":"#6F42C1"},"children":"customers"}],["$","span",null,{"style":{"color":"#24292E"},"children":") { "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#6F42C1"},"children":"    ConnectionStringSettings"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" connectionStringSettings"}],["$","span",null,{"style":{"color":"#D73A49"},"children":" ="}],["$","span",null,{"style":{"color":"#24292E"},"children":" ConfigurationManager.ConnectionStrings["}],["$","span",null,{"style":{"color":"#032F62"},"children":"\"ApplicationServices\""}],["$","span",null,{"style":{"color":"#24292E"},"children":"];"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#D73A49"},"children":"    int"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" rowsAffected"}],["$","span",null,{"style":{"color":"#D73A49"},"children":"="}],["$","span",null,{"style":{"color":"#005CC5"},"children":"0"}],["$","span",null,{"style":{"color":"#24292E"},"children":"; "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#D73A49"},"children":"    using"}],["$","span",null,{"style":{"color":"#24292E"},"children":" ("}],["$","span",null,{"style":{"color":"#D73A49"},"children":"var"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" connection"}],["$","span",null,{"style":{"color":"#D73A49"},"children":" ="}],["$","span",null,{"style":{"color":"#D73A49"},"children":" new"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" SqlConnection"}],["$","span",null,{"style":{"color":"#24292E"},"children":"(connectionStringSettings.ConnectionString)) { "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#24292E"},"children":"      connection."}],["$","span",null,{"style":{"color":"#6F42C1"},"children":"Open"}],["$","span",null,{"style":{"color":"#24292E"},"children":"(); "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#D73A49"},"children":"      var"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" transaction"}],["$","span",null,{"style":{"color":"#D73A49"},"children":" ="}],["$","span",null,{"style":{"color":"#24292E"},"children":" connection."}],["$","span",null,{"style":{"color":"#6F42C1"},"children":"BeginTransaction"}],["$","span",null,{"style":{"color":"#24292E"},"children":"(); "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#D73A49"},"children":"      using"}],["$","span",null,{"style":{"color":"#24292E"},"children":" ("}],["$","span",null,{"style":{"color":"#D73A49"},"children":"var"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" command"}],["$","span",null,{"style":{"color":"#D73A49"},"children":" ="}],["$","span",null,{"style":{"color":"#D73A49"},"children":" new"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" SqlCommand"}],["$","span",null,{"style":{"color":"#24292E"},"children":"()) { "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#24292E"},"children":"        command.Transaction "}],["$","span",null,{"style":{"color":"#D73A49"},"children":"="}],["$","span",null,{"style":{"color":"#24292E"},"children":" transaction; "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#24292E"},"children":"        command.Connection "}],["$","span",null,{"style":{"color":"#D73A49"},"children":"="}],["$","span",null,{"style":{"color":"#24292E"},"children":" connection; "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#D73A49"},"children":"        try"}],["$","span",null,{"style":{"color":"#24292E"},"children":" { "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#D73A49"},"children":"          foreach"}],["$","span",null,{"style":{"color":"#24292E"},"children":" ("}],["$","span",null,{"style":{"color":"#D73A49"},"children":"var"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" customer"}],["$","span",null,{"style":{"color":"#D73A49"},"children":" in"}],["$","span",null,{"style":{"color":"#24292E"},"children":" customers) { "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#D73A49"},"children":"            if"}],["$","span",null,{"style":{"color":"#24292E"},"children":" (customer.IsNew) { "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#24292E"},"children":"              command.CommandText "}],["$","span",null,{"style":{"color":"#D73A49"},"children":"="}],["$","span",null,{"style":{"color":"#032F62"},"children":" \"INSERT INTO customers (CustomerID, CompanyName) VALUES (@id, @name)\""}],["$","span",null,{"style":{"color":"#24292E"},"children":"; "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#24292E"},"children":"            } "}],["$","span",null,{"style":{"color":"#D73A49"},"children":"else"}],["$","span",null,{"style":{"color":"#24292E"},"children":" { "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#24292E"},"children":"              command.CommandText "}],["$","span",null,{"style":{"color":"#D73A49"},"children":"="}],["$","span",null,{"style":{"color":"#032F62"},"children":" \"UPDATE customers SET CompanyName = @name WHERE CustomerID = @id\""}],["$","span",null,{"style":{"color":"#24292E"},"children":"; "}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#24292E"},"children":"            } "}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#24292E"},"children":"            command.CommandType "}],["$","span",null,{"style":{"color":"#D73A49"},"children":"="}],["$","span",null,{"style":{"color":"#24292E"},"children":" System.Data.CommandType.Text; command.Parameters."}],["$","span",null,{"style":{"color":"#6F42C1"},"children":"Clear"}],["$","span",null,{"style":{"color":"#24292E"},"children":"(); "}],["$","span",null,{"style":{"color":"#6A737D"},"children":"//Remove "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#24292E"},"children":"            command.Parameters."}],["$","span",null,{"style":{"color":"#6F42C1"},"children":"Add"}],["$","span",null,{"style":{"color":"#24292E"},"children":"("}],["$","span",null,{"style":{"color":"#D73A49"},"children":"new"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" SqlParameter"}],["$","span",null,{"style":{"color":"#24292E"},"children":"("}],["$","span",null,{"style":{"color":"#032F62"},"children":"\"id\""}],["$","span",null,{"style":{"color":"#24292E"},"children":", customer.Id)); "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#24292E"},"children":"            command.Parameters."}],["$","span",null,{"style":{"color":"#6F42C1"},"children":"Add"}],["$","span",null,{"style":{"color":"#24292E"},"children":"("}],["$","span",null,{"style":{"color":"#D73A49"},"children":"new"}],["$","span",null,{"style":{"color":"#6F42C1"},"children":" SqlParameter"}],["$","span",null,{"style":{"color":"#24292E"},"children":"("}],["$","span",null,{"style":{"color":"#032F62"},"children":"\"name\""}],["$","span",null,{"style":{"color":"#24292E"},"children":", customer.Name)); "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#24292E"},"children":"            rowsAffected "}],["$","span",null,{"style":{"color":"#D73A49"},"children":"+="}],["$","span",null,{"style":{"color":"#24292E"},"children":" command."}],["$","span",null,{"style":{"color":"#6F42C1"},"children":"ExecuteNonQuery"}],["$","span",null,{"style":{"color":"#24292E"},"children":"(); "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#24292E"},"children":"          } transaction."}],["$","span",null,{"style":{"color":"#6F42C1"},"children":"Commit"}],["$","span",null,{"style":{"color":"#24292E"},"children":"(); "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#24292E"},"children":"        } "}],["$","span",null,{"style":{"color":"#D73A49"},"children":"catch"}],["$","span",null,{"style":{"color":"#24292E"},"children":" { "}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#24292E"},"children":"          transaction."}],["$","span",null,{"style":{"color":"#6F42C1"},"children":"Rollback"}],["$","span",null,{"style":{"color":"#24292E"},"children":"(); "}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#24292E"},"children":"        } "}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#24292E"},"children":"      } "}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#24292E"},"children":"      connection."}],["$","span",null,{"style":{"color":"#6F42C1"},"children":"Close"}],["$","span",null,{"style":{"color":"#24292E"},"children":"();"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#24292E"},"children":"    }"}]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#D73A49"},"children":"    return"}],["$","span",null,{"style":{"color":"#24292E"},"children":" rowsAffected; "}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#24292E"},"children":"  } "}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#24292E"},"children":"} "}]}]]}]}]}],"\n",["$","p",null,{"children":"This code contain some interesting things. First, to create a transaction you must have a connection already open. This is required. Otherwise you will have an exception that will told you that the connection is close."}],"\n",["$","p",null,{"children":["Second, you must know that if you forget to commit once you are done querying that even if all queries were legit that the database won't have your data. That's right, even if the ",["$","span",null,{"data-rehype-pretty-code-figure":"","children":["$","code",null,{"data-language":"plaintext","data-theme":"github-light","style":{"backgroundColor":"#fff","color":"#24292e"},"children":["$","span",null,{"data-line":"","children":["$","span",null,{"children":"rowsAffected += command.ExecuteNonQuery();"}]}]}]}]," add number in the rowAffected, this won't be real until you commit. The code above works because all customers have IsNew to true. If you run this code and change one to False you will tell the Save method to use the Update statement. The command will Update but the database won't find the customer and throw an exception. What it means is that the code will go in the catch and RollBack the transaction. Even if the rowsAffected is at 1, you will have 0 rows added or updated in the database."]}],"\n",["$","h1",null,{"children":"Type of isolation"}],"\n",["$","p",null,{"children":["To create a transaction you need to get it from the DbCommand. The reason is simple, a transaction is different between database provider. So, when using the ",["$","span",null,{"data-rehype-pretty-code-figure":"","children":["$","code",null,{"data-language":"plaintext","data-theme":"github-light","style":{"backgroundColor":"#fff","color":"#24292e"},"children":["$","span",null,{"data-line":"","children":["$","span",null,{"children":"SqlDbCommand"}]}]}]}],", you will have more option of transaction for the Microsoft Sql Server Database. Also, transaction code will do isolation on the database. Sql Server let you do different type of transaction."]}],"\n",["$","p",null,{"children":["$","img",null,{"src":"/images/blog/typetransctionsql.png","alt":""}]}],"\n",["$","h2",null,{"children":"ReadUncommitted"}],"\n",["$","p",null,{"children":"This is a very weak transaction and should not be used. In fact, this type doesn't lock anything in the database. It's possible that the data changes or be deleted by the time the commit is done. This can lead to unpredictable reaction. This type of isolation will produce for a Select statement this query:"}],"\n",["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#fff","color":"#24292e"},"tabIndex":"0","data-language":"sql","data-theme":"github-light","children":["$","code",null,{"data-language":"sql","data-theme":"github-light","style":{"display":"grid"},"children":["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#D73A49"},"children":" SELECT"}],["$","span",null,{"style":{"color":"#D73A49"},"children":" *"}],["$","span",null,{"style":{"color":"#D73A49"},"children":" FROM"}],["$","span",null,{"style":{"color":"#24292E"},"children":" CUSTOMERS "}],["$","span",null,{"style":{"color":"#D73A49"},"children":"WITH"}],["$","span",null,{"style":{"color":"#24292E"},"children":" ("}],["$","span",null,{"style":{"color":"#D73A49"},"children":"NOLOCK"}],["$","span",null,{"style":{"color":"#24292E"},"children":") "}]]}]}]}]}],"\n",["$","h2",null,{"children":"ReadCommitted"}],"\n",["$","p",null,{"children":"This one try to have a share-lock on the data. If it succeed, it will protect any change from the external into those values.- RepeatableRead\nAll the data implicate in the transaction are lock.- Serializable\nAll the table is lock. This prevent adding other rows to the table. This is the best isolation but it comes with the cost of being not performant. Locking more value than desire can lead to reduce the speed to all other connection that need to read or edit these rows.- Snapshot\nIf your database is Sql Server 2005 and over you can use this type of transaction that will do a copy of the affected row. To be more accurate, rows are versionned and when others connection want to access these rows instead of locking a copy is made. This keep the system in good shape without creating any slow time for anyone."}],"\n",["$","h1",null,{"children":"Transaction Type"}],"\n",["$","p",null,{"children":["This type of transaction is known as ",["$","strong",null,{"children":"Lightweight Transaction Manager (LTM)"}]," because only one connection is required. Sometime, you may use one connection to read and while it's looping you could open an other connection to update. Anytime you have two connections open, the transaction type become ",["$","strong",null,{"children":"Distributed Transaction (DT)"}],". Microsoft Windows operating system have a Distributed Transaction Coordinator (DTC) that is a service that run in the background of your computer. The Distributed Transaction Coordinator (DTC) requires the use of System.Transactions that will be discussed in a later article or to use explicit code to execute the code under DTC. To use DTC developers have to create classes that inherited from the ServicedComponent class in the System.EnterpriseServices namespace. This won't be discussed because it's easier now to simply use the System.Transactions that handle implicitly if it really require to be DTC or LTM."]}],"\n",["$","p",null,{"children":["$","img",null,{"src":"/images/blog/dtc.png","alt":""}]}]]]}]]}],["$","div",null,{"className":"layout_paginationBar__jnuuR","children":[["$","div",null,{"className":"layout_paginationTitle__PsOw5","children":"Chronological Blog Articles by Page"}],["$","div",null,{"className":"layout_paginationLinks__LdBaH","children":[["$","$L7","1",{"className":"","href":"/blog/page/1","children":1}],["$","$L7","2",{"className":"","href":"/blog/page/2","children":2}],["$","$L7","3",{"className":"","href":"/blog/page/3","children":3}],["$","$L7","4",{"className":"","href":"/blog/page/4","children":4}],["$","$L7","5",{"className":"","href":"/blog/page/5","children":5}],["$","$L7","6",{"className":"","href":"/blog/page/6","children":6}],["$","$L7","7",{"className":"","href":"/blog/page/7","children":7}],["$","$L7","8",{"className":"","href":"/blog/page/8","children":8}],["$","$L7","9",{"className":"","href":"/blog/page/9","children":9}],["$","$L7","10",{"className":"","href":"/blog/page/10","children":10}],["$","$L7","11",{"className":"","href":"/blog/page/11","children":11}],["$","$L7","12",{"className":"","href":"/blog/page/12","children":12}],["$","$L7","13",{"className":"","href":"/blog/page/13","children":13}],["$","$L7","14",{"className":"","href":"/blog/page/14","children":14}],["$","$L7","15",{"className":"","href":"/blog/page/15","children":15}],["$","$L7","16",{"className":"","href":"/blog/page/16","children":16}],["$","$L7","17",{"className":"","href":"/blog/page/17","children":17}],["$","$L7","18",{"className":"","href":"/blog/page/18","children":18}],["$","$L7","19",{"className":"","href":"/blog/page/19","children":19}],["$","$L7","20",{"className":"","href":"/blog/page/20","children":20}],["$","$L7","21",{"className":"","href":"/blog/page/21","children":21}],["$","$L7","22",{"className":"","href":"/blog/page/22","children":22}],["$","$L7","23",{"className":"","href":"/blog/page/23","children":23}],["$","$L7","24",{"className":"","href":"/blog/page/24","children":24}],["$","$L7","25",{"className":"","href":"/blog/page/25","children":25}],["$","$L7","26",{"className":"","href":"/blog/page/26","children":26}],["$","$L7","27",{"className":"","href":"/blog/page/27","children":27}],["$","$L7","28",{"className":"","href":"/blog/page/28","children":28}],["$","$L7","29",{"className":"","href":"/blog/page/29","children":29}],["$","$L7","30",{"className":"","href":"/blog/page/30","children":30}],["$","$L7","31",{"className":"","href":"/blog/page/31","children":31}],["$","$L7","32",{"className":"","href":"/blog/page/32","children":32}],["$","$L7","33",{"className":"","href":"/blog/page/33","children":33}],["$","$L7","34",{"className":"","href":"/blog/page/34","children":34}],["$","$L7","35",{"className":"","href":"/blog/page/35","children":35}],["$","$L7","36",{"className":"","href":"/blog/page/36","children":36}],["$","$L7","37",{"className":"","href":"/blog/page/37","children":37}],["$","$L7","38",{"className":"","href":"/blog/page/38","children":38}],["$","$L7","39",{"className":"","href":"/blog/page/39","children":39}],["$","$L7","40",{"className":"","href":"/blog/page/40","children":40}],["$","$L7","41",{"className":"","href":"/blog/page/41","children":41}],["$","$L7","42",{"className":"","href":"/blog/page/42","children":42}],["$","$L7","43",{"className":"","href":"/blog/page/43","children":43}],["$","$L7","44",{"className":"","href":"/blog/page/44","children":44}],["$","$L7","45",{"className":"","href":"/blog/page/45","children":45}],["$","$L7","46",{"className":"","href":"/blog/page/46","children":46}],["$","$L7","47",{"className":"","href":"/blog/page/47","children":47}],["$","$L7","48",{"className":"","href":"/blog/page/48","children":48}],["$","$L7","49",{"className":"","href":"/blog/page/49","children":49}],["$","$L7","50",{"className":"","href":"/blog/page/50","children":50}],["$","$L7","51",{"className":"","href":"/blog/page/51","children":51}],["$","$L7","52",{"className":"","href":"/blog/page/52","children":52}],["$","$L7","53",{"className":"","href":"/blog/page/53","children":53}],["$","$L7","54",{"className":"","href":"/blog/page/54","children":54}],["$","$L7","55",{"className":"","href":"/blog/page/55","children":55}],["$","$L7","56",{"className":"","href":"/blog/page/56","children":56}],["$","$L7","57",{"className":"","href":"/blog/page/57","children":57}],["$","$L7","58",{"className":"","href":"/blog/page/58","children":58}],["$","$L7","59",{"className":"","href":"/blog/page/59","children":59}],["$","$L7","60",{"className":"","href":"/blog/page/60","children":60}],["$","$L7","61",{"className":"","href":"/blog/page/61","children":61}],["$","$L7","62",{"className":"","href":"/blog/page/62","children":62}],["$","$L7","63",{"className":"","href":"/blog/page/63","children":63}],["$","$L7","64",{"className":"","href":"/blog/page/64","children":64}],["$","$L7","65",{"className":"","href":"/blog/page/65","children":65}],["$","$L7","66",{"className":"","href":"/blog/page/66","children":66}],["$","$L7","67",{"className":"","href":"/blog/page/67","children":67}],["$","$L7","68",{"className":"","href":"/blog/page/68","children":68}],["$","$L7","69",{"className":"","href":"/blog/page/69","children":69}],["$","$L7","70",{"className":"","href":"/blog/page/70","children":70}],["$","$L7","71",{"className":"","href":"/blog/page/71","children":71}],["$","$L7","72",{"className":"","href":"/blog/page/72","children":72}],["$","$L7","73",{"className":"","href":"/blog/page/73","children":73}],["$","$L7","74",{"className":"","href":"/blog/page/74","children":74}],["$","$L7","75",{"className":"","href":"/blog/page/75","children":75}],["$","$L7","76",{"className":"","href":"/blog/page/76","children":76}],["$","$L7","77",{"className":"","href":"/blog/page/77","children":77}]]}]]}]]}]}]

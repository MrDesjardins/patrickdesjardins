3:I[6405,[],""]
5:I[5337,[],""]
6:I[156,["156","static/chunks/156-2b9f703633e98ef7.js","836","static/chunks/836-7e37630a3372363c.js","308","static/chunks/app/blog/%5Bslug%5D/page-2829e3c199d313ca.js"],""]
4:["slug","react-context-how-to-avoid-rendering","d"]
0:["x1XS5p8lSGVWZb0jyLF7C",[[["",{"children":["blog",{"children":[["slug","react-context-how-to-avoid-rendering","d"],{"children":["__PAGE__?{\"slug\":\"react-context-how-to-avoid-rendering\"}",{}]}]}]},"$undefined","$undefined",true],["",{"children":["blog",{"children":[["slug","react-context-how-to-avoid-rendering","d"],{"children":["__PAGE__",{},[["$L1","$L2",[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/be8a59717d6d5849.css","precedence":"next","crossOrigin":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/css/97e0a79122e618e4.css","precedence":"next","crossOrigin":"$undefined"}]]],null],null]},[null,["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","$4","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]],null]},[[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/dabd5e64a469b0e1.css","precedence":"next","crossOrigin":"$undefined"}]],["$","div",null,{"className":"layout_blogbodystyle___Uc1w","children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]}]],null],null]},[[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/4cb872a2a77e328a.css","precedence":"next","crossOrigin":"$undefined"}]],["$","html",null,{"lang":"en","className":"layout_htmlstyle__PseMz","children":["$","body",null,{"className":"layout_bodystyle__4ncsS","children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","div",null,{"style":{"display":"flex","alignItems":"center","justifyContent":"center","height":"100vh"},"children":["$","div",null,{"style":{"width":"50%","height":"20%","backgroundColor":"#ffeded","borderRadius":12,"padding":12,"textAlign":"center"},"children":[["$","h1",null,{"children":"Not Found"}],["$","p",null,{"children":"Could not find requested resource"}],["$","$L6",null,{"href":"/","children":"Return Home"}]]}]}],"notFoundStyles":[]}]}]}]],null],null],["$L7",null]]]]
8:I[836,["156","static/chunks/156-2b9f703633e98ef7.js","836","static/chunks/836-7e37630a3372363c.js","308","static/chunks/app/blog/%5Bslug%5D/page-2829e3c199d313ca.js"],"Image"]
2:["$","div",null,{"className":"BlogBody_BlogBody__600mT","children":[["$","header",null,{"className":"BlogBody_siteTitle__f7uyb","children":"Patrick Desjardins Blog"}],["$","nav",null,{"children":["$","ul",null,{"className":"BlogBody_navLinks__ZV12t","children":["$","li",null,{"className":"BlogBody_navLinkItem__Pml2e","children":[["$","$L6",null,{"className":"BlogBody_navLinkText__ZtH2y","href":"/","children":"Main Page"}],["$","$L6",null,{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog","children":"Blog"}],["$","$L6",null,{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/search","children":"Search"}],[["$","$L6","2026",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2026","children":2026}],["$","$L6","2025",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2025","children":2025}],["$","$L6","2024",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2024","children":2024}],["$","$L6","2023",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2023","children":2023}],["$","$L6","2022",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2022","children":2022}],["$","$L6","2021",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2021","children":2021}],["$","$L6","2020",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2020","children":2020}],["$","$L6","2019",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2019","children":2019}],["$","$L6","2018",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2018","children":2018}],["$","$L6","2017",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2017","children":2017}],["$","$L6","2016",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2016","children":2016}],["$","$L6","2015",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2015","children":2015}],["$","$L6","2014",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2014","children":2014}],["$","$L6","2013",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2013","children":2013}],["$","$L6","2012",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2012","children":2012}],["$","$L6","2011",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2011","children":2011}]]]}]}]}],["$","div",null,{"className":"BlogBody_blogPictureContainer__IAbPL","children":["$","$L8",null,{"className":"BlogBody_blogTopPicture__L6lao","alt":"Patrick Desjardins picture from a conference","src":"/images/backgrounds/patrickdesjardins_conference_bw.webp","width":800,"height":260}]}],["$","main",null,{"className":"BlogBody_main__XrdKY","children":[["$","h1",null,{"className":"BlogBody_heading__bYRBe","children":"React Context and How to Avoid repetitive re-rendering"}],["$","div",null,{"className":"Page_blogPostContainer__AUIcf","children":[["$","p",null,{"className":"Page_blogPostDate__wVWWB","children":["Posted on: ","2023-01-20"]}],[["$","p",null,{"children":["In this article, we will see how to optimize the usage of a context to avoid rendering components along the path of the context. We already explored ",["$","a",null,{"href":"https://patrickdesjardins.com/blog/react-children-function-render","children":"React Children Function Render optimization"}],". This time, we will focus on children that are not functions."]}],"\n",["$","h1",null,{"children":"Context"}],"\n",["$","p",null,{"children":"The small project is an application with three layers."}],"\n",["$","p",null,{"children":["$","img",null,{"src":"/images/blog/react-re-render1.png","alt":""}]}],"\n",["$","p",null,{"children":["The top layer, named ",["$","code",null,{"children":"Layer1"}]," is wrapped by a context. The context is updated every second with an incremental value. It simulates a data change that occurs often. The example is set that only ",["$","code",null,{"children":"Layer3"}]," needs the value. Thus, we would like to avoid rendering Layer1, and Layer2 as they have no business with the changed value."]}],"\n",["$","h1",null,{"children":"Skeleton Code"}],"\n",["$","p",null,{"children":"Before talking, let's establish a code baseline to illustrate the context of the multi-layer components that rely on context."}],"\n",["$","iframe",null,{"src":"https://codesandbox.io/embed/react-context-re-render-part1-wqpp64","style":{"width":"100%","height":"500px","border":0,"borderRadius":"4px","overflow":"hidden"},"title":"Code Sandbox","allow":"accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking","sandbox":"allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"}],"\n",["$","p",null,{"children":["The ",["$","code",null,{"children":"MyUniqueContext"}]," has an interval function that increments a number every second. The change modifies the state, making the context change."]}],"\n",["$","pre",null,{"className":"language-tsx","children":["$","code",null,{"className":"language-tsx code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token keyword","children":"export"}]," ",["$","span",null,{"className":"token keyword","children":"const"}]," ",["$","span",null,{"className":"token maybe-class-name","children":"MyContextProvider"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token punctuation","children":"("}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  props",["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token maybe-class-name","children":"MyContextStateContextProviderProps"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token maybe-class-name","children":"ReactElement"}]," ",["$","span",null,{"className":"token arrow operator","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"const"}]," ",["$","span",null,{"className":"token punctuation","children":"["}],"counter",["$","span",null,{"className":"token punctuation","children":","}]," setCounter",["$","span",null,{"className":"token punctuation","children":"]"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token generic-function","children":[["$","span",null,{"className":"token function","children":"useState"}],["$","span",null,{"className":"token generic class-name","children":[["$","span",null,{"className":"token operator","children":"<"}],["$","span",null,{"className":"token builtin","children":"number"}],["$","span",null,{"className":"token operator","children":">"}]]}]]}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token number","children":"0"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token function","children":"useInterval"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token arrow operator","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token function","children":"setCounter"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":"("}],"d",["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token arrow operator","children":"=>"}]," d ",["$","span",null,{"className":"token operator","children":"+"}]," ",["$","span",null,{"className":"token number","children":"1"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"1000"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"return"}]," ",["$","span",null,{"className":"token punctuation","children":"("}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],["$","span",null,{"className":"token class-name","children":"MyContextStateContext.Provider"}]]}],"\r\n"]}]]}],["$","span",null,{"className":"code-line","children":["$","span",null,{"className":"token tag","children":["      ",["$","span",null,{"className":"token attr-name","children":"value"}],["$","span",null,{"className":"token script language-javascript","children":[["$","span",null,{"className":"token script-punctuation punctuation","children":"="}],["$","span",null,{"className":"token punctuation","children":"{"}],["$","span",null,{"className":"token punctuation","children":"{"}],"\r\n"]}]]}]}],["$","span",null,{"className":"code-line","children":["$","span",null,{"className":"token tag","children":["$","span",null,{"className":"token script language-javascript","children":["        counter",["$","span",null,{"className":"token operator","children":":"}]," counter",["$","span",null,{"className":"token punctuation","children":","}],"\r\n"]}]}]}],["$","span",null,{"className":"code-line","children":["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token script language-javascript","children":["      ",["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":"}"}]]}],"\r\n"]}]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token tag","children":["    ",["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"      "}],["$","span",null,{"className":"token punctuation","children":"{"}],"props",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"children"}],["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"    "}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],["$","span",null,{"className":"token class-name","children":"MyContextStateContext.Provider"}]]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}]]}]}],"\n",["$","p",null,{"children":[["$","code",null,{"children":"Layer1"}]," and ",["$","code",null,{"children":"Layer2"}]," do not need to be re-render because they do not consume the context. Only ",["$","code",null,{"children":"Layer3"}],"."]}],"\n",["$","pre",null,{"className":"language-tsx","children":["$","code",null,{"className":"language-tsx code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token keyword","children":"export"}]," ",["$","span",null,{"className":"token keyword","children":"const"}]," ",["$","span",null,{"className":"token function-variable function","children":"Layer1"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token arrow operator","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token console class-name","children":"console"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token method function property-access","children":"log"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"Render: Layer 1\""}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"return"}]," ",["$","span",null,{"className":"token punctuation","children":"("}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"div"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"      "}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"h1"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token plain-text","children":"Layer1"}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"h1"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"      "}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],["$","span",null,{"className":"token class-name","children":"Layer2"}]]}]," ",["$","span",null,{"className":"token punctuation","children":"/>"}]]}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"    "}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"div"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":"\r\n"}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token keyword","children":"export"}]," ",["$","span",null,{"className":"token keyword","children":"const"}]," ",["$","span",null,{"className":"token function-variable function","children":"Layer2"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token arrow operator","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token console class-name","children":"console"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token method function property-access","children":"log"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"Render: Layer 2\""}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"return"}]," ",["$","span",null,{"className":"token punctuation","children":"("}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"div"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"      "}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"h2"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token plain-text","children":"Layer2"}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"h2"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"      "}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],["$","span",null,{"className":"token class-name","children":"Layer3"}]]}]," ",["$","span",null,{"className":"token punctuation","children":"/>"}]]}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"    "}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"div"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}]]}]}],"\n",["$","p",null,{"children":[["$","code",null,{"children":"Layer3"}]," component calls ",["$","code",null,{"children":"useContext"}],", making it aware of changes, and re-rendering every counter change. Therefore, it is expected that it renders the value of the counter."]}],"\n",["$","pre",null,{"className":"language-tsx","children":["$","code",null,{"className":"language-tsx code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token keyword","children":"export"}]," ",["$","span",null,{"className":"token keyword","children":"const"}]," ",["$","span",null,{"className":"token function-variable function","children":"Layer3"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token arrow operator","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token console class-name","children":"console"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token method function property-access","children":"log"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"Render: Layer 3\""}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"const"}]," contextState ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token function","children":"useContext"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token maybe-class-name","children":"MyContextStateContext"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"return"}]," ",["$","span",null,{"className":"token punctuation","children":"("}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"div"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"      "}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"h3"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token plain-text","children":"Layer3"}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"h3"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"      "}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"p"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token punctuation","children":"{"}],"contextState",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"counter"}],["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"p"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"    "}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"div"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}]]}]}],"\n",["$","h1",null,{"children":"No Problem?"}],"\n",["$","p",null,{"children":"If you are running the code, you notice that it works as expected. Only the Layer3.tsx has in the console the text about being rendered."}],"\n",["$","pre",null,{"className":"language-json","children":["$","code",null,{"className":"language-json code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token number","children":"1"}],["$","span",null,{"className":"token operator","children":":"}]," Render",["$","span",null,{"className":"token operator","children":":"}]," Layer ",["$","span",null,{"className":"token number","children":"1"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token number","children":"1"}],["$","span",null,{"className":"token operator","children":":"}]," Render",["$","span",null,{"className":"token operator","children":":"}]," Layer ",["$","span",null,{"className":"token number","children":"2"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token number","children":"694"}],["$","span",null,{"className":"token operator","children":":"}]," Render",["$","span",null,{"className":"token operator","children":":"}]," Layer ",["$","span",null,{"className":"token number","children":"3"}]," ",["$","span",null,{"className":"token comment","children":"// Here we see 694 updates"}],"\n"]}]]}]}],"\n",["$","h1",null,{"children":"Changing the Example"}],"\n",["$","p",null,{"children":["The example needs to be more realistic. Most of the time, a context will have several values. Many values are essential to ",["$","code",null,{"children":"Layer1"}]," and ",["$","code",null,{"children":"Layer2,"}]," but only the ",["$","code",null,{"children":"counter"}]," value is noisy, with many updates. We would still want only ",["$","code",null,{"children":"Layer3"}]," to be re-render on the counter change. Let's adapt our example. Now, the name of each layer is inside the context. Each layer renders the value from the context into its header tag."]}],"\n",["$","p",null,{"children":["For example, ",["$","code",null,{"children":"Layer1"}]," looks like this:"]}],"\n",["$","pre",null,{"className":"language-tsx","children":["$","code",null,{"className":"language-tsx code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token keyword","children":"export"}]," ",["$","span",null,{"className":"token keyword","children":"const"}]," ",["$","span",null,{"className":"token function-variable function","children":"Layer1"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token arrow operator","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token console class-name","children":"console"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token method function property-access","children":"log"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"Render: Layer 1\""}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"const"}]," contextState ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token function","children":"useContext"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token maybe-class-name","children":"MyContextStateContext"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"return"}]," ",["$","span",null,{"className":"token punctuation","children":"("}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"div"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"      "}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"h1"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token punctuation","children":"{"}],"contextState",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"layer1Name"}],["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"h1"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"      "}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],["$","span",null,{"className":"token class-name","children":"Layer2"}]]}]," ",["$","span",null,{"className":"token punctuation","children":"/>"}]]}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"    "}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"div"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}]]}]}],"\n",["$","p",null,{"children":[["$","code",null,{"children":"Layer2"}]," is similar but connect to ",["$","code",null,{"children":"layer2Name"}]]}],"\n",["$","iframe",null,{"src":"https://codesandbox.io/embed/react-context-re-render-part2-wt6qys","style":{"width":"100%","height":"500px","border":0,"borderRadius":"4px","overflow":"hidden"},"title":"Code Sandbox","allow":"accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking","sandbox":"allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"}],"\n",["$","p",null,{"children":"If you run the code, the console output looks different now:"}],"\n",["$","pre",null,{"className":"language-json","children":["$","code",null,{"className":"language-json code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token number","children":"2"}],["$","span",null,{"className":"token operator","children":":"}]," Render",["$","span",null,{"className":"token operator","children":":"}]," Layer ",["$","span",null,{"className":"token number","children":"2"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token number","children":"2"}],["$","span",null,{"className":"token operator","children":":"}]," Render",["$","span",null,{"className":"token operator","children":":"}]," Layer ",["$","span",null,{"className":"token number","children":"3"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token number","children":"2"}],["$","span",null,{"className":"token operator","children":":"}]," Render",["$","span",null,{"className":"token operator","children":":"}]," Layer ",["$","span",null,{"className":"token number","children":"1"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token number","children":"2"}],["$","span",null,{"className":"token operator","children":":"}]," Render",["$","span",null,{"className":"token operator","children":":"}]," Layer ",["$","span",null,{"className":"token number","children":"2"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token number","children":"2"}],["$","span",null,{"className":"token operator","children":":"}]," Render",["$","span",null,{"className":"token operator","children":":"}]," Layer ",["$","span",null,{"className":"token number","children":"3"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":"...\n"}]]}]}],"\n",["$","p",null,{"children":["Two different things are wrong. First, we see that each component is rendered every second. Too many rendering is incorrect because only ",["$","code",null,{"children":"Layer3"}]," is updating every second with the counter value. Second, every render is performed twice (see the ",["$","code",null,{"children":"2"}]," at the beginning of each line)."]}],"\n",["$","h1",null,{"children":"Context Object Reference"}],"\n",["$","p",null,{"children":["The problem is that we are changing the ",["$","code",null,{"children":"value"}]," reference every second which includes the unchanged strings. It would be smart to return the same reference for the unchanged portion of the state. By having a different reference, React think the whole object change (with reason). Before modifying the context, you may think that because we are consuming the ",["$","strong",null,{"children":"whole"}]," context instead of only the string that React render the entire layer."]}],"\n",["$","p",null,{"children":"In a nutshell, changing:"}],"\n",["$","pre",null,{"className":"language-tsx","children":["$","code",null,{"className":"language-tsx code-highlight","children":["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token keyword","children":"const"}]," contextState ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token function","children":"useContext"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token maybe-class-name","children":"MyContextStateContext"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}]}]}],"\n",["$","p",null,{"children":"to:"}],"\n",["$","pre",null,{"className":"language-tsx","children":["$","code",null,{"className":"language-tsx code-highlight","children":["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token keyword","children":"const"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}]," layer1Name ",["$","span",null,{"className":"token punctuation","children":"}"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token function","children":"useContext"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token maybe-class-name","children":"MyContextStateContext"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}]}]}],"\n",["$","p",null,{"children":"does not fix the problem -- we are destructing a new object with a new reference."}],"\n",["$","h1",null,{"children":"Optimizing the Context: Breaking the Context Root State"}],"\n",["$","p",null,{"children":"A first instinct is to break the state into several objects, which can be memoized in memory. Then, if a part of the object does not change, it will continue to receive the same object -- same reference. Hence, if we have a new object with two paths: the titles and the dynamic data, the titles ones will not change and hence the Layer1 and Layer 2 should not be re-render."}],"\n",["$","pre",null,{"className":"language-tsx","children":["$","code",null,{"className":"language-tsx code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token keyword","children":"export"}]," ",["$","span",null,{"className":"token keyword","children":"const"}]," ",["$","span",null,{"className":"token maybe-class-name","children":"MyContextProvider"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token punctuation","children":"("}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  props",["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token maybe-class-name","children":"MyContextStateContextProviderProps"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token maybe-class-name","children":"ReactElement"}]," ",["$","span",null,{"className":"token arrow operator","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"const"}]," ",["$","span",null,{"className":"token punctuation","children":"["}],"counter",["$","span",null,{"className":"token punctuation","children":","}]," setCounter",["$","span",null,{"className":"token punctuation","children":"]"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token generic-function","children":[["$","span",null,{"className":"token function","children":"useState"}],["$","span",null,{"className":"token generic class-name","children":[["$","span",null,{"className":"token operator","children":"<"}],["$","span",null,{"className":"token builtin","children":"number"}],["$","span",null,{"className":"token operator","children":">"}]]}]]}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token number","children":"0"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"const"}]," ",["$","span",null,{"className":"token punctuation","children":"["}],"layer1",["$","span",null,{"className":"token punctuation","children":","}]," setLayer1",["$","span",null,{"className":"token punctuation","children":"]"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token generic-function","children":[["$","span",null,{"className":"token function","children":"useState"}],["$","span",null,{"className":"token generic class-name","children":[["$","span",null,{"className":"token operator","children":"<"}],["$","span",null,{"className":"token builtin","children":"string"}],["$","span",null,{"className":"token operator","children":">"}]]}]]}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"Layer1\""}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"const"}]," ",["$","span",null,{"className":"token punctuation","children":"["}],"layer2",["$","span",null,{"className":"token punctuation","children":","}]," setLayer2",["$","span",null,{"className":"token punctuation","children":"]"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token generic-function","children":[["$","span",null,{"className":"token function","children":"useState"}],["$","span",null,{"className":"token generic class-name","children":[["$","span",null,{"className":"token operator","children":"<"}],["$","span",null,{"className":"token builtin","children":"string"}],["$","span",null,{"className":"token operator","children":">"}]]}]]}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"Layer2\""}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"const"}]," dynamicMemo ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token function","children":"useMemo"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token arrow operator","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token keyword","children":"return"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}]," counter",["$","span",null,{"className":"token operator","children":":"}]," counter ",["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token punctuation","children":"["}],"counter",["$","span",null,{"className":"token punctuation","children":"]"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"const"}]," titlesMemo ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token function","children":"useMemo"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token arrow operator","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token keyword","children":"return"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}]," layer1Name",["$","span",null,{"className":"token operator","children":":"}]," layer1",["$","span",null,{"className":"token punctuation","children":","}]," layer2Name",["$","span",null,{"className":"token operator","children":":"}]," layer2 ",["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token punctuation","children":"["}],"layer1",["$","span",null,{"className":"token punctuation","children":","}]," layer2",["$","span",null,{"className":"token punctuation","children":"]"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"const"}]," dataMemo ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token function","children":"useMemo"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token arrow operator","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token keyword","children":"return"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["      dynamic",["$","span",null,{"className":"token operator","children":":"}]," dynamicMemo",["$","span",null,{"className":"token punctuation","children":","}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["      titles",["$","span",null,{"className":"token operator","children":":"}]," titlesMemo",["$","span",null,{"className":"token punctuation","children":","}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token punctuation","children":"["}],"dynamicMemo",["$","span",null,{"className":"token punctuation","children":","}]," titlesMemo",["$","span",null,{"className":"token punctuation","children":"]"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token function","children":"useInterval"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token arrow operator","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token function","children":"setCounter"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":"("}],"d",["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token arrow operator","children":"=>"}]," d ",["$","span",null,{"className":"token operator","children":"+"}]," ",["$","span",null,{"className":"token number","children":"1"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"1000"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"return"}]," ",["$","span",null,{"className":"token punctuation","children":"("}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],["$","span",null,{"className":"token class-name","children":"MyContextStateContext.Provider"}]]}]," ",["$","span",null,{"className":"token attr-name","children":"value"}],["$","span",null,{"className":"token script language-javascript","children":[["$","span",null,{"className":"token script-punctuation punctuation","children":"="}],["$","span",null,{"className":"token punctuation","children":"{"}],"dataMemo",["$","span",null,{"className":"token punctuation","children":"}"}]]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"      "}],["$","span",null,{"className":"token punctuation","children":"{"}],"props",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"children"}],["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"    "}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],["$","span",null,{"className":"token class-name","children":"MyContextStateContext.Provider"}]]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}]]}]}],"\n",["$","p",null,{"children":["The change is sound but the output remains the same. The reason is that the top ",["$","code",null,{"children":"dataMemo"}]," reference changes every time one of the children changes. That is the case of the property ",["$","code",null,{"children":"dynamic"}],"."]}],"\n",["$","iframe",null,{"src":"https://codesandbox.io/embed/react-context-re-render-part3-1vu9k0","style":{"width":"100%","height":"500px","border":0,"borderRadius":"4px","overflow":"hidden"},"title":"Code Sandbox","allow":"accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking","sandbox":"allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"}],"\n",["$","h1",null,{"children":"Optimizing the Consumer: React Hook"}],"\n",["$","p",null,{"children":["An idea might be to isolate the portion of the state into a hook. Then, the hook could have memorization of the interested part. For example, a ",["$","code",null,{"children":"useTitles"}]," could track the reference of the ",["$","code",null,{"children":"titles"}]," branch of the state. Because the object reference of titles does not change in our example, the reference remains the same, meaning the hook returns a unique reference."]}],"\n",["$","pre",null,{"className":"language-tsx","children":["$","code",null,{"className":"language-tsx code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token keyword","children":"export"}]," ",["$","span",null,{"className":"token keyword","children":"const"}]," ",["$","span",null,{"className":"token function-variable function","children":"useTitles"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token arrow operator","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token console class-name","children":"console"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token method function property-access","children":"log"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"Render: useTitles hook\""}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"const"}]," fullState ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token function","children":"useContext"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token maybe-class-name","children":"MyContextStateContext"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":"\r\n"}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"const"}]," titlesMemo ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token function","children":"useMemo"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token arrow operator","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token console class-name","children":"console"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token method function property-access","children":"log"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"useTitles hook reevaluate memo for titles\""}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token keyword","children":"return"}]," fullState",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"titles"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token punctuation","children":"["}],"fullState",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"titles"}],["$","span",null,{"className":"token punctuation","children":"]"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"return"}]," titlesMemo",["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}]]}]}],"\n",["$","p",null,{"children":["Changing ",["$","code",null,{"children":"Layer1"}]," and ",["$","code",null,{"children":"Layer2"}]," to use the hook looks like the following:"]}],"\n",["$","pre",null,{"className":"language-tsx","children":["$","code",null,{"className":"language-tsx code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token keyword","children":"export"}]," ",["$","span",null,{"className":"token keyword","children":"const"}]," ",["$","span",null,{"className":"token function-variable function","children":"Layer2"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token arrow operator","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token console class-name","children":"console"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token method function property-access","children":"log"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"Render: Layer 2\""}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"const"}]," titles ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token function","children":"useTitles"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"return"}]," ",["$","span",null,{"className":"token punctuation","children":"("}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"div"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"      "}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"h2"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token punctuation","children":"{"}],"titles",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"layer2Name"}],["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"h2"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"      "}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],["$","span",null,{"className":"token class-name","children":"Layer3"}]]}]," ",["$","span",null,{"className":"token punctuation","children":"/>"}]]}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"    "}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"div"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}]]}]}],"\n",["$","p",null,{"children":["However, running the code does produce little change. The code still has re-rendering for ",["$","code",null,{"children":"App"}],", ",["$","code",null,{"children":"Layer1"}],", ",["$","code",null,{"children":"Layer2"}]," and ",["$","code",null,{"children":"Layer3"}],". The positive is that the ",["$","code",null,{"children":"console.log"}]," into the memo ran once, meaning the reference to the object within the hook remains the same."]}],"\n",["$","iframe",null,{"src":"https://codesandbox.io/embed/react-context-re-render-part4-eb9b1h","style":{"width":"100%","height":"500px","border":0,"borderRadius":"4px","overflow":"hidden"},"title":"Code Sandbox","allow":"accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking","sandbox":"allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"}],"\n",["$","p",null,{"children":"The output:"}],"\n",["$","pre",null,{"className":"language-json","children":["$","code",null,{"className":"language-json code-highlight","children":[["$","span",null,{"className":"code-line","children":["Render",["$","span",null,{"className":"token operator","children":":"}]," Layer ",["$","span",null,{"className":"token number","children":"1"}]," \r\n"]}],["$","span",null,{"className":"code-line","children":["Render",["$","span",null,{"className":"token operator","children":":"}]," useTitles hook \r\n"]}],["$","span",null,{"className":"code-line","children":["Render",["$","span",null,{"className":"token operator","children":":"}]," Layer ",["$","span",null,{"className":"token number","children":"1"}]," \r\n"]}],["$","span",null,{"className":"code-line","children":["Render",["$","span",null,{"className":"token operator","children":":"}]," useTitles hook \r\n"]}],["$","span",null,{"className":"code-line","children":["Render",["$","span",null,{"className":"token operator","children":":"}]," Layer ",["$","span",null,{"className":"token number","children":"2"}]," \r\n"]}],["$","span",null,{"className":"code-line","children":["Render",["$","span",null,{"className":"token operator","children":":"}]," useTitles hook \r\n"]}],["$","span",null,{"className":"code-line","children":["Render",["$","span",null,{"className":"token operator","children":":"}]," Layer ",["$","span",null,{"className":"token number","children":"2"}]," \r\n"]}],["$","span",null,{"className":"code-line","children":["Render",["$","span",null,{"className":"token operator","children":":"}]," useTitles hook \r\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token number","children":"2"}]," Render",["$","span",null,{"className":"token operator","children":":"}]," Layer ",["$","span",null,{"className":"token number","children":"3"}]," \n"]}]]}]}],"\n",["$","h1",null,{"children":"Optimizing using React.memo"}],"\n",["$","p",null,{"children":["A quick search online shows some obscure messages from Twitter from 2020 about always using ",["$","a",null,{"href":"https://reactjs.org/docs/react-api.html#reactmemo","children":"React.memo"}]," when using ",["$","code",null,{"children":"context"}]," to avoid the exact scenario we are into: re-redering component that does not change."]}],"\n",["$","iframe",null,{"src":"https://codesandbox.io/embed/react-context-re-render-part5-ecmuch","style":{"width":"100%","height":"500px","border":0,"borderRadius":"4px","overflow":"hidden"},"title":"Code Sandbox","allow":"accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking","sandbox":"allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"}],"\n",["$","p",null,{"children":["However, in our example, using ",["$","code",null,{"children":"React.memo"}]," to the direct descendant of the context and all the child components (",["$","code",null,{"children":"Layer1"}]," and ",["$","code",null,{"children":"Layer2"}],") continues to produce rendering."]}],"\n",["$","h1",null,{"children":"Optimizing the Components"}],"\n",["$","p",null,{"children":["The problem remains that the ",["$","code",null,{"children":"Layer1"}]," is using the content of the context. The documentation on ",["$","a",null,{"href":"https://reactjs.org/docs/react-api.html#reactmemo","children":"React.memo"}]," specifies that is memoize the component but still re-render if a ",["$","code",null,{"children":"useState"}]," or ",["$","code",null,{"children":"useContext"}],", which does indirectly with the ",["$","code",null,{"children":"useTitles"}],". There is a deep ",["$","a",null,{"href":"https://github.com/facebook/react/issues/15156#issuecomment-474590693","children":"Git thread"}]," about ",["$","code",null,{"children":"useContext"}]," and performance. The first tip is to break the context into several contexts. It makes sense until you get into so many contexts."]}],"\n",["$","p",null,{"children":["The second recommendation is to split your components. In our example, the context is used for the title only. Creating a ",["$","code",null,{"children":"Title"}]," component that pass by property the name would ensure with ",["$","code",null,{"children":"React.memo"}]," that this component only changes when the value of the title change."]}],"\n",["$","pre",null,{"className":"language-tsx","children":["$","code",null,{"className":"language-tsx code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token keyword","children":"export"}]," ",["$","span",null,{"className":"token keyword","children":"interface"}]," ",["$","span",null,{"className":"token class-name","children":"TitleProps"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  title",["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token builtin","children":"string"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"}"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token keyword","children":"export"}]," ",["$","span",null,{"className":"token keyword","children":"const"}]," ",["$","span",null,{"className":"token maybe-class-name","children":"Title"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token maybe-class-name","children":"React"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token method function property-access","children":"memo"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":"("}],"props",["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token maybe-class-name","children":"TitleProps"}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token arrow operator","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token console class-name","children":"console"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token method function property-access","children":"log"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"Rendering Title in Layer1\""}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"return"}]," ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"h1"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token punctuation","children":"{"}],"props",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"title"}],["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"h1"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}]]}]}],"\n",["$","p",null,{"children":["And ",["$","code",null,{"children":"Layer1"}],":"]}],"\n",["$","pre",null,{"className":"language-tsx","children":["$","code",null,{"className":"language-tsx code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token keyword","children":"export"}]," ",["$","span",null,{"className":"token keyword","children":"const"}]," ",["$","span",null,{"className":"token maybe-class-name","children":"Layer1"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token maybe-class-name","children":"React"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token method function property-access","children":"memo"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token arrow operator","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token console class-name","children":"console"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token method function property-access","children":"log"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"Render: Layer 1\""}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"const"}]," titles ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token function","children":"useTitles"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token keyword","children":"return"}]," ",["$","span",null,{"className":"token punctuation","children":"("}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"div"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"      "}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],["$","span",null,{"className":"token class-name","children":"Title"}]]}]," ",["$","span",null,{"className":"token attr-name","children":"title"}],["$","span",null,{"className":"token script language-javascript","children":[["$","span",null,{"className":"token script-punctuation punctuation","children":"="}],["$","span",null,{"className":"token punctuation","children":"{"}],"titles",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"layer1Name"}],["$","span",null,{"className":"token punctuation","children":"}"}]]}]," ",["$","span",null,{"className":"token punctuation","children":"/>"}]]}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"      "}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],["$","span",null,{"className":"token class-name","children":"Layer2"}]]}]," ",["$","span",null,{"className":"token punctuation","children":"/>"}]]}],["$","span",null,{"className":"token plain-text","children":"\r\n"}]]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token plain-text","children":"    "}],["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"div"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\r\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\r\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}]]}]}],"\n",["$","p",null,{"children":["The ",["$","code",null,{"children":"Layer1"}]," component continues to be re-rendered, but not the ",["$","code",null,{"children":"Title"}]," portion. ",["$","code",null,{"children":"Title2"}]," continues to be re-rendered, too, because it relies on the hook (which depends on ",["$","code",null,{"children":"useContext"}],"). But, ",["$","code",null,{"children":"Title2"}]," also does not re-render the title portion because it uses the memoized ",["$","code",null,{"children":"Title"}]," component."]}],"\n",["$","h1",null,{"children":"Step Back and Understand"}],"\n",["$","p",null,{"children":["I see few articles and even fewer patterns in the official documentation to handle context efficiently in React. I see even fewer articles that clearly state that once you touch ",["$","code",null,{"children":"useContext"}]," that even if you isolate as much as possible and memoize as much as you can that you will see have a re-render. In this article, you were able to see that there is a limitation on how much you can isolate yourself from re-render."]}],"\n",["$","p",null,{"children":"A word of caution. Suppose you have data that barely change but has a different timestamp (for example, a modified date), if you are receiving an object that has only the time adjusting that it might always be a different object. Hence, maybe changing a lot your state within your context. If you are using data coming from real-time sources (via web socket) you may also be surprised that the context is continually changing and causing side-effects of more rendering than anticipated."}],"\n",["$","p",null,{"children":"Using the React Dev Tool, you will see that in our example the Layer1 to Layer 3 are always re-render. Using the Chrome tool that highlights what is painted on the browser, you will see the same that the Layer1 to Layer3 title's string are re-painted. Hence, a lot of performance cost."}],"\n",["$","p",null,{"children":["So, it using context a bad idea to keep global state in your application? Well, if you read some discussion from an alternative state management solution like Redux, it might be! There is a ",["$","a",null,{"href":"https://github.com/facebook/react/issues/13739","children":"Git thread"}]," about React-Redux version 6 that tried to rely on ",["$","code",null,{"children":"createContext"}],". It was \"a big deal\" affecting the performance; however ",["$","a",null,{"href":"https://github.com/reduxjs/react-redux/issues/1177","children":"they moved forward and used it"}],". It has been ",["$","a",null,{"href":"https://github.com/facebook/react/issues/14110","children":"acknowledged since 2018"}]," that hooks that rely on ",["$","code",null,{"children":"useState"}]," and ",["$","code",null,{"children":"useContext"}]," has limited (if not no way) to optimize the re-rendering. ",["$","a",null,{"href":"https://github.com/reactwg/react-18/discussions/73","children":"Facebook is not actively"}]," working on a ",["$","em",null,{"children":"selector"}]," approach which would allow being updated only from a subset of the context. To put in perspective, React-Redux while moving to rely on ",["$","code",null,{"children":"useContext"}]," from version 5 to 6 ",["$","a",null,{"href":"https://github.com/reduxjs/react-redux/releases/tag/v7.0.1","children":"moved out of it in version 7"}]," with the reason that ",["$","em",null,{"children":"\"unfortunately the Context API isn't as optimized for frequent updates\""}],"."]}],"\n",["$","h1",null,{"children":"Conclusion"}],"\n",["$","p",null,{"children":"Using the context to keep a large amount of changing information is not ideal. However, it does work out well until you reach a point when it does not. Until then, the React context may seem like a potential quick solution that does not rely on other third parties. However, you may need to migrate in the future."}],"\n",["$","p",null,{"children":["I used Redux in 2018, and it was fine. However, at that time, several custom TypeScript utility types were needed. In 2023, Redux is now at version 8, and ",["$","a",null,{"href":"https://react-redux.js.org/tutorials/typescript-quick-start","children":"Redux is well supported with TypeScript"}],". Furthermore, the heavy boilerplate needed is abstracted -- no more need for middleware and Thunk. Hence, it might be a candidate migration road once you hit performance issues."]}],"\n",["$","h1",null,{"children":"CodeSandbox Links"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["$","a",null,{"href":"https://codesandbox.io/s/react-context-re-render-part1-wqpp64","children":"Part 1: Simple React Context Example"}]}],"\n",["$","li",null,{"children":["$","a",null,{"href":"https://codesandbox.io/s/react-context-re-render-part2-wt6qys","children":"Part 2: Context with Many Values Example"}]}],"\n",["$","li",null,{"children":["$","a",null,{"href":"https://codesandbox.io/s/react-context-re-render-part3-1vu9k0","children":"Part 3: Optimizing the Context Example Memoization of Properties"}]}],"\n",["$","li",null,{"children":["$","a",null,{"href":"https://codesandbox.io/s/react-context-re-render-part4-eb9b1h","children":"Part 4: Optimizing the Context Example Hook"}]}],"\n",["$","li",null,{"children":["$","a",null,{"href":"https://codesandbox.io/s/react-context-re-render-part5-ecmuch","children":"Part 5: Optimizing with React.memo"}]}],"\n",["$","li",null,{"children":["$","a",null,{"href":"https://codesandbox.io/s/react-context-re-render-part6-g6mhyl","children":"Part 6: Optimizing by Breaking into Several Components"}]}],"\n"]}]]]}]]}],["$","div",null,{"className":"BlogBody_paginationBar__1gsMc","children":[["$","div",null,{"className":"BlogBody_paginationTitle__H_eFX","children":"Chronological Blog Articles by Page"}],["$","div",null,{"className":"BlogBody_paginationLinks__nk8zd","children":[["$","$L6","1",{"className":"","href":"/blog/page/1","children":1}],["$","$L6","2",{"className":"","href":"/blog/page/2","children":2}],["$","$L6","3",{"className":"","href":"/blog/page/3","children":3}],["$","$L6","4",{"className":"","href":"/blog/page/4","children":4}],["$","$L6","5",{"className":"","href":"/blog/page/5","children":5}],["$","$L6","6",{"className":"","href":"/blog/page/6","children":6}],["$","$L6","7",{"className":"","href":"/blog/page/7","children":7}],["$","$L6","8",{"className":"","href":"/blog/page/8","children":8}],["$","$L6","9",{"className":"","href":"/blog/page/9","children":9}],["$","$L6","10",{"className":"","href":"/blog/page/10","children":10}],["$","$L6","11",{"className":"","href":"/blog/page/11","children":11}],["$","$L6","12",{"className":"","href":"/blog/page/12","children":12}],["$","$L6","13",{"className":"","href":"/blog/page/13","children":13}],["$","$L6","14",{"className":"","href":"/blog/page/14","children":14}],["$","$L6","15",{"className":"","href":"/blog/page/15","children":15}],["$","$L6","16",{"className":"","href":"/blog/page/16","children":16}],["$","$L6","17",{"className":"","href":"/blog/page/17","children":17}],["$","$L6","18",{"className":"","href":"/blog/page/18","children":18}],["$","$L6","19",{"className":"","href":"/blog/page/19","children":19}],["$","$L6","20",{"className":"","href":"/blog/page/20","children":20}],["$","$L6","21",{"className":"","href":"/blog/page/21","children":21}],["$","$L6","22",{"className":"","href":"/blog/page/22","children":22}],["$","$L6","23",{"className":"","href":"/blog/page/23","children":23}],["$","$L6","24",{"className":"","href":"/blog/page/24","children":24}],["$","$L6","25",{"className":"","href":"/blog/page/25","children":25}],["$","$L6","26",{"className":"","href":"/blog/page/26","children":26}],["$","$L6","27",{"className":"","href":"/blog/page/27","children":27}],["$","$L6","28",{"className":"","href":"/blog/page/28","children":28}],["$","$L6","29",{"className":"","href":"/blog/page/29","children":29}],["$","$L6","30",{"className":"","href":"/blog/page/30","children":30}],["$","$L6","31",{"className":"","href":"/blog/page/31","children":31}],["$","$L6","32",{"className":"","href":"/blog/page/32","children":32}],["$","$L6","33",{"className":"","href":"/blog/page/33","children":33}],["$","$L6","34",{"className":"","href":"/blog/page/34","children":34}],["$","$L6","35",{"className":"","href":"/blog/page/35","children":35}],["$","$L6","36",{"className":"","href":"/blog/page/36","children":36}],["$","$L6","37",{"className":"","href":"/blog/page/37","children":37}],["$","$L6","38",{"className":"","href":"/blog/page/38","children":38}],["$","$L6","39",{"className":"","href":"/blog/page/39","children":39}],["$","$L6","40",{"className":"","href":"/blog/page/40","children":40}],["$","$L6","41",{"className":"","href":"/blog/page/41","children":41}],["$","$L6","42",{"className":"","href":"/blog/page/42","children":42}],["$","$L6","43",{"className":"","href":"/blog/page/43","children":43}],["$","$L6","44",{"className":"","href":"/blog/page/44","children":44}],["$","$L6","45",{"className":"","href":"/blog/page/45","children":45}],["$","$L6","46",{"className":"","href":"/blog/page/46","children":46}],["$","$L6","47",{"className":"","href":"/blog/page/47","children":47}],["$","$L6","48",{"className":"","href":"/blog/page/48","children":48}],["$","$L6","49",{"className":"","href":"/blog/page/49","children":49}],["$","$L6","50",{"className":"","href":"/blog/page/50","children":50}],["$","$L6","51",{"className":"","href":"/blog/page/51","children":51}],["$","$L6","52",{"className":"","href":"/blog/page/52","children":52}],["$","$L6","53",{"className":"","href":"/blog/page/53","children":53}],["$","$L6","54",{"className":"","href":"/blog/page/54","children":54}],["$","$L6","55",{"className":"","href":"/blog/page/55","children":55}],["$","$L6","56",{"className":"","href":"/blog/page/56","children":56}],["$","$L6","57",{"className":"","href":"/blog/page/57","children":57}],["$","$L6","58",{"className":"","href":"/blog/page/58","children":58}],["$","$L6","59",{"className":"","href":"/blog/page/59","children":59}],["$","$L6","60",{"className":"","href":"/blog/page/60","children":60}],["$","$L6","61",{"className":"","href":"/blog/page/61","children":61}],["$","$L6","62",{"className":"","href":"/blog/page/62","children":62}],["$","$L6","63",{"className":"","href":"/blog/page/63","children":63}],["$","$L6","64",{"className":"","href":"/blog/page/64","children":64}],["$","$L6","65",{"className":"","href":"/blog/page/65","children":65}],["$","$L6","66",{"className":"","href":"/blog/page/66","children":66}],["$","$L6","67",{"className":"","href":"/blog/page/67","children":67}],["$","$L6","68",{"className":"","href":"/blog/page/68","children":68}],["$","$L6","69",{"className":"","href":"/blog/page/69","children":69}],["$","$L6","70",{"className":"","href":"/blog/page/70","children":70}],["$","$L6","71",{"className":"","href":"/blog/page/71","children":71}],["$","$L6","72",{"className":"","href":"/blog/page/72","children":72}],["$","$L6","73",{"className":"","href":"/blog/page/73","children":73}],["$","$L6","74",{"className":"","href":"/blog/page/74","children":74}],["$","$L6","75",{"className":"","href":"/blog/page/75","children":75}],["$","$L6","76",{"className":"","href":"/blog/page/76","children":76}],["$","$L6","77",{"className":"","href":"/blog/page/77","children":77}],["$","$L6","78",{"className":"","href":"/blog/page/78","children":78}],["$","$L6","79",{"className":"","href":"/blog/page/79","children":79}],["$","$L6","80",{"className":"","href":"/blog/page/80","children":80}],["$","$L6","81",{"className":"","href":"/blog/page/81","children":81}]]}]]}],null]}]
7:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"Patrick Desjardins Blog - React Context and How to Avoid repetitive re-rendering"}],["$","meta","3",{"name":"description","content":"React Context and How to Avoid repetitive re-rendering"}]]
1:null

<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="/images/blog/updateDataSetRowsFromDataTable-400x100.png"/><link rel="preload" as="image" href="/images/blog/createInsertStatementWithCommandBuilder-400x73.png"/><link rel="stylesheet" href="/_next/static/css/4f3d065c9e2d01e0.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/8ea1dcbe6e4b9929.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-c94468cbefcc94b8.js" crossorigin=""/><script src="/_next/static/chunks/fd9d1056-cc48c28d170fddc2.js" async="" crossorigin=""></script><script src="/_next/static/chunks/69-c7efea4b65083e7f.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-f550f103b66f998a.js" async="" crossorigin=""></script><script src="/_next/static/chunks/250-d7e0a94ebe194dac.js" async=""></script><script src="/_next/static/chunks/79-2d03397107aae3f1.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-6ef1cad01f05dc10.js" async=""></script><title>Patrick Desjardins Blog - DataReader and DataAdapters to read from the database</title><meta name="description" content="DataReader and DataAdapters to read from the database"/><meta name="next-size-adjust"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body class="layout_bodystyle__4ncsS"><div class="__className_aaf875"><div class="layout_container__Tovb9"><header class="layout_siteTitle__k5U8g">Patrick Desjardins Blog</header><nav><ul class="layout_navLinks__mf70r"><li class="layout_navLinkItem__1L8fB"><a class="layout_navLinkText__bt28R" href="/">Main Page</a><a class="layout_navLinkText__bt28R" href="/blog">Blog</a><a class="layout_navLinkText__bt28R" href="/blog/for/2024">2024</a><a class="layout_navLinkText__bt28R" href="/blog/for/2023">2023</a><a class="layout_navLinkText__bt28R" href="/blog/for/2022">2022</a><a class="layout_navLinkText__bt28R" href="/blog/for/2021">2021</a><a class="layout_navLinkText__bt28R" href="/blog/for/2020">2020</a><a class="layout_navLinkText__bt28R" href="/blog/for/2019">2019</a><a class="layout_navLinkText__bt28R" href="/blog/for/2018">2018</a><a class="layout_navLinkText__bt28R" href="/blog/for/2017">2017</a><a class="layout_navLinkText__bt28R" href="/blog/for/2016">2016</a><a class="layout_navLinkText__bt28R" href="/blog/for/2015">2015</a><a class="layout_navLinkText__bt28R" href="/blog/for/2014">2014</a><a class="layout_navLinkText__bt28R" href="/blog/for/2013">2013</a><a class="layout_navLinkText__bt28R" href="/blog/for/2012">2012</a><a class="layout_navLinkText__bt28R" href="/blog/for/2011">2011</a></li></ul></nav><div class="layout_blogPictureContainer__XC7nK"><img alt="Patrick Desjardins picture from a conference" loading="lazy" width="800" height="260" decoding="async" data-nimg="1" class="layout_blogTopPicture__RJHNN" style="color:transparent" src="/images/backgrounds/patrickdesjardins_conference_bw.jpeg"/></div><main class="layout_main__mXTwS"><h1>DataReader and DataAdapters to read from the database</h1><div class="layout_blogPostContainer__WYELx"><p class="layout_blogPostDate__LUvx5">Posted on: <!-- -->2011-09-29</p><p>To read data from the database you need to use something else from <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DbCommand</span></span></code></span> that was returning no data. Two options are available. The first one is the DataReader, the second is the DataAdapters.</p>
<h2>DataReader</h2>
<p>This is the fastest way to read data from the database. To create a <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DataReader</span></span></code></span> object, the use of <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>ExecuteReader</span></span></code></span> from the <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DbCommand</span></span></code></span> class is required. It&#x27;s required because you will still need to give them the type of query you want and the SQL statement (or the stored procedure name). Then, the method <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>ExecuteReader()</span></span></code></span> return a <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DataReader</span></span></code></span>. In the example below, the reader is a <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>SqlDataReader</span></span></code></span>. This one derive from <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DataReader</span></span></code></span> and is more specialized for Microsoft Sql Server. The latest solution is really not performant.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="csharp" data-theme="github-dark-dimmed"><code data-language="csharp" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#F69D50">ConnectionStringSettings</span><span style="color:#F69D50"> connectionStringSettings</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> ConfigurationManager.ConnectionStrings[</span><span style="color:#96D0FF">&quot;ApplicationServices&quot;</span><span style="color:#ADBAC7">]; </span></span>
<span data-line=""><span style="color:#F47067">using</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">var</span><span style="color:#F69D50"> connection</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> SqlConnection</span><span style="color:#ADBAC7">(connectionStringSettings.ConnectionString)) { </span></span>
<span data-line=""><span style="color:#ADBAC7">  connection.</span><span style="color:#DCBDFB">Open</span><span style="color:#ADBAC7">(); </span></span>
<span data-line=""><span style="color:#F47067">  using</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">var</span><span style="color:#F69D50"> command</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> SqlCommand</span><span style="color:#ADBAC7">()) { </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.Connection </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> connection; </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.CommandText </span><span style="color:#F47067">=</span><span style="color:#96D0FF"> &quot;SELECT CustomerID, CompanyName FROM Customers WHERE country LIKE &#x27;canada&#x27; &quot;</span><span style="color:#ADBAC7">; </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.CommandType </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> System.Data.CommandType.Text; </span></span>
<span data-line=""><span style="color:#F47067">    using</span><span style="color:#ADBAC7"> (</span><span style="color:#F69D50">SqlDataReader</span><span style="color:#F69D50"> reader</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> command.</span><span style="color:#DCBDFB">ExecuteReader</span><span style="color:#ADBAC7">()) { </span></span>
<span data-line=""><span style="color:#F47067">      while</span><span style="color:#ADBAC7"> (reader.</span><span style="color:#DCBDFB">Read</span><span style="color:#ADBAC7">()) { </span></span>
<span data-line=""><span style="color:#ADBAC7">        System.Diagnostics.Debug.</span><span style="color:#DCBDFB">WriteLine</span><span style="color:#ADBAC7">(</span><span style="color:#F47067">string</span><span style="color:#ADBAC7">.</span><span style="color:#DCBDFB">Format</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;{0}:{1}&quot;</span><span style="color:#ADBAC7">,reader[</span><span style="color:#96D0FF">&quot;CustomerID&quot;</span><span style="color:#ADBAC7">], reader[</span><span style="color:#96D0FF">&quot;CompanyName&quot;</span><span style="color:#ADBAC7">])); </span></span>
<span data-line=""><span style="color:#ADBAC7">      } </span></span>
<span data-line=""><span style="color:#ADBAC7">    } </span></span>
<span data-line=""><span style="color:#ADBAC7">  } </span></span>
<span data-line=""><span style="color:#ADBAC7">  connection.</span><span style="color:#DCBDFB">Close</span><span style="color:#ADBAC7">(); </span></span>
<span data-line=""><span style="color:#ADBAC7">} </span></span></code></pre></figure>
<p>The <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DataReader</span></span></code></span> acts like a cursor. It can only go forward. You can access the value of each row by using the square braquet <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>[]</span></span></code></span>. You can put the name of the field or a integer that represent the index of the position of the field. For example, we could have replace:</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="csharp" data-theme="github-dark-dimmed"><code data-language="csharp" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#ADBAC7"> System.Diagnostics.Debug.</span><span style="color:#DCBDFB">WriteLine</span><span style="color:#ADBAC7">(</span><span style="color:#F47067">string</span><span style="color:#ADBAC7">.</span><span style="color:#DCBDFB">Format</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;{0}:{1}&quot;</span><span style="color:#ADBAC7">,reader[</span><span style="color:#96D0FF">&quot;CustomerID&quot;</span><span style="color:#ADBAC7">], reader[</span><span style="color:#96D0FF">&quot;CompanyName&quot;</span><span style="color:#ADBAC7">])); </span></span></code></pre></figure>
<p>by</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="csharp" data-theme="github-dark-dimmed"><code data-language="csharp" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#ADBAC7"> System.Diagnostics.Debug.</span><span style="color:#DCBDFB">WriteLine</span><span style="color:#ADBAC7">(</span><span style="color:#F47067">string</span><span style="color:#ADBAC7">.</span><span style="color:#DCBDFB">Format</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;{0}:{1}&quot;</span><span style="color:#ADBAC7">,reader[</span><span style="color:#6CB6FF">0</span><span style="color:#ADBAC7">], reader[</span><span style="color:#6CB6FF">1</span><span style="color:#ADBAC7">])); </span></span></code></pre></figure>
<p>The problem with the latest version is the maintainability. It&#x27;s harder to know what will be displayed. Also, it can be problematic if the order of the returned data change. Let say that you get data from a stored procedure and for an unknown reason the database administrator change the order of the returned field. This would create a problem but not if the name were used.</p>
<p>You can also load the whole data set in one shot using the Load method. The data is loaded into a DataTable.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="csharp" data-theme="github-dark-dimmed"><code data-language="csharp" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#F69D50">ConnectionStringSettings</span><span style="color:#F69D50"> connectionStringSettings</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> ConfigurationManager.ConnectionStrings[</span><span style="color:#96D0FF">&quot;ApplicationServices&quot;</span><span style="color:#ADBAC7">]; </span></span>
<span data-line=""><span style="color:#F69D50">DataTable</span><span style="color:#F69D50"> datas</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> DataTable</span><span style="color:#ADBAC7">();</span></span>
<span data-line=""><span style="color:#F47067"> using</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">var</span><span style="color:#F69D50"> connection</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> SqlConnection</span><span style="color:#ADBAC7">(connectionStringSettings.ConnectionString)) { </span></span>
<span data-line=""><span style="color:#ADBAC7">  connection.</span><span style="color:#DCBDFB">Open</span><span style="color:#ADBAC7">(); </span></span>
<span data-line=""><span style="color:#F47067">  using</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">var</span><span style="color:#F69D50"> command</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> SqlCommand</span><span style="color:#ADBAC7">()) { </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.Connection </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> connection; </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.CommandText </span><span style="color:#F47067">=</span><span style="color:#96D0FF"> &quot;SELECT CustomerID, CompanyName FROM Customers WHERE country LIKE &#x27;canada&#x27; &quot;</span><span style="color:#ADBAC7">; </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.CommandType </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> System.Data.CommandType.Text; </span></span>
<span data-line=""><span style="color:#F47067">    using</span><span style="color:#ADBAC7"> (</span><span style="color:#F69D50">SqlDataReader</span><span style="color:#F69D50"> reader</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> command.</span><span style="color:#DCBDFB">ExecuteReader</span><span style="color:#ADBAC7">()) { </span></span>
<span data-line=""><span style="color:#ADBAC7">      datas.</span><span style="color:#DCBDFB">Load</span><span style="color:#ADBAC7">(reader, LoadOption.Upsert); </span></span>
<span data-line=""><span style="color:#ADBAC7">    } </span></span>
<span data-line=""><span style="color:#ADBAC7">  } </span></span>
<span data-line=""><span style="color:#ADBAC7">  connection.</span><span style="color:#DCBDFB">Close</span><span style="color:#ADBAC7">(); </span></span>
<span data-line=""><span style="color:#ADBAC7">  System.Diagnostics.Debug.</span><span style="color:#DCBDFB">WriteLine</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;Number of rows loaded : &quot;</span><span style="color:#F47067"> +</span><span style="color:#ADBAC7"> datas.Rows.Count); </span></span>
<span data-line=""><span style="color:#ADBAC7">} </span></span></code></pre></figure>
<p>One problem with DataReader is that it uses a cursor on the server and it keeps the connection to the server open while looping. The second problem is that while looping you won&#x27;t be able to execute an other query withing the loop. To solve that problem you can load all the data and loop after or use the Load method. Another option is to use a DbConnection with a special connection string. This connection string will require to have the attribute &quot;MultipleActiveResultSets=True&quot;. This let have multiple command but at the cost of performance issue. It has to be used with cautiousness.</p>
<h2>Scalar</h2>
<p>Sometime, we want to have just a single value. This can be an ID from a username, but more often it will be to get a value from an aggregate function, like a count. We could use the DataReader but this give some overhead for a single value.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="csharp" data-theme="github-dark-dimmed"><code data-language="csharp" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#F69D50">ConnectionStringSettings</span><span style="color:#F69D50"> connectionStringSettings</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> ConfigurationManager.ConnectionStrings[</span><span style="color:#96D0FF">&quot;ApplicationServices&quot;</span><span style="color:#ADBAC7">]; </span></span>
<span data-line=""><span style="color:#F47067">using</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">var</span><span style="color:#F69D50"> connection</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> SqlConnection</span><span style="color:#ADBAC7">(connectionStringSettings.ConnectionString)) { </span></span>
<span data-line=""><span style="color:#ADBAC7">  connection.</span><span style="color:#DCBDFB">Open</span><span style="color:#ADBAC7">(); </span></span>
<span data-line=""><span style="color:#F47067">  using</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">var</span><span style="color:#F69D50"> command</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> SqlCommand</span><span style="color:#ADBAC7">()) { </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.Connection </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> connection; </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.CommandText </span><span style="color:#F47067">=</span><span style="color:#96D0FF"> &quot;SELECT count(CustomerID) FROM Customers WHERE country LIKE &#x27;canada&#x27; &quot;</span><span style="color:#ADBAC7">; </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.CommandType </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> System.Data.CommandType.Text; </span></span>
<span data-line=""><span style="color:#F47067">    int</span><span style="color:#F69D50"> countValue</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">int</span><span style="color:#ADBAC7">)command.</span><span style="color:#DCBDFB">ExecuteScalar</span><span style="color:#ADBAC7">(); </span></span>
<span data-line=""><span style="color:#ADBAC7">    System.Diagnostics.Debug.</span><span style="color:#DCBDFB">WriteLine</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;Count value:&quot;</span><span style="color:#F47067"> +</span><span style="color:#ADBAC7"> countValue); </span></span>
<span data-line=""><span style="color:#ADBAC7">  } connection.</span><span style="color:#DCBDFB">Close</span><span style="color:#ADBAC7">();</span></span>
<span data-line=""><span style="color:#ADBAC7">} </span></span></code></pre></figure>
<p>As you can see, line 10 use the <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>ExecuteScalar</span></span></code></span> from the DbCommand to return an Object. In our case, we return an integer.</p>
<h2>DbDataAdapter</h2>
<p>The <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DbDataAdapter</span></span></code></span> is the reader that give you the more leverage in data functionality. Not only it let you get the data but it let you update them.</p>
<p>The DbDataAdapter class derive from <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DataAdapter</span></span></code></span>. As the other command, a Microsoft Sql Server one exist and it&#x27;s called: <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>SqlDataAdapter</span></span></code></span>.</p>
<p>The <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DbDataAdapter</span></span></code></span> contains a <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>SelectCommand</span></span></code></span> that use an <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>ExecuteReader</span></span></code></span>. Internally the data is loaded in a <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DataTable</span></span></code></span>. This let the developer change the value inside the <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DataTable</span></span></code></span> and if desired update them to the database or insert new rows added and also delete those who are not anymore in the <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DataTable</span></span></code></span>. The <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DbDataApter</span></span></code></span> is wise enough to open and close the connection. In the other end, it let the user open the connection if desired. In that case, the user will also need to close it. This can be useful when multiple calls is required because it won&#x27;t open-close repetitively which is costly in performance. Here is an example of how to load data from the database into a <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DbDataAdapter</span></span></code></span>.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="csharp" data-theme="github-dark-dimmed"><code data-language="csharp" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#F69D50"> ConnectionStringSettings</span><span style="color:#F69D50"> connectionStringSettings</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> ConfigurationManager.ConnectionStrings[</span><span style="color:#96D0FF">&quot;ApplicationServices&quot;</span><span style="color:#ADBAC7">]; </span></span>
<span data-line=""><span style="color:#F69D50"> DataSet</span><span style="color:#F69D50"> returnedValuesSet</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> DataSet</span><span style="color:#ADBAC7">(); </span></span>
<span data-line=""><span style="color:#F47067"> using</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">var</span><span style="color:#F69D50"> connection</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> SqlConnection</span><span style="color:#ADBAC7">(connectionStringSettings.ConnectionString)) { </span></span>
<span data-line=""><span style="color:#ADBAC7">  connection.</span><span style="color:#DCBDFB">Open</span><span style="color:#ADBAC7">(); </span></span>
<span data-line=""><span style="color:#F47067">  using</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">var</span><span style="color:#F69D50"> command</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> SqlCommand</span><span style="color:#ADBAC7">()) { </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.Connection </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> connection; </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.CommandText </span><span style="color:#F47067">=</span><span style="color:#96D0FF"> &quot;SELECT CustomerID, CompanyName FROM Customers WHERE country LIKE &#x27;canada&#x27; &quot;</span><span style="color:#ADBAC7">; </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.CommandType </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> System.Data.CommandType.Text; </span></span>
<span data-line=""><span style="color:#F47067">    using</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">var</span><span style="color:#F69D50"> dataAdapter</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> SqlDataAdapter</span><span style="color:#ADBAC7">(command)) { </span></span>
<span data-line=""><span style="color:#ADBAC7">      dataAdapter.</span><span style="color:#DCBDFB">Fill</span><span style="color:#ADBAC7">(returnedValuesSet); </span></span>
<span data-line=""><span style="color:#ADBAC7">    } </span></span>
<span data-line=""><span style="color:#ADBAC7">  } </span></span>
<span data-line=""><span style="color:#ADBAC7">  connection.</span><span style="color:#DCBDFB">Close</span><span style="color:#ADBAC7">(); </span></span>
<span data-line=""><span style="color:#ADBAC7">  System.Diagnostics.Debug.</span><span style="color:#DCBDFB">WriteLine</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;Number of rows loaded : &quot;</span><span style="color:#F47067"> +</span><span style="color:#ADBAC7"> returnedValuesSet.Tables[</span><span style="color:#6CB6FF">0</span><span style="color:#ADBAC7">].Rows.Count); </span></span>
<span data-line=""><span style="color:#ADBAC7">} </span></span></code></pre></figure>
<p>So, now the <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DataSet</span></span></code></span> is filled up with the query data. It&#x27;s a non-connected object but will still be able to do update later on. From this example, we can see that the SqlDataAdapter fill up with the <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>Fill</span></span></code></span> method. This <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>Fill</span></span></code></span> method can also takes a second argument that is the name of the name of the table. This mean we can modify the previous example with this one and instead of referring the data in the <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DataSet</span></span></code></span> with an index, we will be able to use the string as a key.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="csharp" data-theme="github-dark-dimmed"><code data-language="csharp" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#F69D50">ConnectionStringSettings</span><span style="color:#F69D50"> connectionStringSettings</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> ConfigurationManager.ConnectionStrings[</span><span style="color:#96D0FF">&quot;ApplicationServices&quot;</span><span style="color:#ADBAC7">]; </span><span style="color:#F69D50">DataSet</span><span style="color:#F69D50"> returnedValuesSet</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> DataSet</span><span style="color:#ADBAC7">(); </span><span style="color:#F47067">using</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">var</span><span style="color:#F69D50"> connection</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> SqlConnection</span><span style="color:#ADBAC7">(connectionStringSettings.ConnectionString)) { connection.</span><span style="color:#DCBDFB">Open</span><span style="color:#ADBAC7">(); </span><span style="color:#F47067">using</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">var</span><span style="color:#F69D50"> command</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> SqlCommand</span><span style="color:#ADBAC7">()) { command.Connection </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> connection; command.CommandText </span><span style="color:#F47067">=</span><span style="color:#96D0FF"> &quot;SELECT CustomerID, CompanyName FROM Customers WHERE country LIKE &#x27;canada&#x27; &quot;</span><span style="color:#ADBAC7">; command.CommandType </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> System.Data.CommandType.Text; </span><span style="color:#F47067">using</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">var</span><span style="color:#F69D50"> dataAdapter</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> SqlDataAdapter</span><span style="color:#ADBAC7">(command)) { dataAdapter.</span><span style="color:#DCBDFB">Fill</span><span style="color:#ADBAC7">(returnedValuesSet, </span><span style="color:#96D0FF">&quot;Customers&quot;</span><span style="color:#ADBAC7">); } } connection.</span><span style="color:#DCBDFB">Close</span><span style="color:#ADBAC7">(); System.Diagnostics.Debug.</span><span style="color:#DCBDFB">WriteLine</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;Number of rows loaded : &quot;</span><span style="color:#F47067"> +</span><span style="color:#ADBAC7"> returnedValuesSet.Tables[</span><span style="color:#96D0FF">&quot;Customers&quot;</span><span style="color:#ADBAC7">].Rows.Count); } </span></span></code></pre></figure>
<p>The table name is important if you want to use other feature like insert, update and delete because the SqlAdapter will use this table to do the desired task. If you use a fake table name, you will get an exception. This exception is &quot;Update unable to find TableMapping[&#x27;Table&#x27;] or DataTable &#x27;Table&#x27;.&quot;.</p>
<p><img src="/images/blog/updateDataSetRowsFromDataTable-400x100.png" alt=""/></p>
<p>The correct code would be to provide in the <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>InsertCommand</span></span></code></span> property of the <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>SqlDataAdapter</span></span></code></span> a SQL statement with an Insert statement or a stored procedure. If you do not want to create every time the Insert, Update, Delete and Select statement, it&#x27;s possible to use the <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>SqlCommandBuilder</span></span></code></span>.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="csharp" data-theme="github-dark-dimmed"><code data-language="csharp" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#F69D50">ConnectionStringSettings</span><span style="color:#F69D50"> connectionStringSettings</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> ConfigurationManager.ConnectionStrings[</span><span style="color:#96D0FF">&quot;ApplicationServices&quot;</span><span style="color:#ADBAC7">]; </span></span>
<span data-line=""><span style="color:#F69D50">DataSet</span><span style="color:#F69D50"> returnedValuesSet</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> DataSet</span><span style="color:#ADBAC7">(); </span></span>
<span data-line=""><span style="color:#F47067">using</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">var</span><span style="color:#F69D50"> connection</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> SqlConnection</span><span style="color:#ADBAC7">(connectionStringSettings.ConnectionString)) { </span></span>
<span data-line=""><span style="color:#ADBAC7">  connection.</span><span style="color:#DCBDFB">Open</span><span style="color:#ADBAC7">(); </span></span>
<span data-line=""><span style="color:#F47067">  using</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">var</span><span style="color:#F69D50"> command</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> SqlCommand</span><span style="color:#ADBAC7">()) { </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.Connection </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> connection; </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.CommandText </span><span style="color:#F47067">=</span><span style="color:#96D0FF"> &quot;SELECT CustomerID, CompanyName FROM Customers WHERE country LIKE &#x27;canada&#x27; &quot;</span><span style="color:#ADBAC7">; </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.CommandType </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> System.Data.CommandType.Text; </span></span>
<span data-line=""><span style="color:#F47067">    using</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">var</span><span style="color:#F69D50"> dataAdapter</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> SqlDataAdapter</span><span style="color:#ADBAC7">(command)) { </span></span>
<span data-line=""><span style="color:#ADBAC7">      dataAdapter.</span><span style="color:#DCBDFB">Fill</span><span style="color:#ADBAC7">(returnedValuesSet, </span><span style="color:#96D0FF">&quot;Customers&quot;</span><span style="color:#ADBAC7">); </span></span>
<span data-line=""><span style="color:#F47067">      var</span><span style="color:#F69D50"> builder</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> SqlCommandBuilder</span><span style="color:#ADBAC7">(dataAdapter); </span></span>
<span data-line=""><span style="color:#ADBAC7">      dataAdapter.InsertCommand </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> builder.</span><span style="color:#DCBDFB">GetInsertCommand</span><span style="color:#ADBAC7">(); </span></span>
<span data-line=""><span style="color:#ADBAC7">      returnedValuesSet.Tables[</span><span style="color:#96D0FF">&quot;Customers&quot;</span><span style="color:#ADBAC7">].Rows.</span><span style="color:#DCBDFB">Add</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;-1&quot;</span><span style="color:#ADBAC7">, </span><span style="color:#96D0FF">&quot;My Company Name&quot;</span><span style="color:#ADBAC7">);</span></span>
<span data-line=""><span style="color:#ADBAC7">      dataAdapter.</span><span style="color:#DCBDFB">Update</span><span style="color:#ADBAC7">(returnedValuesSet,</span><span style="color:#96D0FF">&quot;Customers&quot;</span><span style="color:#ADBAC7">); </span></span>
<span data-line=""><span style="color:#ADBAC7">    } </span></span>
<span data-line=""><span style="color:#ADBAC7">  } </span></span>
<span data-line=""><span style="color:#ADBAC7">  connection.</span><span style="color:#DCBDFB">Close</span><span style="color:#ADBAC7">(); </span></span>
<span data-line=""><span style="color:#ADBAC7">} </span></span></code></pre></figure>
<p>This will generate the <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>InsertCommand</span></span></code></span> as you can see in this screenshot:</p>
<p><img src="/images/blog/createInsertStatementWithCommandBuilder-400x73.png" alt=""/></p>
<p>The created SQL statement use parameter style and is Sql injection protected.</p>
<p>So far the <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DbDataAdapter</span></span></code></span> commit one change at a time. This is because the <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DbDataAdapter</span></span></code></span> has by default its <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>UpdateBatchSize</span></span></code></span> to one. You can select the size you want or set it to 0 to let the <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DbDataAdapter</span></span></code></span> uses the largest batch size. This will increase the performance of the application.</p>
<h2>In practice</h2>
<p>When using Sql statement, stored procedure or direct Sql you should always use parameters. In practice, in your data access layer when you have a method that return data from the database it should query with a <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DataReader</span></span></code></span> and return a <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DataSet</span></span></code></span>. The reason is the <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DataSet</span></span></code></span> let you close the connection and the <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>DataReader</span></span></code></span> is justified by its speed.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="csharp" data-theme="github-dark-dimmed"><code data-language="csharp" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#F69D50">ConnectionStringSettings</span><span style="color:#F69D50"> connectionStringSettings</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> ConfigurationManager.ConnectionStrings[</span><span style="color:#96D0FF">&quot;ApplicationServices&quot;</span><span style="color:#ADBAC7">]; </span></span>
<span data-line=""><span style="color:#F69D50">DataSet</span><span style="color:#F69D50"> returnedValuesSet</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> DataSet</span><span style="color:#ADBAC7">(); </span></span>
<span data-line=""><span style="color:#F69D50">DataTable</span><span style="color:#F69D50"> returnedTable</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> DataTable</span><span style="color:#ADBAC7">(); </span></span>
<span data-line=""><span style="color:#F47067">using</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">var</span><span style="color:#F69D50"> connection</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> SqlConnection</span><span style="color:#ADBAC7">(connectionStringSettings.ConnectionString)) { </span></span>
<span data-line=""><span style="color:#ADBAC7">  connection.</span><span style="color:#DCBDFB">Open</span><span style="color:#ADBAC7">(); </span><span style="color:#F47067">using</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">var</span><span style="color:#F69D50"> command</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> SqlCommand</span><span style="color:#ADBAC7">()) { </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.Connection </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> connection; </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.CommandText </span><span style="color:#F47067">=</span><span style="color:#96D0FF"> &quot;SELECT CustomerID, CompanyName FROM Customers WHERE country LIKE @country&quot;</span><span style="color:#ADBAC7">; </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.CommandType </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> System.Data.CommandType.Text; </span></span>
<span data-line=""><span style="color:#F69D50">    SqlParameter</span><span style="color:#F69D50"> paramCountry</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> SqlParameter</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;country&quot;</span><span style="color:#ADBAC7">,</span><span style="color:#96D0FF">&quot;canada&quot;</span><span style="color:#ADBAC7">); </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.Parameters.</span><span style="color:#DCBDFB">Add</span><span style="color:#ADBAC7">(paramCountry); </span></span>
<span data-line=""><span style="color:#F47067">    using</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">var</span><span style="color:#F69D50"> reader</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> command.</span><span style="color:#DCBDFB">ExecuteReader</span><span style="color:#ADBAC7">()) { </span></span>
<span data-line=""><span style="color:#ADBAC7">      returnedTable.</span><span style="color:#DCBDFB">Load</span><span style="color:#ADBAC7">(reader,LoadOption.Upsert); </span></span>
<span data-line=""><span style="color:#ADBAC7">      returnedValuesSet.Tables.</span><span style="color:#DCBDFB">Add</span><span style="color:#ADBAC7">(returnedTable); </span></span>
<span data-line=""><span style="color:#ADBAC7">    } </span></span>
<span data-line=""><span style="color:#ADBAC7">  } </span></span>
<span data-line=""><span style="color:#ADBAC7">  connection.</span><span style="color:#DCBDFB">Close</span><span style="color:#ADBAC7">(); </span></span>
<span data-line=""><span style="color:#ADBAC7">} </span></span></code></pre></figure>
<p>For inserting, updating and deleting, parameters must be used too. Here is a good example of code that could be use in a data access layer methods. Your method should return the number of row and accept as parameter your model object of the Customer.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="csharp" data-theme="github-dark-dimmed"><code data-language="csharp" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#F69D50"> ConnectionStringSettings</span><span style="color:#F69D50"> connectionStringSettings</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> ConfigurationManager.ConnectionStrings[</span><span style="color:#96D0FF">&quot;ApplicationServices&quot;</span><span style="color:#ADBAC7">]; </span></span>
<span data-line=""><span style="color:#F69D50"> DataSet</span><span style="color:#F69D50"> returnedValuesSet</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> DataSet</span><span style="color:#ADBAC7">(); </span></span>
<span data-line=""><span style="color:#F69D50"> DataTable</span><span style="color:#F69D50"> returnedTable</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> DataTable</span><span style="color:#ADBAC7">(); </span></span>
<span data-line=""><span style="color:#F47067"> int</span><span style="color:#F69D50"> rowsAffected</span><span style="color:#ADBAC7">; </span><span style="color:#F47067">using</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">var</span><span style="color:#F69D50"> connection</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> SqlConnection</span><span style="color:#ADBAC7">(connectionStringSettings.ConnectionString)) { </span></span>
<span data-line=""><span style="color:#ADBAC7">  connection.</span><span style="color:#DCBDFB">Open</span><span style="color:#ADBAC7">(); </span></span>
<span data-line=""><span style="color:#F47067">  using</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">var</span><span style="color:#F69D50"> command</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> SqlCommand</span><span style="color:#ADBAC7">()) { </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.Connection </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> connection; </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.CommandText </span><span style="color:#F47067">=</span><span style="color:#96D0FF"> &quot;INSERT INTO customers (CustomerID, CompanyName) VALUES (@id, @name)&quot;</span><span style="color:#ADBAC7">; </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.CommandType </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> System.Data.CommandType.Text; </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.Parameters.</span><span style="color:#DCBDFB">Add</span><span style="color:#ADBAC7">(</span><span style="color:#F47067">new</span><span style="color:#F69D50"> SqlParameter</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;id&quot;</span><span style="color:#ADBAC7">,</span><span style="color:#96D0FF">&quot;P1&quot;</span><span style="color:#ADBAC7">)); </span></span>
<span data-line=""><span style="color:#ADBAC7">    command.Parameters.</span><span style="color:#DCBDFB">Add</span><span style="color:#ADBAC7">(</span><span style="color:#F47067">new</span><span style="color:#F69D50"> SqlParameter</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;name&quot;</span><span style="color:#ADBAC7">, </span><span style="color:#96D0FF">&quot;MyName&quot;</span><span style="color:#ADBAC7">)); </span></span>
<span data-line=""><span style="color:#ADBAC7">    rowsAffected </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> command.</span><span style="color:#DCBDFB">ExecuteNonQuery</span><span style="color:#ADBAC7">(); </span></span>
<span data-line=""><span style="color:#ADBAC7">  } </span></span>
<span data-line=""><span style="color:#ADBAC7">  connection.</span><span style="color:#DCBDFB">Close</span><span style="color:#ADBAC7">(); </span></span>
<span data-line=""><span style="color:#ADBAC7">} </span></span></code></pre></figure>
<p>Do not forget to handling the DbAdapter&#x27;s <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>UpdateBatchSize</span></span></code></span> when you have a collection that you are going to update. Let say that you pass to your data access layer a collection (<span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>IList</span></span></code></span>). Your method should check the <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>Count</span></span></code></span> of items and adjust the <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>UpdateBatchSize</span></span></code></span> to the <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>Count</span></span></code></span>. This way, your performance will increase by a lot.</p>
<p>Last important thing is the use of <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>Transaction</span></span></code></span>. Usually when something goes wrong you would like to know about it and to cancel the current batch edition to restart it once the problem is fixed. Sql Transaction will be discussed in a future article but should be there for insert, update and delete queries.</p></div></main><div class="layout_paginationBar__jnuuR"><div class="layout_paginationTitle__PsOw5">Chronological Blog Articles by Page</div><div class="layout_paginationLinks__LdBaH"><a class="" href="/blog/page/1">1</a><a class="" href="/blog/page/2">2</a><a class="" href="/blog/page/3">3</a><a class="" href="/blog/page/4">4</a><a class="" href="/blog/page/5">5</a><a class="" href="/blog/page/6">6</a><a class="" href="/blog/page/7">7</a><a class="" href="/blog/page/8">8</a><a class="" href="/blog/page/9">9</a><a class="" href="/blog/page/10">10</a><a class="" href="/blog/page/11">11</a><a class="" href="/blog/page/12">12</a><a class="" href="/blog/page/13">13</a><a class="" href="/blog/page/14">14</a><a class="" href="/blog/page/15">15</a><a class="" href="/blog/page/16">16</a><a class="" href="/blog/page/17">17</a><a class="" href="/blog/page/18">18</a><a class="" href="/blog/page/19">19</a><a class="" href="/blog/page/20">20</a><a class="" href="/blog/page/21">21</a><a class="" href="/blog/page/22">22</a><a class="" href="/blog/page/23">23</a><a class="" href="/blog/page/24">24</a><a class="" href="/blog/page/25">25</a><a class="" href="/blog/page/26">26</a><a class="" href="/blog/page/27">27</a><a class="" href="/blog/page/28">28</a><a class="" href="/blog/page/29">29</a><a class="" href="/blog/page/30">30</a><a class="" href="/blog/page/31">31</a><a class="" href="/blog/page/32">32</a><a class="" href="/blog/page/33">33</a><a class="" href="/blog/page/34">34</a><a class="" href="/blog/page/35">35</a><a class="" href="/blog/page/36">36</a><a class="" href="/blog/page/37">37</a><a class="" href="/blog/page/38">38</a><a class="" href="/blog/page/39">39</a><a class="" href="/blog/page/40">40</a><a class="" href="/blog/page/41">41</a><a class="" href="/blog/page/42">42</a><a class="" href="/blog/page/43">43</a><a class="" href="/blog/page/44">44</a><a class="" href="/blog/page/45">45</a><a class="" href="/blog/page/46">46</a><a class="" href="/blog/page/47">47</a><a class="" href="/blog/page/48">48</a><a class="" href="/blog/page/49">49</a><a class="" href="/blog/page/50">50</a><a class="" href="/blog/page/51">51</a><a class="" href="/blog/page/52">52</a><a class="" href="/blog/page/53">53</a><a class="" href="/blog/page/54">54</a><a class="" href="/blog/page/55">55</a><a class="" href="/blog/page/56">56</a><a class="" href="/blog/page/57">57</a><a class="" href="/blog/page/58">58</a><a class="" href="/blog/page/59">59</a><a class="" href="/blog/page/60">60</a><a class="" href="/blog/page/61">61</a><a class="" href="/blog/page/62">62</a><a class="" href="/blog/page/63">63</a><a class="" href="/blog/page/64">64</a><a class="" href="/blog/page/65">65</a><a class="" href="/blog/page/66">66</a><a class="" href="/blog/page/67">67</a><a class="" href="/blog/page/68">68</a><a class="" href="/blog/page/69">69</a><a class="" href="/blog/page/70">70</a><a class="" href="/blog/page/71">71</a><a class="" href="/blog/page/72">72</a><a class="" href="/blog/page/73">73</a><a class="" href="/blog/page/74">74</a><a class="" href="/blog/page/75">75</a><a class="" href="/blog/page/76">76</a><a class="" href="/blog/page/77">77</a></div></div></div></div><script src="/_next/static/chunks/webpack-c94468cbefcc94b8.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/4f3d065c9e2d01e0.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:HL[\"/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n4:HL[\"/_next/static/css/8ea1dcbe6e4b9929.css\",\"style\",{\"crossOrigin\":\"\"}]\n"])</script><script>self.__next_f.push([1,"5:I[7690,[],\"\"]\n8:I[5613,[],\"\"]\na:I[1778,[],\"\"]\nb:I[5250,[\"250\",\"static/chunks/250-d7e0a94ebe194dac.js\",\"79\",\"static/chunks/79-2d03397107aae3f1.js\",\"308\",\"static/chunks/app/blog/%5Bslug%5D/page-6ef1cad01f05dc10.js\"],\"\"]\nd:I[8955,[],\"\"]\n9:[\"slug\",\"datareader-and-dataadapters-to-read-from-the-database\",\"d\"]\ne:[]\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/4f3d065c9e2d01e0.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L5\",null,{\"buildId\":\"pQvqCOvKm2LGzk0s7VKrc\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/blog/datareader-and-dataadapters-to-read-from-the-database\",\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"datareader-and-dataadapters-to-read-from-the-database\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"datareader-and-dataadapters-to-read-from-the-database\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"datareader-and-dataadapters-to-read-from-the-database\",\"d\"],{\"children\":[\"__PAGE__\",{},[\"$L6\",\"$L7\",null]]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$9\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/8ea1dcbe6e4b9929.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}]]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[null,[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"layout_bodystyle__4ncsS\",\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"div\",null,{\"style\":{\"display\":\"flex\",\"alignItems\":\"center\",\"justifyContent\":\"center\",\"height\":\"100vh\"},\"children\":[\"$\",\"div\",null,{\"style\":{\"width\":\"50%\",\"height\":\"20%\",\"backgroundColor\":\"#ffeded\",\"borderRadius\":12,\"padding\":12,\"textAlign\":\"center\"},\"children\":[[\"$\",\"h1\",null,{\"children\":\"Not Found\"}],[\"$\",\"p\",null,{\"children\":\"Could not find requested resource\"}],[\"$\",\"$Lb\",null,{\"href\":\"/\",\"children\":\"Return Home\"}]]}]}],\"notFoundStyles\":[],\"styles\":null}]}]}],null]],\"initialHead\":[false,\"$Lc\"],\"globalErrorComponent\":\"$d\",\"missingSlots\":\"$We\"}]]\n"])</script><script>self.__next_f.push([1,"f:I[1749,[\"250\",\"static/chunks/250-d7e0a94ebe194dac.js\",\"79\",\"static/chunks/79-2d03397107aae3f1.js\",\"308\",\"static/chunks/app/blog/%5Bslug%5D/page-6ef1cad01f05dc10.js\"],\"Image\"]\nc:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Patrick Desjardins Blog - DataReader and DataAdapters to read from the database\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"DataReader and DataAdapters to read from the dat"])</script><script>self.__next_f.push([1,"abase\"}],[\"$\",\"meta\",\"4\",{\"name\":\"next-size-adjust\"}]]\n6:null\n"])</script><script>self.__next_f.push([1,"7:[\"$\",\"div\",null,{\"className\":\"__className_aaf875\",\"children\":[\"$\",\"div\",null,{\"className\":\"layout_container__Tovb9\",\"children\":[[\"$\",\"header\",null,{\"className\":\"layout_siteTitle__k5U8g\",\"children\":\"Patrick Desjardins Blog\"}],[\"$\",\"nav\",null,{\"children\":[\"$\",\"ul\",null,{\"className\":\"layout_navLinks__mf70r\",\"children\":[\"$\",\"li\",null,{\"className\":\"layout_navLinkItem__1L8fB\",\"children\":[[\"$\",\"$Lb\",null,{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/\",\"children\":\"Main Page\"}],[\"$\",\"$Lb\",null,{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog\",\"children\":\"Blog\"}],[[\"$\",\"$Lb\",\"2024\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2024\",\"children\":2024}],[\"$\",\"$Lb\",\"2023\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2023\",\"children\":2023}],[\"$\",\"$Lb\",\"2022\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2022\",\"children\":2022}],[\"$\",\"$Lb\",\"2021\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2021\",\"children\":2021}],[\"$\",\"$Lb\",\"2020\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2020\",\"children\":2020}],[\"$\",\"$Lb\",\"2019\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2019\",\"children\":2019}],[\"$\",\"$Lb\",\"2018\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2018\",\"children\":2018}],[\"$\",\"$Lb\",\"2017\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2017\",\"children\":2017}],[\"$\",\"$Lb\",\"2016\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2016\",\"children\":2016}],[\"$\",\"$Lb\",\"2015\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2015\",\"children\":2015}],[\"$\",\"$Lb\",\"2014\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2014\",\"children\":2014}],[\"$\",\"$Lb\",\"2013\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2013\",\"children\":2013}],[\"$\",\"$Lb\",\"2012\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2012\",\"children\":2012}],[\"$\",\"$Lb\",\"2011\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2011\",\"children\":2011}]]]}]}]}],[\"$\",\"div\",null,{\"className\":\"layout_blogPictureContainer__XC7nK\",\"children\":[\"$\",\"$Lf\",null,{\"className\":\"layout_blogTopPicture__RJHNN\",\"alt\":\"Patrick Desjardins picture from a conference\",\"src\":\"/images/backgrounds/patrickdesjardins_conference_bw.jpeg\",\"width\":800,\"height\":260}]}],[\"$\",\"main\",null,{\"className\":\"layout_main__mXTwS\",\"children\":[[\"$\",\"h1\",null,{\"children\":\"DataReader and DataAdapters to read from the database\"}],[\"$\",\"div\",null,{\"className\":\"layout_blogPostContainer__WYELx\",\"children\":[[\"$\",\"p\",null,{\"className\":\"layout_blogPostDate__LUvx5\",\"children\":[\"Posted on: \",\"2011-09-29\"]}],[[\"$\",\"p\",null,{\"children\":[\"To read data from the database you need to use something else from \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DbCommand\"}]}]}]}],\" that was returning no data. Two options are available. The first one is the DataReader, the second is the DataAdapters.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"DataReader\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This is the fastest way to read data from the database. To create a \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DataReader\"}]}]}]}],\" object, the use of \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"ExecuteReader\"}]}]}]}],\" from the \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DbCommand\"}]}]}]}],\" class is required. It's required because you will still need to give them the type of query you want and the SQL statement (or the stored procedure name). Then, the method \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"ExecuteReader()\"}]}]}]}],\" return a \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DataReader\"}]}]}]}],\". In the example below, the reader is a \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"SqlDataReader\"}]}]}]}],\". This one derive from \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DataReader\"}]}]}]}],\" and is more specialized for Microsoft Sql Server. The latest solution is really not performant.\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"ConnectionStringSettings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" connectionStringSettings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" ConfigurationManager.ConnectionStrings[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"ApplicationServices\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"]; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"var\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" connection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlConnection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(connectionStringSettings.ConnectionString)) { \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  connection.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Open\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"var\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" command\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlCommand\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"()) { \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.Connection \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" connection; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.CommandText \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" \\\"SELECT CustomerID, CompanyName FROM Customers WHERE country LIKE 'canada' \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.CommandType \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" System.Data.CommandType.Text; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"SqlDataReader\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" reader\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" command.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"ExecuteReader\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"()) { \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"      while\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (reader.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Read\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"()) { \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"        System.Diagnostics.Debug.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"WriteLine\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Format\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"{0}:{1}\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\",reader[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"CustomerID\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"], reader[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"CompanyName\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"])); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      } \"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    } \"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  } \"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  connection.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Close\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"} \"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DataReader\"}]}]}]}],\" acts like a cursor. It can only go forward. You can access the value of each row by using the square braquet \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"[]\"}]}]}]}],\". You can put the name of the field or a integer that represent the index of the position of the field. For example, we could have replace:\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" System.Diagnostics.Debug.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"WriteLine\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Format\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"{0}:{1}\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\",reader[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"CustomerID\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"], reader[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"CompanyName\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"])); \"}]]}]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"by\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" System.Diagnostics.Debug.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"WriteLine\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Format\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"{0}:{1}\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\",reader[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"], reader[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"])); \"}]]}]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The problem with the latest version is the maintainability. It's harder to know what will be displayed. Also, it can be problematic if the order of the returned data change. Let say that you get data from a stored procedure and for an unknown reason the database administrator change the order of the returned field. This would create a problem but not if the name were used.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"You can also load the whole data set in one shot using the Load method. The data is loaded into a DataTable.\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"ConnectionStringSettings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" connectionStringSettings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" ConfigurationManager.ConnectionStrings[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"ApplicationServices\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"]; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"DataTable\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" datas\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" DataTable\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"var\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" connection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlConnection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(connectionStringSettings.ConnectionString)) { \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  connection.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Open\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"var\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" command\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlCommand\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"()) { \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.Connection \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" connection; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.CommandText \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" \\\"SELECT CustomerID, CompanyName FROM Customers WHERE country LIKE 'canada' \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.CommandType \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" System.Data.CommandType.Text; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"SqlDataReader\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" reader\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" command.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"ExecuteReader\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"()) { \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      datas.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Load\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(reader, LoadOption.Upsert); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    } \"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  } \"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  connection.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Close\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  System.Diagnostics.Debug.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"WriteLine\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"Number of rows loaded : \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" +\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" datas.Rows.Count); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"} \"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"One problem with DataReader is that it uses a cursor on the server and it keeps the connection to the server open while looping. The second problem is that while looping you won't be able to execute an other query withing the loop. To solve that problem you can load all the data and loop after or use the Load method. Another option is to use a DbConnection with a special connection string. This connection string will require to have the attribute \\\"MultipleActiveResultSets=True\\\". This let have multiple command but at the cost of performance issue. It has to be used with cautiousness.\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Scalar\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Sometime, we want to have just a single value. This can be an ID from a username, but more often it will be to get a value from an aggregate function, like a count. We could use the DataReader but this give some overhead for a single value.\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"ConnectionStringSettings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" connectionStringSettings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" ConfigurationManager.ConnectionStrings[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"ApplicationServices\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"]; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"var\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" connection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlConnection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(connectionStringSettings.ConnectionString)) { \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  connection.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Open\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"var\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" command\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlCommand\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"()) { \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.Connection \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" connection; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.CommandText \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" \\\"SELECT count(CustomerID) FROM Customers WHERE country LIKE 'canada' \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.CommandType \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" System.Data.CommandType.Text; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    int\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" countValue\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"int\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\")command.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"ExecuteScalar\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    System.Diagnostics.Debug.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"WriteLine\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"Count value:\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" +\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" countValue); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  } connection.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Close\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"} \"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"As you can see, line 10 use the \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"ExecuteScalar\"}]}]}]}],\" from the DbCommand to return an Object. In our case, we return an integer.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"DbDataAdapter\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DbDataAdapter\"}]}]}]}],\" is the reader that give you the more leverage in data functionality. Not only it let you get the data but it let you update them.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The DbDataAdapter class derive from \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DataAdapter\"}]}]}]}],\". As the other command, a Microsoft Sql Server one exist and it's called: \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"SqlDataAdapter\"}]}]}]}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DbDataAdapter\"}]}]}]}],\" contains a \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"SelectCommand\"}]}]}]}],\" that use an \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"ExecuteReader\"}]}]}]}],\". Internally the data is loaded in a \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DataTable\"}]}]}]}],\". This let the developer change the value inside the \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DataTable\"}]}]}]}],\" and if desired update them to the database or insert new rows added and also delete those who are not anymore in the \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DataTable\"}]}]}]}],\". The \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DbDataApter\"}]}]}]}],\" is wise enough to open and close the connection. In the other end, it let the user open the connection if desired. In that case, the user will also need to close it. This can be useful when multiple calls is required because it won't open-close repetitively which is costly in performance. Here is an example of how to load data from the database into a \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DbDataAdapter\"}]}]}]}],\".\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" ConnectionStringSettings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" connectionStringSettings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" ConfigurationManager.ConnectionStrings[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"ApplicationServices\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"]; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" DataSet\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" returnedValuesSet\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" DataSet\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"var\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" connection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlConnection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(connectionStringSettings.ConnectionString)) { \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  connection.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Open\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"var\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" command\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlCommand\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"()) { \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.Connection \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" connection; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.CommandText \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" \\\"SELECT CustomerID, CompanyName FROM Customers WHERE country LIKE 'canada' \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.CommandType \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" System.Data.CommandType.Text; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"var\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" dataAdapter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlDataAdapter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(command)) { \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      dataAdapter.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Fill\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(returnedValuesSet); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    } \"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  } \"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  connection.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Close\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  System.Diagnostics.Debug.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"WriteLine\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"Number of rows loaded : \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" +\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" returnedValuesSet.Tables[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"].Rows.Count); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"} \"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"So, now the \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DataSet\"}]}]}]}],\" is filled up with the query data. It's a non-connected object but will still be able to do update later on. From this example, we can see that the SqlDataAdapter fill up with the \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"Fill\"}]}]}]}],\" method. This \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"Fill\"}]}]}]}],\" method can also takes a second argument that is the name of the name of the table. This mean we can modify the previous example with this one and instead of referring the data in the \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DataSet\"}]}]}]}],\" with an index, we will be able to use the string as a key.\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"ConnectionStringSettings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" connectionStringSettings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" ConfigurationManager.ConnectionStrings[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"ApplicationServices\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"]; \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"DataSet\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" returnedValuesSet\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" DataSet\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"var\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" connection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlConnection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(connectionStringSettings.ConnectionString)) { connection.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Open\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"var\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" command\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlCommand\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"()) { command.Connection \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" connection; command.CommandText \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" \\\"SELECT CustomerID, CompanyName FROM Customers WHERE country LIKE 'canada' \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"; command.CommandType \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" System.Data.CommandType.Text; \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"var\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" dataAdapter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlDataAdapter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(command)) { dataAdapter.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Fill\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(returnedValuesSet, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"Customers\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"); } } connection.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Close\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); System.Diagnostics.Debug.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"WriteLine\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"Number of rows loaded : \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" +\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" returnedValuesSet.Tables[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"Customers\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"].Rows.Count); } \"}]]}]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The table name is important if you want to use other feature like insert, update and delete because the SqlAdapter will use this table to do the desired task. If you use a fake table name, you will get an exception. This exception is \\\"Update unable to find TableMapping['Table'] or DataTable 'Table'.\\\".\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/blog/updateDataSetRowsFromDataTable-400x100.png\",\"alt\":\"\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The correct code would be to provide in the \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"InsertCommand\"}]}]}]}],\" property of the \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"SqlDataAdapter\"}]}]}]}],\" a SQL statement with an Insert statement or a stored procedure. If you do not want to create every time the Insert, Update, Delete and Select statement, it's possible to use the \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"SqlCommandBuilder\"}]}]}]}],\".\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"ConnectionStringSettings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" connectionStringSettings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" ConfigurationManager.ConnectionStrings[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"ApplicationServices\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"]; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"DataSet\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" returnedValuesSet\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" DataSet\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"var\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" connection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlConnection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(connectionStringSettings.ConnectionString)) { \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  connection.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Open\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"var\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" command\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlCommand\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"()) { \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.Connection \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" connection; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.CommandText \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" \\\"SELECT CustomerID, CompanyName FROM Customers WHERE country LIKE 'canada' \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.CommandType \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" System.Data.CommandType.Text; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"var\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" dataAdapter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlDataAdapter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(command)) { \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      dataAdapter.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Fill\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(returnedValuesSet, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"Customers\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"      var\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" builder\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlCommandBuilder\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(dataAdapter); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      dataAdapter.InsertCommand \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" builder.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"GetInsertCommand\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      returnedValuesSet.Tables[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"Customers\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"].Rows.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Add\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"-1\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"My Company Name\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      dataAdapter.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Update\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(returnedValuesSet,\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"Customers\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    } \"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  } \"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  connection.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Close\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"} \"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This will generate the \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"InsertCommand\"}]}]}]}],\" as you can see in this screenshot:\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/blog/createInsertStatementWithCommandBuilder-400x73.png\",\"alt\":\"\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The created SQL statement use parameter style and is Sql injection protected.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"So far the \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DbDataAdapter\"}]}]}]}],\" commit one change at a time. This is because the \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DbDataAdapter\"}]}]}]}],\" has by default its \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"UpdateBatchSize\"}]}]}]}],\" to one. You can select the size you want or set it to 0 to let the \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DbDataAdapter\"}]}]}]}],\" uses the largest batch size. This will increase the performance of the application.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"In practice\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"When using Sql statement, stored procedure or direct Sql you should always use parameters. In practice, in your data access layer when you have a method that return data from the database it should query with a \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DataReader\"}]}]}]}],\" and return a \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DataSet\"}]}]}]}],\". The reason is the \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DataSet\"}]}]}]}],\" let you close the connection and the \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"DataReader\"}]}]}]}],\" is justified by its speed.\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"ConnectionStringSettings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" connectionStringSettings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" ConfigurationManager.ConnectionStrings[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"ApplicationServices\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"]; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"DataSet\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" returnedValuesSet\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" DataSet\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"DataTable\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" returnedTable\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" DataTable\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"var\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" connection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlConnection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(connectionStringSettings.ConnectionString)) { \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  connection.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Open\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"var\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" command\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlCommand\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"()) { \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.Connection \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" connection; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.CommandText \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" \\\"SELECT CustomerID, CompanyName FROM Customers WHERE country LIKE @country\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.CommandType \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" System.Data.CommandType.Text; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"    SqlParameter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" paramCountry\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlParameter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"country\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"canada\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.Parameters.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Add\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(paramCountry); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"var\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" reader\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" command.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"ExecuteReader\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"()) { \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      returnedTable.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Load\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(reader,LoadOption.Upsert); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"      returnedValuesSet.Tables.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Add\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(returnedTable); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    } \"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  } \"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  connection.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Close\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"} \"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"For inserting, updating and deleting, parameters must be used too. Here is a good example of code that could be use in a data access layer methods. Your method should return the number of row and accept as parameter your model object of the Customer.\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" ConnectionStringSettings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" connectionStringSettings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" ConfigurationManager.ConnectionStrings[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"ApplicationServices\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"]; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" DataSet\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" returnedValuesSet\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" DataSet\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" DataTable\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" returnedTable\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" DataTable\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" int\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" rowsAffected\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"; \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"var\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" connection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlConnection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(connectionStringSettings.ConnectionString)) { \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  connection.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Open\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  using\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"var\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" command\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlCommand\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"()) { \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.Connection \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" connection; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.CommandText \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" \\\"INSERT INTO customers (CustomerID, CompanyName) VALUES (@id, @name)\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.CommandType \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" System.Data.CommandType.Text; \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.Parameters.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Add\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlParameter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"id\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"P1\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\")); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    command.Parameters.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Add\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" SqlParameter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"name\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"MyName\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\")); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    rowsAffected \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" command.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"ExecuteNonQuery\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  } \"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  connection.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Close\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"} \"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Do not forget to handling the DbAdapter's \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"UpdateBatchSize\"}]}]}]}],\" when you have a collection that you are going to update. Let say that you pass to your data access layer a collection (\",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"IList\"}]}]}]}],\"). Your method should check the \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"Count\"}]}]}]}],\" of items and adjust the \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"UpdateBatchSize\"}]}]}]}],\" to the \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"Count\"}]}]}]}],\". This way, your performance will increase by a lot.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Last important thing is the use of \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"Transaction\"}]}]}]}],\". Usually when something goes wrong you would like to know about it and to cancel the current batch edition to restart it once the problem is fixed. Sql Transaction will be discussed in a future article but should be there for insert, update and delete queries.\"]}]]]}]]}],[\"$\",\"div\",null,{\"className\":\"layout_paginationBar__jnuuR\",\"children\":[[\"$\",\"div\",null,{\"className\":\"layout_paginationTitle__PsOw5\",\"children\":\"Chronological Blog Articles by Page\"}],[\"$\",\"div\",null,{\"className\":\"layout_paginationLinks__LdBaH\",\"children\":[[\"$\",\"$Lb\",\"1\",{\"className\":\"\",\"href\":\"/blog/page/1\",\"children\":1}],[\"$\",\"$Lb\",\"2\",{\"className\":\"\",\"href\":\"/blog/page/2\",\"children\":2}],[\"$\",\"$Lb\",\"3\",{\"className\":\"\",\"href\":\"/blog/page/3\",\"children\":3}],[\"$\",\"$Lb\",\"4\",{\"className\":\"\",\"href\":\"/blog/page/4\",\"children\":4}],[\"$\",\"$Lb\",\"5\",{\"className\":\"\",\"href\":\"/blog/page/5\",\"children\":5}],[\"$\",\"$Lb\",\"6\",{\"className\":\"\",\"href\":\"/blog/page/6\",\"children\":6}],[\"$\",\"$Lb\",\"7\",{\"className\":\"\",\"href\":\"/blog/page/7\",\"children\":7}],[\"$\",\"$Lb\",\"8\",{\"className\":\"\",\"href\":\"/blog/page/8\",\"children\":8}],[\"$\",\"$Lb\",\"9\",{\"className\":\"\",\"href\":\"/blog/page/9\",\"children\":9}],[\"$\",\"$Lb\",\"10\",{\"className\":\"\",\"href\":\"/blog/page/10\",\"children\":10}],[\"$\",\"$Lb\",\"11\",{\"className\":\"\",\"href\":\"/blog/page/11\",\"children\":11}],[\"$\",\"$Lb\",\"12\",{\"className\":\"\",\"href\":\"/blog/page/12\",\"children\":12}],[\"$\",\"$Lb\",\"13\",{\"className\":\"\",\"href\":\"/blog/page/13\",\"children\":13}],[\"$\",\"$Lb\",\"14\",{\"className\":\"\",\"href\":\"/blog/page/14\",\"children\":14}],[\"$\",\"$Lb\",\"15\",{\"className\":\"\",\"href\":\"/blog/page/15\",\"children\":15}],[\"$\",\"$Lb\",\"16\",{\"className\":\"\",\"href\":\"/blog/page/16\",\"children\":16}],[\"$\",\"$Lb\",\"17\",{\"className\":\"\",\"href\":\"/blog/page/17\",\"children\":17}],[\"$\",\"$Lb\",\"18\",{\"className\":\"\",\"href\":\"/blog/page/18\",\"children\":18}],[\"$\",\"$Lb\",\"19\",{\"className\":\"\",\"href\":\"/blog/page/19\",\"children\":19}],[\"$\",\"$Lb\",\"20\",{\"className\":\"\",\"href\":\"/blog/page/20\",\"children\":20}],[\"$\",\"$Lb\",\"21\",{\"className\":\"\",\"href\":\"/blog/page/21\",\"children\":21}],[\"$\",\"$Lb\",\"22\",{\"className\":\"\",\"href\":\"/blog/page/22\",\"children\":22}],[\"$\",\"$Lb\",\"23\",{\"className\":\"\",\"href\":\"/blog/page/23\",\"children\":23}],[\"$\",\"$Lb\",\"24\",{\"className\":\"\",\"href\":\"/blog/page/24\",\"children\":24}],[\"$\",\"$Lb\",\"25\",{\"className\":\"\",\"href\":\"/blog/page/25\",\"children\":25}],[\"$\",\"$Lb\",\"26\",{\"className\":\"\",\"href\":\"/blog/page/26\",\"children\":26}],[\"$\",\"$Lb\",\"27\",{\"className\":\"\",\"href\":\"/blog/page/27\",\"children\":27}],[\"$\",\"$Lb\",\"28\",{\"className\":\"\",\"href\":\"/blog/page/28\",\"children\":28}],[\"$\",\"$Lb\",\"29\",{\"className\":\"\",\"href\":\"/blog/page/29\",\"children\":29}],[\"$\",\"$Lb\",\"30\",{\"className\":\"\",\"href\":\"/blog/page/30\",\"children\":30}],[\"$\",\"$Lb\",\"31\",{\"className\":\"\",\"href\":\"/blog/page/31\",\"children\":31}],[\"$\",\"$Lb\",\"32\",{\"className\":\"\",\"href\":\"/blog/page/32\",\"children\":32}],[\"$\",\"$Lb\",\"33\",{\"className\":\"\",\"href\":\"/blog/page/33\",\"children\":33}],[\"$\",\"$Lb\",\"34\",{\"className\":\"\",\"href\":\"/blog/page/34\",\"children\":34}],[\"$\",\"$Lb\",\"35\",{\"className\":\"\",\"href\":\"/blog/page/35\",\"children\":35}],[\"$\",\"$Lb\",\"36\",{\"className\":\"\",\"href\":\"/blog/page/36\",\"children\":36}],[\"$\",\"$Lb\",\"37\",{\"className\":\"\",\"href\":\"/blog/page/37\",\"children\":37}],[\"$\",\"$Lb\",\"38\",{\"className\":\"\",\"href\":\"/blog/page/38\",\"children\":38}],[\"$\",\"$Lb\",\"39\",{\"className\":\"\",\"href\":\"/blog/page/39\",\"children\":39}],[\"$\",\"$Lb\",\"40\",{\"className\":\"\",\"href\":\"/blog/page/40\",\"children\":40}],[\"$\",\"$Lb\",\"41\",{\"className\":\"\",\"href\":\"/blog/page/41\",\"children\":41}],[\"$\",\"$Lb\",\"42\",{\"className\":\"\",\"href\":\"/blog/page/42\",\"children\":42}],[\"$\",\"$Lb\",\"43\",{\"className\":\"\",\"href\":\"/blog/page/43\",\"children\":43}],[\"$\",\"$Lb\",\"44\",{\"className\":\"\",\"href\":\"/blog/page/44\",\"children\":44}],[\"$\",\"$Lb\",\"45\",{\"className\":\"\",\"href\":\"/blog/page/45\",\"children\":45}],[\"$\",\"$Lb\",\"46\",{\"className\":\"\",\"href\":\"/blog/page/46\",\"children\":46}],[\"$\",\"$Lb\",\"47\",{\"className\":\"\",\"href\":\"/blog/page/47\",\"children\":47}],[\"$\",\"$Lb\",\"48\",{\"className\":\"\",\"href\":\"/blog/page/48\",\"children\":48}],[\"$\",\"$Lb\",\"49\",{\"className\":\"\",\"href\":\"/blog/page/49\",\"children\":49}],[\"$\",\"$Lb\",\"50\",{\"className\":\"\",\"href\":\"/blog/page/50\",\"children\":50}],[\"$\",\"$Lb\",\"51\",{\"className\":\"\",\"href\":\"/blog/page/51\",\"children\":51}],[\"$\",\"$Lb\",\"52\",{\"className\":\"\",\"href\":\"/blog/page/52\",\"children\":52}],[\"$\",\"$Lb\",\"53\",{\"className\":\"\",\"href\":\"/blog/page/53\",\"children\":53}],[\"$\",\"$Lb\",\"54\",{\"className\":\"\",\"href\":\"/blog/page/54\",\"children\":54}],[\"$\",\"$Lb\",\"55\",{\"className\":\"\",\"href\":\"/blog/page/55\",\"children\":55}],[\"$\",\"$Lb\",\"56\",{\"className\":\"\",\"href\":\"/blog/page/56\",\"children\":56}],[\"$\",\"$Lb\",\"57\",{\"className\":\"\",\"href\":\"/blog/page/57\",\"children\":57}],[\"$\",\"$Lb\",\"58\",{\"className\":\"\",\"href\":\"/blog/page/58\",\"children\":58}],[\"$\",\"$Lb\",\"59\",{\"className\":\"\",\"href\":\"/blog/page/59\",\"children\":59}],[\"$\",\"$Lb\",\"60\",{\"className\":\"\",\"href\":\"/blog/page/60\",\"children\":60}],[\"$\",\"$Lb\",\"61\",{\"className\":\"\",\"href\":\"/blog/page/61\",\"children\":61}],[\"$\",\"$Lb\",\"62\",{\"className\":\"\",\"href\":\"/blog/page/62\",\"children\":62}],[\"$\",\"$Lb\",\"63\",{\"className\":\"\",\"href\":\"/blog/page/63\",\"children\":63}],[\"$\",\"$Lb\",\"64\",{\"className\":\"\",\"href\":\"/blog/page/64\",\"children\":64}],[\"$\",\"$Lb\",\"65\",{\"className\":\"\",\"href\":\"/blog/page/65\",\"children\":65}],[\"$\",\"$Lb\",\"66\",{\"className\":\"\",\"href\":\"/blog/page/66\",\"children\":66}],[\"$\",\"$Lb\",\"67\",{\"className\":\"\",\"href\":\"/blog/page/67\",\"children\":67}],[\"$\",\"$Lb\",\"68\",{\"className\":\"\",\"href\":\"/blog/page/68\",\"children\":68}],[\"$\",\"$Lb\",\"69\",{\"className\":\"\",\"href\":\"/blog/page/69\",\"children\":69}],[\"$\",\"$Lb\",\"70\",{\"className\":\"\",\"href\":\"/blog/page/70\",\"children\":70}],[\"$\",\"$Lb\",\"71\",{\"className\":\"\",\"href\":\"/blog/page/71\",\"children\":71}],[\"$\",\"$Lb\",\"72\",{\"className\":\"\",\"href\":\"/blog/page/72\",\"children\":72}],[\"$\",\"$Lb\",\"73\",{\"className\":\"\",\"href\":\"/blog/page/73\",\"children\":73}],[\"$\",\"$Lb\",\"74\",{\"className\":\"\",\"href\":\"/blog/page/74\",\"children\":74}],[\"$\",\"$Lb\",\"75\",{\"className\":\"\",\"href\":\"/blog/page/75\",\"children\":75}],[\"$\",\"$Lb\",\"76\",{\"className\":\"\",\"href\":\"/blog/page/76\",\"children\":76}],[\"$\",\"$Lb\",\"77\",{\"className\":\"\",\"href\":\"/blog/page/77\",\"children\":77}]]}]]}]]}]}]\n"])</script><script>self.__next_f.push([1,""])</script></body></html>
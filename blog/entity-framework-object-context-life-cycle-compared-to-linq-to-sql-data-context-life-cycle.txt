3:I[6405,[],""]
5:I[5337,[],""]
6:I[156,["156","static/chunks/156-2b9f703633e98ef7.js","836","static/chunks/836-7e37630a3372363c.js","308","static/chunks/app/blog/%5Bslug%5D/page-2829e3c199d313ca.js"],""]
4:["slug","entity-framework-object-context-life-cycle-compared-to-linq-to-sql-data-context-life-cycle","d"]
0:["GnV8F5LnEjEoEwDYIFHzI",[[["",{"children":["blog",{"children":[["slug","entity-framework-object-context-life-cycle-compared-to-linq-to-sql-data-context-life-cycle","d"],{"children":["__PAGE__?{\"slug\":\"entity-framework-object-context-life-cycle-compared-to-linq-to-sql-data-context-life-cycle\"}",{}]}]}]},"$undefined","$undefined",true],["",{"children":["blog",{"children":[["slug","entity-framework-object-context-life-cycle-compared-to-linq-to-sql-data-context-life-cycle","d"],{"children":["__PAGE__",{},[["$L1","$L2",[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/be8a59717d6d5849.css","precedence":"next","crossOrigin":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/css/97e0a79122e618e4.css","precedence":"next","crossOrigin":"$undefined"}]]],null],null]},[null,["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","$4","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]],null]},[[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/dabd5e64a469b0e1.css","precedence":"next","crossOrigin":"$undefined"}]],["$","div",null,{"className":"layout_blogbodystyle___Uc1w","children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]}]],null],null]},[[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/4cb872a2a77e328a.css","precedence":"next","crossOrigin":"$undefined"}]],["$","html",null,{"lang":"en","className":"layout_htmlstyle__PseMz","children":["$","body",null,{"className":"layout_bodystyle__4ncsS","children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","div",null,{"style":{"display":"flex","alignItems":"center","justifyContent":"center","height":"100vh"},"children":["$","div",null,{"style":{"width":"50%","height":"20%","backgroundColor":"#ffeded","borderRadius":12,"padding":12,"textAlign":"center"},"children":[["$","h1",null,{"children":"Not Found"}],["$","p",null,{"children":"Could not find requested resource"}],["$","$L6",null,{"href":"/","children":"Return Home"}]]}]}],"notFoundStyles":[]}]}]}]],null],null],["$L7",null]]]]
8:I[836,["156","static/chunks/156-2b9f703633e98ef7.js","836","static/chunks/836-7e37630a3372363c.js","308","static/chunks/app/blog/%5Bslug%5D/page-2829e3c199d313ca.js"],"Image"]
2:["$","div",null,{"className":"BlogBody_BlogBody__600mT","children":[["$","header",null,{"className":"BlogBody_siteTitle__f7uyb","children":"Patrick Desjardins Blog"}],["$","nav",null,{"children":["$","ul",null,{"className":"BlogBody_navLinks__ZV12t","children":["$","li",null,{"className":"BlogBody_navLinkItem__Pml2e","children":[["$","$L6",null,{"className":"BlogBody_navLinkText__ZtH2y","href":"/","children":"Main Page"}],["$","$L6",null,{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog","children":"Blog"}],["$","$L6",null,{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/search","children":"Search"}],[["$","$L6","2026",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2026","children":2026}],["$","$L6","2025",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2025","children":2025}],["$","$L6","2024",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2024","children":2024}],["$","$L6","2023",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2023","children":2023}],["$","$L6","2022",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2022","children":2022}],["$","$L6","2021",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2021","children":2021}],["$","$L6","2020",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2020","children":2020}],["$","$L6","2019",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2019","children":2019}],["$","$L6","2018",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2018","children":2018}],["$","$L6","2017",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2017","children":2017}],["$","$L6","2016",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2016","children":2016}],["$","$L6","2015",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2015","children":2015}],["$","$L6","2014",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2014","children":2014}],["$","$L6","2013",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2013","children":2013}],["$","$L6","2012",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2012","children":2012}],["$","$L6","2011",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2011","children":2011}]]]}]}]}],["$","div",null,{"className":"BlogBody_blogPictureContainer__IAbPL","children":["$","$L8",null,{"className":"BlogBody_blogTopPicture__L6lao","alt":"Patrick Desjardins picture from a conference","src":"/images/backgrounds/patrickdesjardins_conference_bw.webp","width":800,"height":260}]}],["$","main",null,{"className":"BlogBody_main__XrdKY","children":[["$","h1",null,{"className":"BlogBody_heading__bYRBe","children":"Entity Framework Object Context Life Cycle compared to Linq to Sql Data Context Life Cycle"}],["$","div",null,{"className":"Page_blogPostContainer__AUIcf","children":[["$","p",null,{"className":"Page_blogPostDate__wVWWB","children":["Posted on: ","2011-09-22"]}],[["$","h2",null,{"children":"Entity Framework Object Context"}],"\n",["$","p",null,{"children":"The object created from the Entity Model that hold all objects has a life cycle like all other objects. But, this one should catch more your attention because it can come very big with all the object's state tracking that it has to remember. Moreover, it caches values. So, I do not have to tell you that with a medium or big application that the ram memory can come very high."}],"\n",["$","p",null,{"children":[["$","code",null,{"children":"ObjectContext"}]," class inherit from ",["$","code",null,{"children":"IDisposable"}]," interface so you can, and should, use USING statement when using Entity Framework. The problem with this approach is that the object tracking is loss. So, it solves only the problem concerning the memory. If you are getting information and know that you gonna change it than is better not to use ",["$","code",null,{"children":"USING"}],", but still use .Dispose at the end. But, if you get information only or you update right away the information, it's better to use USING."]}],"\n",["$","h3",null,{"children":"States"}],"\n",["$","p",null,{"children":["Entity Framework has 5 possibles states. The first one is when new object is adding. The state is than ",["$","code",null,{"children":"Added"}],". Once saved the state of this object come to ",["$","code",null,{"children":"Unchanged"}],". When an object is deleted, its state changes to Deleted until the object context saves it to the database. It's than to ",["$","code",null,{"children":"Detached"}],". The Modified state is a little bit more tricky. When using Entity Object (Not POCO) when a scalar object is changed, the state automatically change to ",["$","code",null,{"children":"Modified"}],". For POCO, it requires to have a call to ",["$","code",null,{"children":"DetectChanges"}]," to be able to mark the object as ",["$","code",null,{"children":"Modified"}],". When an object is loaded from the object context, it's default state is unchanged."]}],"\n",["$","p",null,{"children":"Here is a complete example that show with the Northwind database and Entityframework the state change from the creating to the removing phase."}],"\n",["$","p",null,{"children":"Lets take this code that create a new Order for a Customer and then remove it."}],"\n",["$","pre",null,{"className":"language-csharp","children":["$","code",null,{"className":"language-csharp code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token class-name","children":["$","span",null,{"className":"token keyword","children":"var"}]}]," db ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token keyword","children":"new"}]," ",["$","span",null,{"className":"token constructor-invocation class-name","children":"NorthwindEntities"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," ",["$","span",null,{"className":"token comment","children":"//Add a new Order "}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token class-name","children":["$","span",null,{"className":"token keyword","children":"var"}]}]," firstCustomer ",["$","span",null,{"className":"token operator","children":"="}]," db",["$","span",null,{"className":"token punctuation","children":"."}],"Customers",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"First"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["Debug",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"WriteLine"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"---Customer loaded---\""}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["Debug",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"WriteLine"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"FirstCustomer:\""}]," ",["$","span",null,{"className":"token operator","children":"+"}]," db",["$","span",null,{"className":"token punctuation","children":"."}],"ObjectStateManager",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"GetObjectStateEntry"}],["$","span",null,{"className":"token punctuation","children":"("}],"firstCustomer",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"."}],"State",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token class-name","children":["$","span",null,{"className":"token keyword","children":"var"}]}]," newOrder ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token keyword","children":"new"}]," ",["$","span",null,{"className":"token constructor-invocation class-name","children":"Orders"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," ",["$","span",null,{"className":"token comment","children":"// db.CreateObject<Orders>(); would do the samething "}],"\n"]}],["$","span",null,{"className":"code-line","children":["Debug",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"WriteLine"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"---Orders Created---\""}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["Debug",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"WriteLine"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"FirstCustomer:\""}]," ",["$","span",null,{"className":"token operator","children":"+"}]," db",["$","span",null,{"className":"token punctuation","children":"."}],"ObjectStateManager",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"GetObjectStateEntry"}],["$","span",null,{"className":"token punctuation","children":"("}],"firstCustomer",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"."}],"State",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["Debug",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"WriteLine"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"newOrder: N/A because not yet inside the ObjectContext so not state yet. Could attach before adding to get state but not applicable now because the key is generated by the db and can't attack without key.\""}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["Debug",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"WriteLine"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"newOrder:\""}]," ",["$","span",null,{"className":"token operator","children":"+"}]," db",["$","span",null,{"className":"token punctuation","children":"."}],"ObjectStateManager",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"GetObjectStateEntry"}],["$","span",null,{"className":"token punctuation","children":"("}],"newOrder",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"."}],"State",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["firstCustomer",["$","span",null,{"className":"token punctuation","children":"."}],"Orders",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"Add"}],["$","span",null,{"className":"token punctuation","children":"("}],"newOrder",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["Debug",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"WriteLine"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"---Orders added---\""}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["Debug",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"WriteLine"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"FirstCustomer:\""}]," ",["$","span",null,{"className":"token operator","children":"+"}]," db",["$","span",null,{"className":"token punctuation","children":"."}],"ObjectStateManager",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"GetObjectStateEntry"}],["$","span",null,{"className":"token punctuation","children":"("}],"firstCustomer",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"."}],"State",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["Debug",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"WriteLine"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"newOrder:\""}]," ",["$","span",null,{"className":"token operator","children":"+"}]," db",["$","span",null,{"className":"token punctuation","children":"."}],"ObjectStateManager",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"GetObjectStateEntry"}],["$","span",null,{"className":"token punctuation","children":"("}],"newOrder",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"."}],"State",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," db",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"SaveChanges"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["Debug",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"WriteLine"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"---Object Context save---\""}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["Debug",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"WriteLine"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"FirstCustomer:\""}]," ",["$","span",null,{"className":"token operator","children":"+"}]," db",["$","span",null,{"className":"token punctuation","children":"."}],"ObjectStateManager",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"GetObjectStateEntry"}],["$","span",null,{"className":"token punctuation","children":"("}],"firstCustomer",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"."}],"State",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["Debug",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"WriteLine"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"newOrder:\""}]," ",["$","span",null,{"className":"token operator","children":"+"}]," db",["$","span",null,{"className":"token punctuation","children":"."}],"ObjectStateManager",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"GetObjectStateEntry"}],["$","span",null,{"className":"token punctuation","children":"("}],"newOrder",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"."}],"State",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["Debug",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"WriteLine"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"---Remove the created object---\""}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["firstCustomer",["$","span",null,{"className":"token punctuation","children":"."}],"Orders",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"Remove"}],["$","span",null,{"className":"token punctuation","children":"("}],"newOrder",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["Debug",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"WriteLine"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"FirstCustomer:\""}]," ",["$","span",null,{"className":"token operator","children":"+"}]," db",["$","span",null,{"className":"token punctuation","children":"."}],"ObjectStateManager",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"GetObjectStateEntry"}],["$","span",null,{"className":"token punctuation","children":"("}],"firstCustomer",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"."}],"State",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["Debug",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"WriteLine"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"newOrder:\""}]," ",["$","span",null,{"className":"token operator","children":"+"}]," db",["$","span",null,{"className":"token punctuation","children":"."}],"ObjectStateManager",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"GetObjectStateEntry"}],["$","span",null,{"className":"token punctuation","children":"("}],"newOrder",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"."}],"State",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["db",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"SaveChanges"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," Debug",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"WriteLine"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"---Object Context save---\""}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["Debug",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"WriteLine"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"FirstCustomer:\""}]," ",["$","span",null,{"className":"token operator","children":"+"}]," db",["$","span",null,{"className":"token punctuation","children":"."}],"ObjectStateManager",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"GetObjectStateEntry"}],["$","span",null,{"className":"token punctuation","children":"("}],"firstCustomer",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"."}],"State",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["Debug",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"WriteLine"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"newOrder:\""}]," ",["$","span",null,{"className":"token operator","children":"+"}]," db",["$","span",null,{"className":"token punctuation","children":"."}],"ObjectStateManager",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"GetObjectStateEntry"}],["$","span",null,{"className":"token punctuation","children":"("}],"newOrder",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"."}],"State",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}]]}]}],"\n",["$","p",null,{"children":"The output of this code is:"}],"\n",["$","pre",null,{"className":"language-plaintext","children":["$","code",null,{"className":"language-plaintext code-highlight","children":[["$","span",null,{"className":"code-line","children":"---Customer loaded--- \n"}],["$","span",null,{"className":"code-line","children":"FirstCustomer:Unchanged \n"}],["$","span",null,{"className":"code-line","children":"---Orders Created--- \n"}],["$","span",null,{"className":"code-line","children":"FirstCustomer:Unchanged newOrder: N/A because not yet inside the ObjectContext so not state yet. Could attach before adding to get state \n"}],["$","span",null,{"className":"code-line","children":"---Orders added--- \n"}],["$","span",null,{"className":"code-line","children":"FirstCustomer:Unchanged newOrder:Added \n"}],["$","span",null,{"className":"code-line","children":"---Object Context save--- \n"}],["$","span",null,{"className":"code-line","children":"FirstCustomer:Unchanged newOrder:Unchanged \n"}],["$","span",null,{"className":"code-line","children":"---Remove the created object--- \n"}],["$","span",null,{"className":"code-line","children":"FirstCustomer:Unchanged newOrder:Modified \n"}],["$","span",null,{"className":"code-line","children":"---Object Context save--- \n"}],["$","span",null,{"className":"code-line","children":"FirstCustomer:Unchanged newOrder:Unchanged \n"}]]}]}],"\n",["$","p",null,{"children":"We could also explore the state with the event."}],"\n",["$","pre",null,{"className":"language-csharp","children":["$","code",null,{"className":"language-csharp code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token class-name","children":["$","span",null,{"className":"token keyword","children":"var"}]}]," db ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token keyword","children":"new"}]," ",["$","span",null,{"className":"token constructor-invocation class-name","children":"NorthwindEntities"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["db",["$","span",null,{"className":"token punctuation","children":"."}],"ObjectStateManager",["$","span",null,{"className":"token punctuation","children":"."}],"ObjectStateManagerChanged ",["$","span",null,{"className":"token operator","children":"+="}]," ",["$","span",null,{"className":"token keyword","children":"new"}]," ",["$","span",null,{"className":"token constructor-invocation class-name","children":["System",["$","span",null,{"className":"token punctuation","children":"."}],"ComponentModel",["$","span",null,{"className":"token punctuation","children":"."}],"CollectionChangeEventHandler"]}],["$","span",null,{"className":"token punctuation","children":"("}],"ObjectStateManager_ObjectStateManagerChanged",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," ",["$","span",null,{"className":"token comment","children":"//Get existing Customer that has Order "}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token class-name","children":["$","span",null,{"className":"token keyword","children":"var"}]}]," customersWithOrder ",["$","span",null,{"className":"token operator","children":"="}]," db",["$","span",null,{"className":"token punctuation","children":"."}],"Customers",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"Where"}],["$","span",null,{"className":"token punctuation","children":"("}],"customer ",["$","span",null,{"className":"token operator","children":"=>"}]," customer",["$","span",null,{"className":"token punctuation","children":"."}],"Orders",["$","span",null,{"className":"token punctuation","children":"."}],"Count",["$","span",null,{"className":"token operator","children":">"}],["$","span",null,{"className":"token number","children":"15"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," ",["$","span",null,{"className":"token comment","children":"//Add a new Order "}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token class-name","children":["$","span",null,{"className":"token keyword","children":"var"}]}]," firstCustomer ",["$","span",null,{"className":"token operator","children":"="}]," db",["$","span",null,{"className":"token punctuation","children":"."}],"Customers",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"First"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token class-name","children":["$","span",null,{"className":"token keyword","children":"var"}]}]," newOrder ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token keyword","children":"new"}]," ",["$","span",null,{"className":"token constructor-invocation class-name","children":"Orders"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," ",["$","span",null,{"className":"token comment","children":"// db.CreateObject<Orders>(); would do the samething "}],"\n"]}],["$","span",null,{"className":"code-line","children":["firstCustomer",["$","span",null,{"className":"token punctuation","children":"."}],"Orders",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"Add"}],["$","span",null,{"className":"token punctuation","children":"("}],"newOrder",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["db",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"SaveChanges"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["firstCustomer",["$","span",null,{"className":"token punctuation","children":"."}],"Orders",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"Remove"}],["$","span",null,{"className":"token punctuation","children":"("}],"newOrder",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["db",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"DeleteObject"}],["$","span",null,{"className":"token punctuation","children":"("}],"newOrder",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}],["$","span",null,{"className":"code-line","children":["db",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"SaveChanges"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}]," \n"]}]]}]}],"\n",["$","p",null,{"children":"This produce:"}],"\n",["$","pre",null,{"className":"language-plaintext","children":["$","code",null,{"className":"language-plaintext code-highlight","children":[["$","span",null,{"className":"code-line","children":"-->LifeCycle.Customers-->Add \n"}],["$","span",null,{"className":"code-line","children":"-->LifeCycle.Orders-->Add \n"}],["$","span",null,{"className":"code-line","children":"-->LifeCycle.Orders-->Add \n"}],["$","span",null,{"className":"code-line","children":"-->LifeCycle.Orders-->Add \n"}],["$","span",null,{"className":"code-line","children":"-->LifeCycle.Orders-->Add \n"}],["$","span",null,{"className":"code-line","children":"-->LifeCycle.Orders-->Add \n"}],["$","span",null,{"className":"code-line","children":"-->LifeCycle.Orders-->Add \n"}],["$","span",null,{"className":"code-line","children":"-->LifeCycle.Orders-->Add \n"}],["$","span",null,{"className":"code-line","children":"-->LifeCycle.Orders-->Add \n"}],["$","span",null,{"className":"code-line","children":"-->LifeCycle.Orders-->Remove\n"}],["$","span",null,{"className":"code-line","children":"-->LifeCycle.Orders-->Remove \n"}]]}]}],"\n",["$","p",null,{"children":"I prefer the first output because it's more clear."}],"\n",["$","h3",null,{"children":"Thread"}],"\n",["$","p",null,{"children":"The ObjectContext class is not tread safe. You must have one object context per thread or to create you own thread synchronization process."}],"\n",["$","h2",null,{"children":"Linq to Sql Data Context"}],"\n",["$","p",null,{"children":["As the ObjectContext, the DataContext class hold the track of each object state. It knows what has been modified, deleted or added. Also, Linq to Sql uses state even if nothing has changed to the object. When loaded, the object will be ",["$","code",null,{"children":"Unchanged"}]," or if you create a new object or deserialize an object, it will be a ",["$","code",null,{"children":"Untracked"}],"."]}],"\n",["$","p",null,{"children":["When an object is attached, by default its state will be ",["$","code",null,{"children":"PossiblyModified"}]," and this is until the ",["$","code",null,{"children":"SubmitChange"}],". The next three states are very common ",["$","code",null,{"children":"ToBeInserted"}],", ",["$","code",null,{"children":"ToBeModified"}],", ",["$","code",null,{"children":"ToBeDeleted"}],". The last possible state is when an object has been ",["$","code",null,{"children":"SumbitChange"}]," when it was ",["$","code",null,{"children":"ToBeDeleted"}],". When this happen, the object is still in the DataContext but with the ",["$","code",null,{"children":"Deleted"}]," state."]}],"\n",["$","h3",null,{"children":"Thread"}],"\n",["$","p",null,{"children":"The Linq to Sql DataContext class is not thread safe. It should not be static, neither"}],"\n",["$","h2",null,{"children":"Where and when should EF or Linq2Sql live?"}],"\n",["$","p",null,{"children":[["$","a",null,{"href":"http://blogs.msdn.com/b/mattwar/archive/2004/03/05/about-me.aspx","children":"Matt Warren"}],", software achitect at Microsoft on the C# programming language product team and member of the team that created LINQ to SQL ",["$","a",null,{"href":"http://social.msdn.microsoft.com/forums/en-US/linqprojectgeneral/thread/3ae5e457-099e-4d13-9a8b-df3ed4ba0bab/","children":"explains"}]," this question with a design pattern. Theses ORM should be treated as the ",["$","a",null,{"href":"http://martinfowler.com/eaaCatalog/unitOfWork.html","children":"Unit of Work pattern"}],"."]}],"\n",["$","blockquote",null,{"children":["\n",["$","p",null,{"children":"A Unit of Work keeps track of everything you do during a business transaction that can affect the database. When you're done, it figures out everything that needs to be done to alter the database as a result of your work."}],"\n"]}],"\n",["$","p",null,{"children":"That's it. The ORM object should live until the business task is done. For example, you need to edit a employee, you create the object when loading it, it's alive until it's saved or the task is cancelled. It does not remain until the application close in the memory."}]]]}]]}],["$","div",null,{"className":"BlogBody_paginationBar__1gsMc","children":[["$","div",null,{"className":"BlogBody_paginationTitle__H_eFX","children":"Chronological Blog Articles by Page"}],["$","div",null,{"className":"BlogBody_paginationLinks__nk8zd","children":[["$","$L6","1",{"className":"","href":"/blog/page/1","children":1}],["$","$L6","2",{"className":"","href":"/blog/page/2","children":2}],["$","$L6","3",{"className":"","href":"/blog/page/3","children":3}],["$","$L6","4",{"className":"","href":"/blog/page/4","children":4}],["$","$L6","5",{"className":"","href":"/blog/page/5","children":5}],["$","$L6","6",{"className":"","href":"/blog/page/6","children":6}],["$","$L6","7",{"className":"","href":"/blog/page/7","children":7}],["$","$L6","8",{"className":"","href":"/blog/page/8","children":8}],["$","$L6","9",{"className":"","href":"/blog/page/9","children":9}],["$","$L6","10",{"className":"","href":"/blog/page/10","children":10}],["$","$L6","11",{"className":"","href":"/blog/page/11","children":11}],["$","$L6","12",{"className":"","href":"/blog/page/12","children":12}],["$","$L6","13",{"className":"","href":"/blog/page/13","children":13}],["$","$L6","14",{"className":"","href":"/blog/page/14","children":14}],["$","$L6","15",{"className":"","href":"/blog/page/15","children":15}],["$","$L6","16",{"className":"","href":"/blog/page/16","children":16}],["$","$L6","17",{"className":"","href":"/blog/page/17","children":17}],["$","$L6","18",{"className":"","href":"/blog/page/18","children":18}],["$","$L6","19",{"className":"","href":"/blog/page/19","children":19}],["$","$L6","20",{"className":"","href":"/blog/page/20","children":20}],["$","$L6","21",{"className":"","href":"/blog/page/21","children":21}],["$","$L6","22",{"className":"","href":"/blog/page/22","children":22}],["$","$L6","23",{"className":"","href":"/blog/page/23","children":23}],["$","$L6","24",{"className":"","href":"/blog/page/24","children":24}],["$","$L6","25",{"className":"","href":"/blog/page/25","children":25}],["$","$L6","26",{"className":"","href":"/blog/page/26","children":26}],["$","$L6","27",{"className":"","href":"/blog/page/27","children":27}],["$","$L6","28",{"className":"","href":"/blog/page/28","children":28}],["$","$L6","29",{"className":"","href":"/blog/page/29","children":29}],["$","$L6","30",{"className":"","href":"/blog/page/30","children":30}],["$","$L6","31",{"className":"","href":"/blog/page/31","children":31}],["$","$L6","32",{"className":"","href":"/blog/page/32","children":32}],["$","$L6","33",{"className":"","href":"/blog/page/33","children":33}],["$","$L6","34",{"className":"","href":"/blog/page/34","children":34}],["$","$L6","35",{"className":"","href":"/blog/page/35","children":35}],["$","$L6","36",{"className":"","href":"/blog/page/36","children":36}],["$","$L6","37",{"className":"","href":"/blog/page/37","children":37}],["$","$L6","38",{"className":"","href":"/blog/page/38","children":38}],["$","$L6","39",{"className":"","href":"/blog/page/39","children":39}],["$","$L6","40",{"className":"","href":"/blog/page/40","children":40}],["$","$L6","41",{"className":"","href":"/blog/page/41","children":41}],["$","$L6","42",{"className":"","href":"/blog/page/42","children":42}],["$","$L6","43",{"className":"","href":"/blog/page/43","children":43}],["$","$L6","44",{"className":"","href":"/blog/page/44","children":44}],["$","$L6","45",{"className":"","href":"/blog/page/45","children":45}],["$","$L6","46",{"className":"","href":"/blog/page/46","children":46}],["$","$L6","47",{"className":"","href":"/blog/page/47","children":47}],["$","$L6","48",{"className":"","href":"/blog/page/48","children":48}],["$","$L6","49",{"className":"","href":"/blog/page/49","children":49}],["$","$L6","50",{"className":"","href":"/blog/page/50","children":50}],["$","$L6","51",{"className":"","href":"/blog/page/51","children":51}],["$","$L6","52",{"className":"","href":"/blog/page/52","children":52}],["$","$L6","53",{"className":"","href":"/blog/page/53","children":53}],["$","$L6","54",{"className":"","href":"/blog/page/54","children":54}],["$","$L6","55",{"className":"","href":"/blog/page/55","children":55}],["$","$L6","56",{"className":"","href":"/blog/page/56","children":56}],["$","$L6","57",{"className":"","href":"/blog/page/57","children":57}],["$","$L6","58",{"className":"","href":"/blog/page/58","children":58}],["$","$L6","59",{"className":"","href":"/blog/page/59","children":59}],["$","$L6","60",{"className":"","href":"/blog/page/60","children":60}],["$","$L6","61",{"className":"","href":"/blog/page/61","children":61}],["$","$L6","62",{"className":"","href":"/blog/page/62","children":62}],["$","$L6","63",{"className":"","href":"/blog/page/63","children":63}],["$","$L6","64",{"className":"","href":"/blog/page/64","children":64}],["$","$L6","65",{"className":"","href":"/blog/page/65","children":65}],["$","$L6","66",{"className":"","href":"/blog/page/66","children":66}],["$","$L6","67",{"className":"","href":"/blog/page/67","children":67}],["$","$L6","68",{"className":"","href":"/blog/page/68","children":68}],["$","$L6","69",{"className":"","href":"/blog/page/69","children":69}],["$","$L6","70",{"className":"","href":"/blog/page/70","children":70}],["$","$L6","71",{"className":"","href":"/blog/page/71","children":71}],["$","$L6","72",{"className":"","href":"/blog/page/72","children":72}],["$","$L6","73",{"className":"","href":"/blog/page/73","children":73}],["$","$L6","74",{"className":"","href":"/blog/page/74","children":74}],["$","$L6","75",{"className":"","href":"/blog/page/75","children":75}],["$","$L6","76",{"className":"","href":"/blog/page/76","children":76}],["$","$L6","77",{"className":"","href":"/blog/page/77","children":77}],["$","$L6","78",{"className":"","href":"/blog/page/78","children":78}],["$","$L6","79",{"className":"","href":"/blog/page/79","children":79}],["$","$L6","80",{"className":"","href":"/blog/page/80","children":80}],["$","$L6","81",{"className":"","href":"/blog/page/81","children":81}]]}]]}],null]}]
7:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"Patrick Desjardins Blog - Entity Framework Object Context Life Cycle compared to Linq to Sql Data Context Life Cycle"}],["$","meta","3",{"name":"description","content":"Entity Framework Object Context Life Cycle compared to Linq to Sql Data Context Life Cycle"}]]
1:null

<!DOCTYPE html><html lang="en" class="layout_htmlstyle__PseMz"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/4cb872a2a77e328a.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/dabd5e64a469b0e1.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/be8a59717d6d5849.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/97e0a79122e618e4.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-3bbba27772baeadb.js"/><script src="/_next/static/chunks/2200cc46-73d9c2dcf2e9794f.js" async=""></script><script src="/_next/static/chunks/657-3551bff086733983.js" async=""></script><script src="/_next/static/chunks/main-app-67ffb56f87b9fb11.js" async=""></script><script src="/_next/static/chunks/156-2b9f703633e98ef7.js" async=""></script><script src="/_next/static/chunks/836-7e37630a3372363c.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-2829e3c199d313ca.js" async=""></script><title>Patrick Desjardins Blog - How to use mpsc::unbounded to share data between Rust threads</title><meta name="description" content="How to use mpsc::unbounded to share data between Rust threads"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="layout_bodystyle__4ncsS"><div class="layout_blogbodystyle___Uc1w"><div class="BlogBody_BlogBody__600mT"><header class="BlogBody_siteTitle__f7uyb">Patrick Desjardins Blog</header><nav><ul class="BlogBody_navLinks__ZV12t"><li class="BlogBody_navLinkItem__Pml2e"><a class="BlogBody_navLinkText__ZtH2y" href="/">Main Page</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog">Blog</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/search">Search</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2026">2026</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2025">2025</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2024">2024</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2023">2023</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2022">2022</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2021">2021</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2020">2020</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2019">2019</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2018">2018</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2017">2017</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2016">2016</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2015">2015</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2014">2014</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2013">2013</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2012">2012</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2011">2011</a></li></ul></nav><div class="BlogBody_blogPictureContainer__IAbPL"><img alt="Patrick Desjardins picture from a conference" loading="lazy" width="800" height="260" decoding="async" data-nimg="1" class="BlogBody_blogTopPicture__L6lao" style="color:transparent" src="/images/backgrounds/patrickdesjardins_conference_bw.webp"/></div><main class="BlogBody_main__XrdKY"><h1 class="BlogBody_heading__bYRBe">How to use mpsc::unbounded to share data between Rust threads</h1><div class="Page_blogPostContainer__AUIcf"><p class="Page_blogPostDate__wVWWB">Posted on: <!-- -->2022-11-26</p><p>Moving information between threads is always a delicate task. This is because so many issues can occur, and Rust is built around safety; hence it has a safe way to send information between two threads.</p>
<p>One way is to rely on the <code>futures</code> crate and use a <code>unbounded</code>. The documentation is fuzzy around how to use the <code>future::mpsc::unbounded,</code> and I&#x27;ll try to provide an easy example to grasp the whole idea.</p>
<p>First, before getting too deep with <code>future::mpsc::unbounded</code>, know that there is also <code>future::mpsc::channel</code>. Channel is similar but is for <em>bounded</em> communication. The <em>bounded</em> has a single channel per sender, while the <code>future::mpsc::unbounded</code> has a single channel for every sender. The example uses the <code>future::mpsc::unbounded</code> with an internal buffer in case the receiver is not fetching the data fast enough.</p>
<h1>Main Loop Function</h1>
<p>The example consists of three functions. The first one, the main one, is the entry one that will spawn two threads.</p>
<pre class="language-rust"><code class="language-rust code-highlight"><span class="code-line"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">let</span> <span class="token punctuation">(</span>broker_sender<span class="token punctuation">,</span> broker_receiver<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token namespace">mpsc<span class="token punctuation">::</span></span><span class="token function">unbounded</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token namespace">task<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token function">receive_loop</span><span class="token punctuation">(</span>broker_receiver<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token namespace">task<span class="token punctuation">::</span></span><span class="token function">block_on</span><span class="token punctuation">(</span><span class="token function">send_loop</span><span class="token punctuation">(</span>broker_sender<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">```
</span><span class="code-line">
</span><span class="code-line"><span class="token class-name">The</span> <span class="token keyword">loop</span> uses `<span class="token namespace">task<span class="token punctuation">::</span></span>spawn` that starts a thread without blocking the execution of the `main` function and starting the `receive_loop` function into a separate thread<span class="token punctuation">.</span> <span class="token class-name">It</span> allows getting into the second line that blocks the `main` function to keep the program running <span class="token keyword">while</span> also running a second function<span class="token punctuation">,</span> `send_loop` to run into another thread<span class="token punctuation">.</span> 
</span><span class="code-line">
</span><span class="code-line"><span class="token class-name">The</span> `<span class="token namespace">mpsc<span class="token punctuation">::</span></span><span class="token function">unbounded</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span>` create a sender and receiver that can be shared between the two threads<span class="token punctuation">.</span>
</span><span class="code-line">
</span><span class="code-line"># send_loop <span class="token class-name">Function</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token class-name">The</span> send <span class="token keyword">loop</span> is a function that takes the user input from the command line and adds the value into the `broker_sender` that gets the string into the `<span class="token namespace">mpsc<span class="token punctuation">::</span></span>unbounded` to have the `receive_loop` read it later<span class="token punctuation">.</span> 
</span><span class="code-line">
</span><span class="code-line">````rust
</span><span class="code-line"><span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">send_loop</span><span class="token punctuation">(</span><span class="token keyword">mut</span> broker<span class="token punctuation">:</span> <span class="token namespace">mpsc<span class="token punctuation">::</span></span><span class="token class-name">UnboundedSender</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">loop</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">let</span> <span class="token keyword">mut</span> user_input <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">&quot;&gt; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token namespace">io<span class="token punctuation">::</span></span><span class="token function">stdout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token namespace">io<span class="token punctuation">::</span></span><span class="token function">stdin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">read_line</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> user_input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">let</span> user_input_clean <span class="token operator">=</span> user_input<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        broker<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>user_input_clean<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">await</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">```
</span><span class="code-line">
</span><span class="code-line"><span class="token class-name">The</span> function has an infinite <span class="token keyword">loop</span><span class="token punctuation">,</span> waiting <span class="token keyword">for</span> the user<span class="token lifetime-annotation symbol">&#x27;s</span> inputs<span class="token punctuation">.</span> <span class="token class-name">Then</span><span class="token punctuation">,</span> it waits to read the `stdin`<span class="token punctuation">,</span> which takes the user line that is all the characters until the enter key is pressed<span class="token punctuation">.</span> <span class="token class-name">Finally</span><span class="token punctuation">,</span> the last line gets the `<span class="token namespace">mpsc<span class="token punctuation">::</span></span><span class="token class-name">UnboundedSender</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span>` and `send` the `<span class="token class-name">String</span>` using `<span class="token keyword">await</span><span class="token punctuation">.</span>unwrap`<span class="token punctuation">,</span> which asynchronously puts the value into the communication pipeline<span class="token punctuation">.</span> <span class="token class-name">It</span> still needs to be consumed<span class="token punctuation">.</span>
</span><span class="code-line">
</span><span class="code-line"># receive_loop <span class="token class-name">Function</span>
</span><span class="code-line"><span class="token class-name">The</span> last step is the receiving function<span class="token punctuation">.</span>
</span><span class="code-line">
</span><span class="code-line">````rust
</span><span class="code-line"><span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">receive_loop</span><span class="token punctuation">(</span><span class="token keyword">mut</span> broker<span class="token punctuation">:</span> <span class="token namespace">mpsc<span class="token punctuation">::</span></span><span class="token class-name">UnboundedReceiver</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">let</span> ten_millis <span class="token operator">=</span> <span class="token namespace">time<span class="token punctuation">::</span></span><span class="token class-name">Duration</span><span class="token punctuation">::</span><span class="token function">from_millis</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">loop</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token class-name">Ok</span><span class="token punctuation">(</span>wrapper_msg<span class="token punctuation">)</span> <span class="token operator">=</span> broker<span class="token punctuation">.</span><span class="token function">try_next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;New message: {}&quot;</span><span class="token punctuation">,</span> wrapper_msg<span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token punctuation">}</span>
</span><span class="code-line">        <span class="token namespace">thread<span class="token punctuation">::</span></span><span class="token function">sleep</span><span class="token punctuation">(</span>ten_millis<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">```
</span><span class="code-line">
</span><span class="code-line"><span class="token class-name">The</span> function also has an infinite <span class="token keyword">loop</span><span class="token punctuation">.</span> <span class="token class-name">It</span> reads the `<span class="token namespace">mpsc<span class="token punctuation">::</span></span><span class="token class-name">UnboundedReceiver</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span>` <span class="token keyword">where</span> the value is sitting from the previous function<span class="token punctuation">.</span> <span class="token class-name">The</span> code above takes the value by calling `try_next`<span class="token punctuation">,</span> which returns a `<span class="token class-name">Result</span>`<span class="token punctuation">.</span> <span class="token class-name">The</span> function does not look <span class="token keyword">for</span> the `<span class="token class-name">Err</span>` path because the `try_next` spams an error anytime the `<span class="token namespace">mpsc<span class="token punctuation">::</span></span><span class="token class-name">UnboundedReceiver</span>` is empty<span class="token punctuation">.</span> <span class="token class-name">However</span><span class="token punctuation">,</span> when data is ready to be read<span class="token punctuation">,</span> the value goes into the `wrapper_msg`<span class="token punctuation">,</span> an `<span class="token class-name">Option</span>` <span class="token keyword">type</span><span class="token punctuation">.</span> <span class="token class-name">Hence</span><span class="token punctuation">,</span> the `unwrap` is called to read the string<span class="token punctuation">.</span>
</span><span class="code-line">
</span><span class="code-line"># <span class="token class-name">Conclusion</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token class-name">A</span> <span class="token keyword">final</span> observation is that the `<span class="token namespace">mpsc<span class="token punctuation">::</span></span><span class="token class-name">UnboundedSender</span>` and `<span class="token namespace">mpsc<span class="token punctuation">::</span></span><span class="token class-name">UnboundedReceiver</span>` shared between the two functions required to be mutable<span class="token punctuation">.</span> <span class="token class-name">You</span> can see the `<span class="token keyword">mut</span>` <span class="token keyword">in</span> both parameters<span class="token punctuation">.</span> <span class="token class-name">Without</span> the `<span class="token keyword">mut</span>`<span class="token punctuation">,</span> the code throws a compilation error<span class="token punctuation">:</span>
</span><span class="code-line">
</span><span class="code-line">```
</span><span class="code-line">cannot borrow `broker` <span class="token keyword">as</span> mutable<span class="token punctuation">,</span> <span class="token keyword">as</span> it is not declared <span class="token keyword">as</span> mutable
</span><span class="code-line">cannot borrow <span class="token keyword">as</span> mutable
</span><span class="code-line">```
</span><span class="code-line">
</span><span class="code-line"><span class="token class-name">The</span> reason seems to be that the `try_next` has a `<span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span>`  <span class="token keyword">in</span> its <span class="token punctuation">[</span>definition<span class="token punctuation">]</span><span class="token punctuation">(</span>https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>docs<span class="token punctuation">.</span>rs<span class="token operator">/</span>futures<span class="token operator">-</span>channel<span class="token operator">/</span><span class="token number">0.3</span><span class="token punctuation">.</span><span class="token number">25</span><span class="token operator">/</span>src<span class="token operator">/</span>futures_channel<span class="token operator">/</span>mpsc<span class="token operator">/</span><span class="token keyword">mod</span><span class="token punctuation">.</span>rs<span class="token punctuation">.</span>html#<span class="token number">1131</span><span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token class-name">From</span> my limited knowledge of <span class="token class-name">Rust</span><span class="token punctuation">,</span> the reason of why the `try_next` seems to be that at the end<span class="token punctuation">,</span> it has a queue <span class="token keyword">where</span> it needs to change its <span class="token function">value</span> <span class="token punctuation">(</span>mutate<span class="token punctuation">)</span> with the <span class="token punctuation">[</span>unpark_one<span class="token punctuation">]</span><span class="token punctuation">(</span>https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>docs<span class="token punctuation">.</span>rs<span class="token operator">/</span>futures<span class="token operator">-</span>channel<span class="token operator">/</span><span class="token number">0.3</span><span class="token punctuation">.</span><span class="token number">25</span><span class="token operator">/</span>src<span class="token operator">/</span>futures_channel<span class="token operator">/</span>mpsc<span class="token operator">/</span><span class="token keyword">mod</span><span class="token punctuation">.</span>rs<span class="token punctuation">.</span>html#<span class="token number">1031</span><span class="token punctuation">)</span><span class="token punctuation">.</span> 
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token class-name">There</span> is a very low amount of examples on the <span class="token class-name">Internet</span> using the `<span class="token namespace">mpsc<span class="token punctuation">::</span></span>unbounded`<span class="token punctuation">.</span> <span class="token class-name">I</span> hope these small examples gave you help on how to <span class="token keyword">use</span> <span class="token class-name">Rust</span> <span class="token class-name">Future</span> mpsc to pass information between threads<span class="token punctuation">.</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token class-name">The</span> code <span class="token keyword">in</span> this article relies on these two dependencies<span class="token punctuation">:</span>
</span><span class="code-line">
</span><span class="code-line">```
</span><span class="code-line">futures <span class="token operator">=</span> <span class="token string">&quot;0.3.25&quot;</span>
</span><span class="code-line"><span class="token keyword">async</span><span class="token operator">-</span>std <span class="token operator">=</span> <span class="token string">&quot;1.12.0&quot;</span>
</span><span class="code-line">```
</span></code></pre></div></main><div class="BlogBody_paginationBar__1gsMc"><div class="BlogBody_paginationTitle__H_eFX">Chronological Blog Articles by Page</div><div class="BlogBody_paginationLinks__nk8zd"><a class="" href="/blog/page/1">1</a><a class="" href="/blog/page/2">2</a><a class="" href="/blog/page/3">3</a><a class="" href="/blog/page/4">4</a><a class="" href="/blog/page/5">5</a><a class="" href="/blog/page/6">6</a><a class="" href="/blog/page/7">7</a><a class="" href="/blog/page/8">8</a><a class="" href="/blog/page/9">9</a><a class="" href="/blog/page/10">10</a><a class="" href="/blog/page/11">11</a><a class="" href="/blog/page/12">12</a><a class="" href="/blog/page/13">13</a><a class="" href="/blog/page/14">14</a><a class="" href="/blog/page/15">15</a><a class="" href="/blog/page/16">16</a><a class="" href="/blog/page/17">17</a><a class="" href="/blog/page/18">18</a><a class="" href="/blog/page/19">19</a><a class="" href="/blog/page/20">20</a><a class="" href="/blog/page/21">21</a><a class="" href="/blog/page/22">22</a><a class="" href="/blog/page/23">23</a><a class="" href="/blog/page/24">24</a><a class="" href="/blog/page/25">25</a><a class="" href="/blog/page/26">26</a><a class="" href="/blog/page/27">27</a><a class="" href="/blog/page/28">28</a><a class="" href="/blog/page/29">29</a><a class="" href="/blog/page/30">30</a><a class="" href="/blog/page/31">31</a><a class="" href="/blog/page/32">32</a><a class="" href="/blog/page/33">33</a><a class="" href="/blog/page/34">34</a><a class="" href="/blog/page/35">35</a><a class="" href="/blog/page/36">36</a><a class="" href="/blog/page/37">37</a><a class="" href="/blog/page/38">38</a><a class="" href="/blog/page/39">39</a><a class="" href="/blog/page/40">40</a><a class="" href="/blog/page/41">41</a><a class="" href="/blog/page/42">42</a><a class="" href="/blog/page/43">43</a><a class="" href="/blog/page/44">44</a><a class="" href="/blog/page/45">45</a><a class="" href="/blog/page/46">46</a><a class="" href="/blog/page/47">47</a><a class="" href="/blog/page/48">48</a><a class="" href="/blog/page/49">49</a><a class="" href="/blog/page/50">50</a><a class="" href="/blog/page/51">51</a><a class="" href="/blog/page/52">52</a><a class="" href="/blog/page/53">53</a><a class="" href="/blog/page/54">54</a><a class="" href="/blog/page/55">55</a><a class="" href="/blog/page/56">56</a><a class="" href="/blog/page/57">57</a><a class="" href="/blog/page/58">58</a><a class="" href="/blog/page/59">59</a><a class="" href="/blog/page/60">60</a><a class="" href="/blog/page/61">61</a><a class="" href="/blog/page/62">62</a><a class="" href="/blog/page/63">63</a><a class="" href="/blog/page/64">64</a><a class="" href="/blog/page/65">65</a><a class="" href="/blog/page/66">66</a><a class="" href="/blog/page/67">67</a><a class="" href="/blog/page/68">68</a><a class="" href="/blog/page/69">69</a><a class="" href="/blog/page/70">70</a><a class="" href="/blog/page/71">71</a><a class="" href="/blog/page/72">72</a><a class="" href="/blog/page/73">73</a><a class="" href="/blog/page/74">74</a><a class="" href="/blog/page/75">75</a><a class="" href="/blog/page/76">76</a><a class="" href="/blog/page/77">77</a><a class="" href="/blog/page/78">78</a><a class="" href="/blog/page/79">79</a><a class="" href="/blog/page/80">80</a><a class="" href="/blog/page/81">81</a></div></div></div></div><script src="/_next/static/chunks/webpack-3bbba27772baeadb.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/4cb872a2a77e328a.css\",\"style\"]\n2:HL[\"/_next/static/css/dabd5e64a469b0e1.css\",\"style\"]\n3:HL[\"/_next/static/css/be8a59717d6d5849.css\",\"style\"]\n4:HL[\"/_next/static/css/97e0a79122e618e4.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"5:I[1200,[],\"\"]\n8:I[6405,[],\"\"]\na:I[5337,[],\"\"]\nb:I[156,[\"156\",\"static/chunks/156-2b9f703633e98ef7.js\",\"836\",\"static/chunks/836-7e37630a3372363c.js\",\"308\",\"static/chunks/app/blog/%5Bslug%5D/page-2829e3c199d313ca.js\"],\"\"]\nd:I[4688,[],\"\"]\n9:[\"slug\",\"rust-how-to-use-mpsc-unbounded-to-share-data-between-rust-threads\",\"d\"]\ne:[]\n"])</script><script>self.__next_f.push([1,"0:[\"$\",\"$L5\",null,{\"buildId\":\"K03OtJJvogNc2N558LDf2\",\"assetPrefix\":\"\",\"urlParts\":[\"\",\"blog\",\"rust-how-to-use-mpsc-unbounded-to-share-data-between-rust-threads\"],\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"rust-how-to-use-mpsc-unbounded-to-share-data-between-rust-threads\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"rust-how-to-use-mpsc-unbounded-to-share-data-between-rust-threads\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"rust-how-to-use-mpsc-unbounded-to-share-data-between-rust-threads\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L6\",\"$L7\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/be8a59717d6d5849.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/97e0a79122e618e4.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]],null],null]},[null,[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$9\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/dabd5e64a469b0e1.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"div\",null,{\"className\":\"layout_blogbodystyle___Uc1w\",\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]}]],null],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/4cb872a2a77e328a.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"layout_htmlstyle__PseMz\",\"children\":[\"$\",\"body\",null,{\"className\":\"layout_bodystyle__4ncsS\",\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"div\",null,{\"style\":{\"display\":\"flex\",\"alignItems\":\"center\",\"justifyContent\":\"center\",\"height\":\"100vh\"},\"children\":[\"$\",\"div\",null,{\"style\":{\"width\":\"50%\",\"height\":\"20%\",\"backgroundColor\":\"#ffeded\",\"borderRadius\":12,\"padding\":12,\"textAlign\":\"center\"},\"children\":[[\"$\",\"h1\",null,{\"children\":\"Not Found\"}],[\"$\",\"p\",null,{\"children\":\"Could not find requested resource\"}],[\"$\",\"$Lb\",null,{\"href\":\"/\",\"children\":\"Return Home\"}]]}]}],\"notFoundStyles\":[]}]}]}]],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$Lc\"],\"globalErrorComponent\":\"$d\",\"missingSlots\":\"$We\"}]\n"])</script><script>self.__next_f.push([1,"f:I[836,[\"156\",\"static/chunks/156-2b9f703633e98ef7.js\",\"836\",\"static/chunks/836-7e37630a3372363c.js\",\"308\",\"static/chunks/app/blog/%5Bslug%5D/page-2829e3c199d313ca.js\"],\"Image\"]\n"])</script><script>self.__next_f.push([1,"7:[\"$\",\"div\",null,{\"className\":\"BlogBody_BlogBody__600mT\",\"children\":[[\"$\",\"header\",null,{\"className\":\"BlogBody_siteTitle__f7uyb\",\"children\":\"Patrick Desjardins Blog\"}],[\"$\",\"nav\",null,{\"children\":[\"$\",\"ul\",null,{\"className\":\"BlogBody_navLinks__ZV12t\",\"children\":[\"$\",\"li\",null,{\"className\":\"BlogBody_navLinkItem__Pml2e\",\"children\":[[\"$\",\"$Lb\",null,{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/\",\"children\":\"Main Page\"}],[\"$\",\"$Lb\",null,{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog\",\"children\":\"Blog\"}],[\"$\",\"$Lb\",null,{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/search\",\"children\":\"Search\"}],[[\"$\",\"$Lb\",\"2026\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2026\",\"children\":2026}],[\"$\",\"$Lb\",\"2025\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2025\",\"children\":2025}],[\"$\",\"$Lb\",\"2024\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2024\",\"children\":2024}],[\"$\",\"$Lb\",\"2023\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2023\",\"children\":2023}],[\"$\",\"$Lb\",\"2022\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2022\",\"children\":2022}],[\"$\",\"$Lb\",\"2021\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2021\",\"children\":2021}],[\"$\",\"$Lb\",\"2020\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2020\",\"children\":2020}],[\"$\",\"$Lb\",\"2019\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2019\",\"children\":2019}],[\"$\",\"$Lb\",\"2018\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2018\",\"children\":2018}],[\"$\",\"$Lb\",\"2017\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2017\",\"children\":2017}],[\"$\",\"$Lb\",\"2016\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2016\",\"children\":2016}],[\"$\",\"$Lb\",\"2015\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2015\",\"children\":2015}],[\"$\",\"$Lb\",\"2014\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2014\",\"children\":2014}],[\"$\",\"$Lb\",\"2013\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2013\",\"children\":2013}],[\"$\",\"$Lb\",\"2012\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2012\",\"children\":2012}],[\"$\",\"$Lb\",\"2011\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2011\",\"children\":2011}]]]}]}]}],[\"$\",\"div\",null,{\"className\":\"BlogBody_blogPictureContainer__IAbPL\",\"children\":[\"$\",\"$Lf\",null,{\"className\":\"BlogBody_blogTopPicture__L6lao\",\"alt\":\"Patrick Desjardins picture from a conference\",\"src\":\"/images/backgrounds/patrickdesjardins_conference_bw.webp\",\"width\":800,\"height\":260}]}],[\"$\",\"main\",null,{\"className\":\"BlogBody_main__XrdKY\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"BlogBody_heading__bYRBe\",\"children\":\"How to use mpsc::unbounded to share data between Rust threads\"}],[\"$\",\"div\",null,{\"className\":\"Page_blogPostContainer__AUIcf\",\"children\":[[\"$\",\"p\",null,{\"className\":\"Page_blogPostDate__wVWWB\",\"children\":[\"Posted on: \",\"2022-11-26\"]}],[[\"$\",\"p\",null,{\"children\":\"Moving information between threads is always a delicate task. This is because so many issues can occur, and Rust is built around safety; hence it has a safe way to send information between two threads.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"One way is to rely on the \",[\"$\",\"code\",null,{\"children\":\"futures\"}],\" crate and use a \",[\"$\",\"code\",null,{\"children\":\"unbounded\"}],\". The documentation is fuzzy around how to use the \",[\"$\",\"code\",null,{\"children\":\"future::mpsc::unbounded,\"}],\" and I'll try to provide an easy example to grasp the whole idea.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"First, before getting too deep with \",[\"$\",\"code\",null,{\"children\":\"future::mpsc::unbounded\"}],\", know that there is also \",[\"$\",\"code\",null,{\"children\":\"future::mpsc::channel\"}],\". Channel is similar but is for \",[\"$\",\"em\",null,{\"children\":\"bounded\"}],\" communication. The \",[\"$\",\"em\",null,{\"children\":\"bounded\"}],\" has a single channel per sender, while the \",[\"$\",\"code\",null,{\"children\":\"future::mpsc::unbounded\"}],\" has a single channel for every sender. The example uses the \",[\"$\",\"code\",null,{\"children\":\"future::mpsc::unbounded\"}],\" with an internal buffer in case the receiver is not fetching the data fast enough.\"]}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"Main Loop Function\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The example consists of three functions. The first one, the main one, is the entry one that will spawn two threads.\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-rust\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"fn\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function-definition function\",\"children\":\"main\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"let\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"broker_sender\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" broker_receiver\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token namespace\",\"children\":[\"mpsc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}]]}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"unbounded\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"String\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token namespace\",\"children\":[\"task\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}]]}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"spawn\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"receive_loop\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"broker_receiver\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token namespace\",\"children\":[\"task\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}]]}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"block_on\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"send_loop\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"broker_sender\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"```\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"The\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"loop\"}],\" uses `\",[\"$\",\"span\",null,{\"className\":\"token namespace\",\"children\":[\"task\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}]]}],\"spawn` that starts a thread without blocking the execution of the `main` function and starting the `receive_loop` function into a separate thread\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"It\"}],\" allows getting into the second line that blocks the `main` function to keep the program running \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"while\"}],\" also running a second function\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" `send_loop` to run into another thread\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\" \\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"The\"}],\" `\",[\"$\",\"span\",null,{\"className\":\"token namespace\",\"children\":[\"mpsc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}]]}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"unbounded\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"String\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}],\"` create a sender and receiver that can be shared between the two threads\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"# send_loop \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Function\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"The\"}],\" send \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"loop\"}],\" is a function that takes the user input from the command line and adds the value into the `broker_sender` that gets the string into the `\",[\"$\",\"span\",null,{\"className\":\"token namespace\",\"children\":[\"mpsc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}]]}],\"unbounded` to have the `receive_loop` read it later\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\" \\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"````rust\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"fn\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function-definition function\",\"children\":\"send_loop\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"mut\"}],\" broker\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token namespace\",\"children\":[\"mpsc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}]]}],[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"UnboundedSender\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"String\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"-\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"loop\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"let\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"mut\"}],\" user_input \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"String\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"new\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token macro property\",\"children\":\"print!\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\u003e \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token namespace\",\"children\":[\"io\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}]]}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"stdout\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"flush\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"unwrap\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token namespace\",\"children\":[\"io\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}]]}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"stdin\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"read_line\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"mut\"}],\" user_input\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"unwrap\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"let\"}],\" user_input_clean \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" user_input\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"trim\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        broker\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"send\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"user_input_clean\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"to_string\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"unwrap\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"```\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"The\"}],\" function has an infinite \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"loop\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" waiting \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"for\"}],\" the user\",[\"$\",\"span\",null,{\"className\":\"token lifetime-annotation symbol\",\"children\":\"'s\"}],\" inputs\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Then\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" it waits to read the `stdin`\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" which takes the user line that is all the characters until the enter key is pressed\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Finally\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" the last line gets the `\",[\"$\",\"span\",null,{\"className\":\"token namespace\",\"children\":[\"mpsc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}]]}],[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"UnboundedSender\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"String\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}],\"` and `send` the `\",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"String\"}],\"` using `\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"unwrap`\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" which asynchronously puts the value into the communication pipeline\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"It\"}],\" still needs to be consumed\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"# receive_loop \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Function\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"The\"}],\" last step is the receiving function\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"````rust\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"fn\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function-definition function\",\"children\":\"receive_loop\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"mut\"}],\" broker\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token namespace\",\"children\":[\"mpsc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}]]}],[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"UnboundedReceiver\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"String\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"-\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"let\"}],\" ten_millis \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token namespace\",\"children\":[\"time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}]]}],[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Duration\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"from_millis\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"500\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"loop\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"let\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Ok\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"wrapper_msg\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" broker\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"try_next\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token macro property\",\"children\":\"println!\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"New message: {}\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" wrapper_msg\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"unwrap\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token namespace\",\"children\":[\"thread\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}]]}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"sleep\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ten_millis\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"```\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"The\"}],\" function also has an infinite \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"loop\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"It\"}],\" reads the `\",[\"$\",\"span\",null,{\"className\":\"token namespace\",\"children\":[\"mpsc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}]]}],[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"UnboundedReceiver\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"String\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}],\"` \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"where\"}],\" the value is sitting from the previous function\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"The\"}],\" code above takes the value by calling `try_next`\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" which returns a `\",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Result\"}],\"`\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"The\"}],\" function does not look \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"for\"}],\" the `\",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Err\"}],\"` path because the `try_next` spams an error anytime the `\",[\"$\",\"span\",null,{\"className\":\"token namespace\",\"children\":[\"mpsc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}]]}],[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"UnboundedReceiver\"}],\"` is empty\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"However\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" when data is ready to be read\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" the value goes into the `wrapper_msg`\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" an `\",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Option\"}],\"` \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"type\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Hence\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" the `unwrap` is called to read the string\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"# \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Conclusion\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"A\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"final\"}],\" observation is that the `\",[\"$\",\"span\",null,{\"className\":\"token namespace\",\"children\":[\"mpsc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}]]}],[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"UnboundedSender\"}],\"` and `\",[\"$\",\"span\",null,{\"className\":\"token namespace\",\"children\":[\"mpsc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}]]}],[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"UnboundedReceiver\"}],\"` shared between the two functions required to be mutable\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"You\"}],\" can see the `\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"mut\"}],\"` \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" both parameters\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Without\"}],\" the `\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"mut\"}],\"`\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" the code throws a compilation error\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"```\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"cannot borrow `broker` \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"as\"}],\" mutable\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"as\"}],\" it is not declared \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"as\"}],\" mutable\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"cannot borrow \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"as\"}],\" mutable\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"```\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"The\"}],\" reason seems to be that the `try_next` has a `\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"mut\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"self\"}],\"`  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" its \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"definition\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"https\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],\"docs\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"rs\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],\"futures\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\"channel\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0.3\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"25\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],\"src\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],\"futures_channel\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],\"mpsc\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"mod\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"rs\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"html#\",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1131\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"From\"}],\" my limited knowledge of \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Rust\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" the reason of why the `try_next` seems to be that at the end\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" it has a queue \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"where\"}],\" it needs to change its \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"value\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"mutate\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" with the \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"unpark_one\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"https\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],\"docs\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"rs\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],\"futures\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\"channel\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0.3\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"25\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],\"src\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],\"futures_channel\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],\"mpsc\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"mod\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"rs\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"html#\",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1031\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\" \\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"There\"}],\" is a very low amount of examples on the \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Internet\"}],\" using the `\",[\"$\",\"span\",null,{\"className\":\"token namespace\",\"children\":[\"mpsc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"::\"}]]}],\"unbounded`\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"I\"}],\" hope these small examples gave you help on how to \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"use\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Rust\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Future\"}],\" mpsc to pass information between threads\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"The\"}],\" code \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" this article relies on these two dependencies\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"```\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"futures \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"0.3.25\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\"std \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"1.12.0\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"```\\n\"}]]}]}]]]}]]}],[\"$\",\"div\",null,{\"className\":\"BlogBody_paginationBar__1gsMc\",\"children\":[[\"$\",\"div\",null,{\"className\":\"BlogBody_paginationTitle__H_eFX\",\"children\":\"Chronological Blog Articles by Page\"}],[\"$\",\"div\",null,{\"className\":\"BlogBody_paginationLinks__nk8zd\",\"children\":[[\"$\",\"$Lb\",\"1\",{\"className\":\"\",\"href\":\"/blog/page/1\",\"children\":1}],[\"$\",\"$Lb\",\"2\",{\"className\":\"\",\"href\":\"/blog/page/2\",\"children\":2}],[\"$\",\"$Lb\",\"3\",{\"className\":\"\",\"href\":\"/blog/page/3\",\"children\":3}],[\"$\",\"$Lb\",\"4\",{\"className\":\"\",\"href\":\"/blog/page/4\",\"children\":4}],[\"$\",\"$Lb\",\"5\",{\"className\":\"\",\"href\":\"/blog/page/5\",\"children\":5}],[\"$\",\"$Lb\",\"6\",{\"className\":\"\",\"href\":\"/blog/page/6\",\"children\":6}],[\"$\",\"$Lb\",\"7\",{\"className\":\"\",\"href\":\"/blog/page/7\",\"children\":7}],[\"$\",\"$Lb\",\"8\",{\"className\":\"\",\"href\":\"/blog/page/8\",\"children\":8}],[\"$\",\"$Lb\",\"9\",{\"className\":\"\",\"href\":\"/blog/page/9\",\"children\":9}],[\"$\",\"$Lb\",\"10\",{\"className\":\"\",\"href\":\"/blog/page/10\",\"children\":10}],[\"$\",\"$Lb\",\"11\",{\"className\":\"\",\"href\":\"/blog/page/11\",\"children\":11}],[\"$\",\"$Lb\",\"12\",{\"className\":\"\",\"href\":\"/blog/page/12\",\"children\":12}],[\"$\",\"$Lb\",\"13\",{\"className\":\"\",\"href\":\"/blog/page/13\",\"children\":13}],[\"$\",\"$Lb\",\"14\",{\"className\":\"\",\"href\":\"/blog/page/14\",\"children\":14}],[\"$\",\"$Lb\",\"15\",{\"className\":\"\",\"href\":\"/blog/page/15\",\"children\":15}],[\"$\",\"$Lb\",\"16\",{\"className\":\"\",\"href\":\"/blog/page/16\",\"children\":16}],[\"$\",\"$Lb\",\"17\",{\"className\":\"\",\"href\":\"/blog/page/17\",\"children\":17}],[\"$\",\"$Lb\",\"18\",{\"className\":\"\",\"href\":\"/blog/page/18\",\"children\":18}],[\"$\",\"$Lb\",\"19\",{\"className\":\"\",\"href\":\"/blog/page/19\",\"children\":19}],[\"$\",\"$Lb\",\"20\",{\"className\":\"\",\"href\":\"/blog/page/20\",\"children\":20}],[\"$\",\"$Lb\",\"21\",{\"className\":\"\",\"href\":\"/blog/page/21\",\"children\":21}],[\"$\",\"$Lb\",\"22\",{\"className\":\"\",\"href\":\"/blog/page/22\",\"children\":22}],[\"$\",\"$Lb\",\"23\",{\"className\":\"\",\"href\":\"/blog/page/23\",\"children\":23}],[\"$\",\"$Lb\",\"24\",{\"className\":\"\",\"href\":\"/blog/page/24\",\"children\":24}],[\"$\",\"$Lb\",\"25\",{\"className\":\"\",\"href\":\"/blog/page/25\",\"children\":25}],[\"$\",\"$Lb\",\"26\",{\"className\":\"\",\"href\":\"/blog/page/26\",\"children\":26}],[\"$\",\"$Lb\",\"27\",{\"className\":\"\",\"href\":\"/blog/page/27\",\"children\":27}],[\"$\",\"$Lb\",\"28\",{\"className\":\"\",\"href\":\"/blog/page/28\",\"children\":28}],[\"$\",\"$Lb\",\"29\",{\"className\":\"\",\"href\":\"/blog/page/29\",\"children\":29}],[\"$\",\"$Lb\",\"30\",{\"className\":\"\",\"href\":\"/blog/page/30\",\"children\":30}],[\"$\",\"$Lb\",\"31\",{\"className\":\"\",\"href\":\"/blog/page/31\",\"children\":31}],[\"$\",\"$Lb\",\"32\",{\"className\":\"\",\"href\":\"/blog/page/32\",\"children\":32}],[\"$\",\"$Lb\",\"33\",{\"className\":\"\",\"href\":\"/blog/page/33\",\"children\":33}],[\"$\",\"$Lb\",\"34\",{\"className\":\"\",\"href\":\"/blog/page/34\",\"children\":34}],[\"$\",\"$Lb\",\"35\",{\"className\":\"\",\"href\":\"/blog/page/35\",\"children\":35}],[\"$\",\"$Lb\",\"36\",{\"className\":\"\",\"href\":\"/blog/page/36\",\"children\":36}],[\"$\",\"$Lb\",\"37\",{\"className\":\"\",\"href\":\"/blog/page/37\",\"children\":37}],[\"$\",\"$Lb\",\"38\",{\"className\":\"\",\"href\":\"/blog/page/38\",\"children\":38}],[\"$\",\"$Lb\",\"39\",{\"className\":\"\",\"href\":\"/blog/page/39\",\"children\":39}],[\"$\",\"$Lb\",\"40\",{\"className\":\"\",\"href\":\"/blog/page/40\",\"children\":40}],[\"$\",\"$Lb\",\"41\",{\"className\":\"\",\"href\":\"/blog/page/41\",\"children\":41}],[\"$\",\"$Lb\",\"42\",{\"className\":\"\",\"href\":\"/blog/page/42\",\"children\":42}],[\"$\",\"$Lb\",\"43\",{\"className\":\"\",\"href\":\"/blog/page/43\",\"children\":43}],[\"$\",\"$Lb\",\"44\",{\"className\":\"\",\"href\":\"/blog/page/44\",\"children\":44}],[\"$\",\"$Lb\",\"45\",{\"className\":\"\",\"href\":\"/blog/page/45\",\"children\":45}],[\"$\",\"$Lb\",\"46\",{\"className\":\"\",\"href\":\"/blog/page/46\",\"children\":46}],[\"$\",\"$Lb\",\"47\",{\"className\":\"\",\"href\":\"/blog/page/47\",\"children\":47}],[\"$\",\"$Lb\",\"48\",{\"className\":\"\",\"href\":\"/blog/page/48\",\"children\":48}],[\"$\",\"$Lb\",\"49\",{\"className\":\"\",\"href\":\"/blog/page/49\",\"children\":49}],[\"$\",\"$Lb\",\"50\",{\"className\":\"\",\"href\":\"/blog/page/50\",\"children\":50}],[\"$\",\"$Lb\",\"51\",{\"className\":\"\",\"href\":\"/blog/page/51\",\"children\":51}],[\"$\",\"$Lb\",\"52\",{\"className\":\"\",\"href\":\"/blog/page/52\",\"children\":52}],[\"$\",\"$Lb\",\"53\",{\"className\":\"\",\"href\":\"/blog/page/53\",\"children\":53}],[\"$\",\"$Lb\",\"54\",{\"className\":\"\",\"href\":\"/blog/page/54\",\"children\":54}],[\"$\",\"$Lb\",\"55\",{\"className\":\"\",\"href\":\"/blog/page/55\",\"children\":55}],[\"$\",\"$Lb\",\"56\",{\"className\":\"\",\"href\":\"/blog/page/56\",\"children\":56}],[\"$\",\"$Lb\",\"57\",{\"className\":\"\",\"href\":\"/blog/page/57\",\"children\":57}],[\"$\",\"$Lb\",\"58\",{\"className\":\"\",\"href\":\"/blog/page/58\",\"children\":58}],[\"$\",\"$Lb\",\"59\",{\"className\":\"\",\"href\":\"/blog/page/59\",\"children\":59}],[\"$\",\"$Lb\",\"60\",{\"className\":\"\",\"href\":\"/blog/page/60\",\"children\":60}],[\"$\",\"$Lb\",\"61\",{\"className\":\"\",\"href\":\"/blog/page/61\",\"children\":61}],[\"$\",\"$Lb\",\"62\",{\"className\":\"\",\"href\":\"/blog/page/62\",\"children\":62}],[\"$\",\"$Lb\",\"63\",{\"className\":\"\",\"href\":\"/blog/page/63\",\"children\":63}],[\"$\",\"$Lb\",\"64\",{\"className\":\"\",\"href\":\"/blog/page/64\",\"children\":64}],[\"$\",\"$Lb\",\"65\",{\"className\":\"\",\"href\":\"/blog/page/65\",\"children\":65}],[\"$\",\"$Lb\",\"66\",{\"className\":\"\",\"href\":\"/blog/page/66\",\"children\":66}],[\"$\",\"$Lb\",\"67\",{\"className\":\"\",\"href\":\"/blog/page/67\",\"children\":67}],[\"$\",\"$Lb\",\"68\",{\"className\":\"\",\"href\":\"/blog/page/68\",\"children\":68}],[\"$\",\"$Lb\",\"69\",{\"className\":\"\",\"href\":\"/blog/page/69\",\"children\":69}],[\"$\",\"$Lb\",\"70\",{\"className\":\"\",\"href\":\"/blog/page/70\",\"children\":70}],[\"$\",\"$Lb\",\"71\",{\"className\":\"\",\"href\":\"/blog/page/71\",\"children\":71}],[\"$\",\"$Lb\",\"72\",{\"className\":\"\",\"href\":\"/blog/page/72\",\"children\":72}],[\"$\",\"$Lb\",\"73\",{\"className\":\"\",\"href\":\"/blog/page/73\",\"children\":73}],[\"$\",\"$Lb\",\"74\",{\"className\":\"\",\"href\":\"/blog/page/74\",\"children\":74}],[\"$\",\"$Lb\",\"75\",{\"className\":\"\",\"href\":\"/blog/page/75\",\"children\":75}],[\"$\",\"$Lb\",\"76\",{\"className\":\"\",\"href\":\"/blog/page/76\",\"children\":76}],[\"$\",\"$Lb\",\"77\",{\"className\":\"\",\"href\":\"/blog/page/77\",\"children\":77}],[\"$\",\"$Lb\",\"78\",{\"className\":\"\",\"href\":\"/blog/page/78\",\"children\":78}],[\"$\",\"$Lb\",\"79\",{\"className\":\"\",\"href\":\"/blog/page/79\",\"children\":79}],[\"$\",\"$Lb\",\"80\",{\"className\":\"\",\"href\":\"/blog/page/80\",\"children\":80}],[\"$\",\"$Lb\",\"81\",{\"className\":\"\",\"href\":\"/blog/page/81\",\"children\":81}]]}]]}],null]}]\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Patrick Desjardins Blog - How to use mpsc::unbounded to share data between Rust threads\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"How to use mpsc::unbounded to share data between Rust threads\"}]]\n6:null\n"])</script></body></html>
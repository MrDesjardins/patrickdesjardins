3:I[8766,[],""]
5:I[5623,[],""]
6:I[1534,["534","static/chunks/534-bc4bf8794653d52f.js","449","static/chunks/449-07387e3734c92aeb.js","308","static/chunks/app/blog/%5Bslug%5D/page-5279e1ccd7c02190.js"],""]
4:["slug","python-unit-test","d"]
0:["tyuhdnbc845VhYY8-XTqR",[[["",{"children":["blog",{"children":[["slug","python-unit-test","d"],{"children":["__PAGE__?{\"slug\":\"python-unit-test\"}",{}]}]}]},"$undefined","$undefined",true],["",{"children":["blog",{"children":[["slug","python-unit-test","d"],{"children":["__PAGE__",{},[["$L1","$L2",[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/be8a59717d6d5849.css","precedence":"next","crossOrigin":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/css/97e0a79122e618e4.css","precedence":"next","crossOrigin":"$undefined"}]]],null],null]},[null,["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","$4","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]],null]},[[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/dabd5e64a469b0e1.css","precedence":"next","crossOrigin":"$undefined"}]],["$","div",null,{"className":"layout_blogbodystyle___Uc1w","children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]}]],null],null]},[[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/4cb872a2a77e328a.css","precedence":"next","crossOrigin":"$undefined"}]],["$","html",null,{"lang":"en","className":"layout_htmlstyle__PseMz","children":["$","body",null,{"className":"layout_bodystyle__4ncsS","children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","div",null,{"style":{"display":"flex","alignItems":"center","justifyContent":"center","height":"100vh"},"children":["$","div",null,{"style":{"width":"50%","height":"20%","backgroundColor":"#ffeded","borderRadius":12,"padding":12,"textAlign":"center"},"children":[["$","h1",null,{"children":"Not Found"}],["$","p",null,{"children":"Could not find requested resource"}],["$","$L6",null,{"href":"/","children":"Return Home"}]]}]}],"notFoundStyles":[]}]}]}]],null],null],["$L7",null]]]]
8:I[3449,["534","static/chunks/534-bc4bf8794653d52f.js","449","static/chunks/449-07387e3734c92aeb.js","308","static/chunks/app/blog/%5Bslug%5D/page-5279e1ccd7c02190.js"],"Image"]
2:["$","div",null,{"className":"BlogBody_BlogBody__600mT","children":[["$","header",null,{"className":"BlogBody_siteTitle__f7uyb","children":"Patrick Desjardins Blog"}],["$","nav",null,{"children":["$","ul",null,{"className":"BlogBody_navLinks__ZV12t","children":["$","li",null,{"className":"BlogBody_navLinkItem__Pml2e","children":[["$","$L6",null,{"className":"BlogBody_navLinkText__ZtH2y","href":"/","children":"Main Page"}],["$","$L6",null,{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog","children":"Blog"}],["$","$L6",null,{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/search","children":"Search"}],[["$","$L6","2025",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2025","children":2025}],["$","$L6","2024",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2024","children":2024}],["$","$L6","2023",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2023","children":2023}],["$","$L6","2022",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2022","children":2022}],["$","$L6","2021",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2021","children":2021}],["$","$L6","2020",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2020","children":2020}],["$","$L6","2019",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2019","children":2019}],["$","$L6","2018",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2018","children":2018}],["$","$L6","2017",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2017","children":2017}],["$","$L6","2016",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2016","children":2016}],["$","$L6","2015",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2015","children":2015}],["$","$L6","2014",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2014","children":2014}],["$","$L6","2013",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2013","children":2013}],["$","$L6","2012",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2012","children":2012}],["$","$L6","2011",{"className":"BlogBody_navLinkText__ZtH2y","href":"/blog/for/2011","children":2011}]]]}]}]}],["$","div",null,{"className":"BlogBody_blogPictureContainer__IAbPL","children":["$","$L8",null,{"className":"BlogBody_blogTopPicture__L6lao","alt":"Patrick Desjardins picture from a conference","src":"/images/backgrounds/patrickdesjardins_conference_bw.webp","width":800,"height":260}]}],["$","main",null,{"className":"BlogBody_main__XrdKY","children":[["$","h1",null,{"className":"BlogBody_heading__bYRBe","children":"Python Automated Test"}],["$","div",null,{"className":"Page_blogPostContainer__AUIcf","children":[["$","p",null,{"className":"Page_blogPostDate__wVWWB","children":["Posted on: ","2025-03-05"]}],[["$","p",null,{"children":["I wrote about 200 automated (unit and integration) tests in the last few months in my ",["$","a",null,{"href":"https://github.com/MrDesjardins/python-discord-scheduler-bot","children":"Python Discord Bot"}],", and I am delighted by the experience. The best is the extremely low friction to mock using ",["$","code",null,{"children":"pytest"}]," and ",["$","code",null,{"children":"unit test.mock"}],"."]}],"\n",["$","h1",null,{"children":"Mocking Function"}],"\n",["$","p",null,{"children":["Mocking a function is as simple as using ",["$","code",null,{"children":"@patch.object"}]," and the module (file) that contains the function to mock. The ",["$","code",null,{"children":"__name__"}]," is used to get the function's name to mock and it helps when renaming using the refactoring tool of your editor. Here is an example that mocks two functions of the module ",["$","code",null,{"children":"bet_functions"}],":"]}],"\n",["$","pre",null,{"className":"language-python","children":["$","code",null,{"className":"language-Python code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token decorator annotation punctuation","children":["@patch",["$","span",null,{"className":"token punctuation","children":"."}],"object"]}],["$","span",null,{"className":"token punctuation","children":"("}],"bet_functions",["$","span",null,{"className":"token punctuation","children":","}]," bet_functions",["$","span",null,{"className":"token punctuation","children":"."}],"data_access_create_bet_user_wallet_for_tournament",["$","span",null,{"className":"token punctuation","children":"."}],"__name__",["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token decorator annotation punctuation","children":["@patch",["$","span",null,{"className":"token punctuation","children":"."}],"object"]}],["$","span",null,{"className":"token punctuation","children":"("}],"bet_functions",["$","span",null,{"className":"token punctuation","children":","}]," bet_functions",["$","span",null,{"className":"token punctuation","children":"."}],"data_access_get_bet_user_wallet_for_tournament",["$","span",null,{"className":"token punctuation","children":"."}],"__name__",["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token keyword","children":"def"}]," ",["$","span",null,{"className":"token function","children":"test_get_wallet_for_tournament_no_wallet_create_one"}],["$","span",null,{"className":"token punctuation","children":"("}],"mock_get_user_wallet_for_tournament",["$","span",null,{"className":"token punctuation","children":","}]," mock_create_bet",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":":"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token triple-quoted-string string","children":"\"\"\"\n"}]]}],["$","span",null,{"className":"code-line","children":["$","span",null,{"className":"token triple-quoted-string string","children":" Test the user scenario that a user does not have a wallet\n"}]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token triple-quoted-string string","children":" \"\"\""}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token comment","children":"# Arrange"}],"\n"]}],["$","span",null,{"className":"code-line","children":[" tournament ",["$","span",null,{"className":"token operator","children":"="}]," BetUserTournament",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token number","children":"67"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"44"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"12"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"100"}],["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":[" mock_get_user_wallet_for_tournament",["$","span",null,{"className":"token punctuation","children":"."}],"side_effect ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token punctuation","children":"["}],["$","span",null,{"className":"token boolean","children":"None"}],["$","span",null,{"className":"token punctuation","children":","}]," tournament",["$","span",null,{"className":"token punctuation","children":"]"}],"\n"]}],["$","span",null,{"className":"code-line","children":[" mock_create_bet",["$","span",null,{"className":"token punctuation","children":"."}],"return_value ",["$","span",null,{"className":"token operator","children":"="}]," tournament\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token comment","children":"# Act"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    get_bet_user_wallet_for_tournament",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token number","children":"44"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"12"}],["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token comment","children":"# Assert"}],"\n"]}],["$","span",null,{"className":"code-line","children":[" mock_create_bet",["$","span",null,{"className":"token punctuation","children":"."}],"assert_called_once_with",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token number","children":"44"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"12"}],["$","span",null,{"className":"token punctuation","children":","}]," DEFAULT_MONEY",["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":[" mock_get_user_wallet_for_tournament",["$","span",null,{"className":"token punctuation","children":"."}],"assert_called",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token keyword","children":"assert"}]," ",["$","span",null,{"className":"token punctuation","children":"("}],"\n"]}],["$","span",null,{"className":"code-line","children":[" mock_get_user_wallet_for_tournament",["$","span",null,{"className":"token punctuation","children":"."}],"call_count ",["$","span",null,{"className":"token operator","children":"=="}]," ",["$","span",null,{"className":"token number","children":"2"}],"\n"]}],["$","span",null,{"className":"code-line","children":[" ",["$","span",null,{"className":"token punctuation","children":")"}],"  ",["$","span",null,{"className":"token comment","children":"# One time for the None and one time for the created wallet"}],"\n"]}]]}]}],"\n",["$","p",null,{"children":["Each ",["$","code",null,{"children":"@patch.object"}]," decorator injects an object into the test function. You can use ",["$","code",null,{"children":"side_effect"}]," to specify the result for each invocation."]}],"\n",["$","pre",null,{"className":"language-python","children":["$","code",null,{"className":"language-Python code-highlight","children":["$","span",null,{"className":"code-line","children":["mock_get_user_wallet_for_tournament",["$","span",null,{"className":"token punctuation","children":"."}],"side_effect ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token punctuation","children":"["}],["$","span",null,{"className":"token boolean","children":"None"}],["$","span",null,{"className":"token punctuation","children":","}]," tournament",["$","span",null,{"className":"token punctuation","children":"]"}],"\n"]}]}]}],"\n",["$","p",null,{"children":["The mock of the ",["$","em",null,{"children":"get user waller"}]," returns ",["$","code",null,{"children":"None"}]," the first time and ",["$","code",null,{"children":"tournament"}]," the second time. The assertion on the mock is also simple by calling the mock one of the many assertion methods. The test above calls three different assertions."]}],"\n",["$","h1",null,{"children":"Mocking Time"}],"\n",["$","p",null,{"children":"Time is always tricky to test. I found along my journey as a developer that if you can have a wrapper around a function that returns the time, it simplifies testing. However, you can easily mock the date or datetime module using Python."}],"\n",["$","p",null,{"children":["The format is different, but use the same idea that you specified for the module. This time, you can do it directly inside the test and use the ",["$","code",null,{"children":"with"}]," statement to make sure that the mock is only for the test. Here is an example that mocks the ",["$","code",null,{"children":"datetime"}]," module. Then, within the test you specify the value you want to return. For example, I was using the ",["$","code",null,{"children":"now"}]," of the ",["$","code",null,{"children":"datetime"}]," module to get the current time. I can replace the value from a test to another by creating an instance of ",["$","code",null,{"children":"datetime"}]," and setting the value I want to return. The following test mocks the time used by two different functions with different times."]}],"\n",["$","pre",null,{"className":"language-python","children":["$","code",null,{"className":"language-Python code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token keyword","children":"async"}]," ",["$","span",null,{"className":"token keyword","children":"def"}]," ",["$","span",null,{"className":"token function","children":"test_daily_registration_message_tournament_available_but_no_space"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":":"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token triple-quoted-string string","children":"\"\"\"\n"}]]}],["$","span",null,{"className":"code-line","children":["$","span",null,{"className":"token triple-quoted-string string","children":" Create few tournaments and make sure the command to retrieve the registration works\n"}]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token triple-quoted-string string","children":" \"\"\""}],"\n"]}],["$","span",null,{"className":"code-line","children":[" register_date_start ",["$","span",null,{"className":"token operator","children":"="}]," datetime",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token number","children":"2024"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"11"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"1"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"12"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"30"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"0"}],["$","span",null,{"className":"token punctuation","children":","}]," tzinfo",["$","span",null,{"className":"token operator","children":"="}],"timezone",["$","span",null,{"className":"token punctuation","children":"."}],"utc",["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":[" date_start ",["$","span",null,{"className":"token operator","children":"="}]," datetime",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token number","children":"2024"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"11"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"2"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"10"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"30"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"0"}],["$","span",null,{"className":"token punctuation","children":","}]," tzinfo",["$","span",null,{"className":"token operator","children":"="}],"timezone",["$","span",null,{"className":"token punctuation","children":"."}],"utc",["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":[" date_end ",["$","span",null,{"className":"token operator","children":"="}]," datetime",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token number","children":"2024"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"11"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"3"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"20"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"30"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token number","children":"0"}],["$","span",null,{"className":"token punctuation","children":","}]," tzinfo",["$","span",null,{"className":"token operator","children":"="}],"timezone",["$","span",null,{"className":"token punctuation","children":"."}],"utc",["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":[" tournament_id ",["$","span",null,{"className":"token operator","children":"="}]," data_access_insert_tournament",["$","span",null,{"className":"token punctuation","children":"("}],"\n"]}],["$","span",null,{"className":"code-line","children":["        GUILD_ID",["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token string","children":"\"My Tournament\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":[" register_date_start",["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":[" date_start",["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":[" date_end",["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token number","children":"9"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token number","children":"2"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token string","children":"\"villa,clubhouse,consulate,chalet,oregon,coastline,border\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token keyword","children":"with"}]," patch",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"deps.tournaments.tournament_data_access.datetime\""}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token keyword","children":"as"}]," mock_datetime",["$","span",null,{"className":"token punctuation","children":":"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token keyword","children":"with"}]," patch",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"\"deps.tournaments.tournament_functions.datetime\""}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token keyword","children":"as"}]," mock_datetime2",["$","span",null,{"className":"token punctuation","children":":"}],"\n"]}],["$","span",null,{"className":"code-line","children":[" mock_datetime",["$","span",null,{"className":"token punctuation","children":"."}],"now",["$","span",null,{"className":"token punctuation","children":"."}],"return_value ",["$","span",null,{"className":"token operator","children":"="}]," register_date_start\n"]}],["$","span",null,{"className":"code-line","children":[" mock_datetime2",["$","span",null,{"className":"token punctuation","children":"."}],"now",["$","span",null,{"className":"token punctuation","children":"."}],"return_value ",["$","span",null,{"className":"token operator","children":"="}]," register_date_start\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token comment","children":"# Act"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token comment","children":"# ... "}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token comment","children":"# Assert "}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token comment","children":"# ..."}],"\n"]}]]}]}],"\n",["$","h1",null,{"children":"Running and Debugging"}],"\n",["$","p",null,{"children":"Always a struggle using TypeScript with Node because of the transpilation and sometimes the breakpoint cannot be hit. With Python and VsCode, I had no issue since few months. Here is my VsCode configuration (settings.json):"}],"\n",["$","pre",null,{"className":"language-json","children":["$","code",null,{"className":"language-json code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token property","children":"\"python.analysis.extraPaths\""}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token punctuation","children":"["}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token string","children":"\"./deps\""}],"\n"]}],["$","span",null,{"className":"code-line","children":[" ",["$","span",null,{"className":"token punctuation","children":"]"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token property","children":"\"python.testing.unittestArgs\""}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token punctuation","children":"["}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token string","children":"\"-v\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token string","children":"\"-s\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token string","children":"\"./tests\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token string","children":"\"-p\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token string","children":"\"*test.py\""}],"\n"]}],["$","span",null,{"className":"code-line","children":[" ",["$","span",null,{"className":"token punctuation","children":"]"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token property","children":"\"python.testing.pytestEnabled\""}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token boolean","children":"true"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token property","children":"\"python.testing.unittestEnabled\""}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token boolean","children":"false"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token property","children":"\"python.testing.pytestArgs\""}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token punctuation","children":"["}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token string","children":"\"tests\""}],"\n"]}],["$","span",null,{"className":"code-line","children":[" ",["$","span",null,{"className":"token punctuation","children":"]"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}]]}]}],"\n",["$","p",null,{"children":"I can run all unit tests with :"}],"\n",["$","pre",null,{"className":"language-bash","children":["$","code",null,{"className":"language-bash code-highlight","children":["$","span",null,{"className":"code-line","children":["pytest ",["$","span",null,{"className":"token parameter variable","children":"-v"}]," ",["$","span",null,{"className":"token parameter variable","children":"-s"}]," ./tests/*_unit_test.py\n"]}]}]}],"\n",["$","p",null,{"children":"All integration tests with:"}],"\n",["$","pre",null,{"className":"language-bash","children":["$","code",null,{"className":"language-bash code-highlight","children":["$","span",null,{"className":"code-line","children":["pytest ",["$","span",null,{"className":"token parameter variable","children":"-v"}]," ",["$","span",null,{"className":"token parameter variable","children":"-s"}]," ./tests/*_integration_test.py\n"]}]}]}],"\n",["$","p",null,{"children":"Get code coverage with:"}],"\n",["$","pre",null,{"className":"language-bash","children":["$","code",null,{"className":"language-bash code-highlight","children":["$","span",null,{"className":"code-line","children":["coverage run ",["$","span",null,{"className":"token parameter variable","children":"--omit"}],["$","span",null,{"className":"token operator","children":"="}],["$","span",null,{"className":"token string","children":"\"./tests/*\""}]," ",["$","span",null,{"className":"token parameter variable","children":"-m"}]," pytest ",["$","span",null,{"className":"token parameter variable","children":"-v"}]," ",["$","span",null,{"className":"token parameter variable","children":"-s"}]," ./tests/*unit_test.py ",["$","span",null,{"className":"token operator","children":"&&"}]," coverage html\n"]}]}]}],"\n",["$","p",null,{"children":"And debug is clicking the green triangle next to the function. It can run or debug to step in. The low friction makes the creation of the test easy and actually encourages the creation."}],"\n",["$","h1",null,{"children":"Database (system-test)"}],"\n",["$","p",null,{"children":["Few tests require the database because they integrate functions that load and save in the database. These tests are in a file with the suffix ",["$","code",null,{"children":"_integration_test.py"}],". The database is a SQLite database that is created and destroyed for each test. The database could be in memory, but it is not. The reason is it is easier to debug in case of failure by inspecting what is in the database. Each integration test file has a ",["$","code",null,{"children":"setup_and_teardown"}]," fixture that sets the manager to the test copy database and a function to delete the database context. The database is created by the ",["$","code",null,{"children":"pytest"}]," fixture ",["$","code",null,{"children":"db"}]," that is used in the test."]}],"\n",["$","pre",null,{"className":"language-python","children":["$","code",null,{"className":"language-Python code-highlight","children":[["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token decorator annotation punctuation","children":["@pytest",["$","span",null,{"className":"token punctuation","children":"."}],"fixture"]}],["$","span",null,{"className":"token punctuation","children":"("}],"autouse",["$","span",null,{"className":"token operator","children":"="}],["$","span",null,{"className":"token boolean","children":"True"}],["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token keyword","children":"def"}]," ",["$","span",null,{"className":"token function","children":"setup_and_teardown"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":":"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token triple-quoted-string string","children":"\"\"\"Setup and Teardown for the test\"\"\""}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token comment","children":"# Setup"}],"\n"]}],["$","span",null,{"className":"code-line","children":[" database_manager",["$","span",null,{"className":"token punctuation","children":"."}],"set_database_name",["$","span",null,{"className":"token punctuation","children":"("}],"DATABASE_NAME_TEST",["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    delete_all_tables",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token comment","children":"# Yield control to the test functions"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token keyword","children":"yield"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token comment","children":"# Teardown"}],"\n"]}],["$","span",null,{"className":"code-line","children":[" database_manager",["$","span",null,{"className":"token punctuation","children":"."}],"set_database_name",["$","span",null,{"className":"token punctuation","children":"("}],"DATABASE_NAME",["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}]]}]}],"\n",["$","h1",null,{"children":"Conclusion"}],"\n",["$","p",null,{"children":"Working with Python has its pros and cons. The typing is far from excellent, but the ecosystem, large community, and testing are excellent."}]]]}]]}],["$","div",null,{"className":"BlogBody_paginationBar__1gsMc","children":[["$","div",null,{"className":"BlogBody_paginationTitle__H_eFX","children":"Chronological Blog Articles by Page"}],["$","div",null,{"className":"BlogBody_paginationLinks__nk8zd","children":[["$","$L6","1",{"className":"","href":"/blog/page/1","children":1}],["$","$L6","2",{"className":"","href":"/blog/page/2","children":2}],["$","$L6","3",{"className":"","href":"/blog/page/3","children":3}],["$","$L6","4",{"className":"","href":"/blog/page/4","children":4}],["$","$L6","5",{"className":"","href":"/blog/page/5","children":5}],["$","$L6","6",{"className":"","href":"/blog/page/6","children":6}],["$","$L6","7",{"className":"","href":"/blog/page/7","children":7}],["$","$L6","8",{"className":"","href":"/blog/page/8","children":8}],["$","$L6","9",{"className":"","href":"/blog/page/9","children":9}],["$","$L6","10",{"className":"","href":"/blog/page/10","children":10}],["$","$L6","11",{"className":"","href":"/blog/page/11","children":11}],["$","$L6","12",{"className":"","href":"/blog/page/12","children":12}],["$","$L6","13",{"className":"","href":"/blog/page/13","children":13}],["$","$L6","14",{"className":"","href":"/blog/page/14","children":14}],["$","$L6","15",{"className":"","href":"/blog/page/15","children":15}],["$","$L6","16",{"className":"","href":"/blog/page/16","children":16}],["$","$L6","17",{"className":"","href":"/blog/page/17","children":17}],["$","$L6","18",{"className":"","href":"/blog/page/18","children":18}],["$","$L6","19",{"className":"","href":"/blog/page/19","children":19}],["$","$L6","20",{"className":"","href":"/blog/page/20","children":20}],["$","$L6","21",{"className":"","href":"/blog/page/21","children":21}],["$","$L6","22",{"className":"","href":"/blog/page/22","children":22}],["$","$L6","23",{"className":"","href":"/blog/page/23","children":23}],["$","$L6","24",{"className":"","href":"/blog/page/24","children":24}],["$","$L6","25",{"className":"","href":"/blog/page/25","children":25}],["$","$L6","26",{"className":"","href":"/blog/page/26","children":26}],["$","$L6","27",{"className":"","href":"/blog/page/27","children":27}],["$","$L6","28",{"className":"","href":"/blog/page/28","children":28}],["$","$L6","29",{"className":"","href":"/blog/page/29","children":29}],["$","$L6","30",{"className":"","href":"/blog/page/30","children":30}],["$","$L6","31",{"className":"","href":"/blog/page/31","children":31}],["$","$L6","32",{"className":"","href":"/blog/page/32","children":32}],["$","$L6","33",{"className":"","href":"/blog/page/33","children":33}],["$","$L6","34",{"className":"","href":"/blog/page/34","children":34}],["$","$L6","35",{"className":"","href":"/blog/page/35","children":35}],["$","$L6","36",{"className":"","href":"/blog/page/36","children":36}],["$","$L6","37",{"className":"","href":"/blog/page/37","children":37}],["$","$L6","38",{"className":"","href":"/blog/page/38","children":38}],["$","$L6","39",{"className":"","href":"/blog/page/39","children":39}],["$","$L6","40",{"className":"","href":"/blog/page/40","children":40}],["$","$L6","41",{"className":"","href":"/blog/page/41","children":41}],["$","$L6","42",{"className":"","href":"/blog/page/42","children":42}],["$","$L6","43",{"className":"","href":"/blog/page/43","children":43}],["$","$L6","44",{"className":"","href":"/blog/page/44","children":44}],["$","$L6","45",{"className":"","href":"/blog/page/45","children":45}],["$","$L6","46",{"className":"","href":"/blog/page/46","children":46}],["$","$L6","47",{"className":"","href":"/blog/page/47","children":47}],["$","$L6","48",{"className":"","href":"/blog/page/48","children":48}],["$","$L6","49",{"className":"","href":"/blog/page/49","children":49}],["$","$L6","50",{"className":"","href":"/blog/page/50","children":50}],["$","$L6","51",{"className":"","href":"/blog/page/51","children":51}],["$","$L6","52",{"className":"","href":"/blog/page/52","children":52}],["$","$L6","53",{"className":"","href":"/blog/page/53","children":53}],["$","$L6","54",{"className":"","href":"/blog/page/54","children":54}],["$","$L6","55",{"className":"","href":"/blog/page/55","children":55}],["$","$L6","56",{"className":"","href":"/blog/page/56","children":56}],["$","$L6","57",{"className":"","href":"/blog/page/57","children":57}],["$","$L6","58",{"className":"","href":"/blog/page/58","children":58}],["$","$L6","59",{"className":"","href":"/blog/page/59","children":59}],["$","$L6","60",{"className":"","href":"/blog/page/60","children":60}],["$","$L6","61",{"className":"","href":"/blog/page/61","children":61}],["$","$L6","62",{"className":"","href":"/blog/page/62","children":62}],["$","$L6","63",{"className":"","href":"/blog/page/63","children":63}],["$","$L6","64",{"className":"","href":"/blog/page/64","children":64}],["$","$L6","65",{"className":"","href":"/blog/page/65","children":65}],["$","$L6","66",{"className":"","href":"/blog/page/66","children":66}],["$","$L6","67",{"className":"","href":"/blog/page/67","children":67}],["$","$L6","68",{"className":"","href":"/blog/page/68","children":68}],["$","$L6","69",{"className":"","href":"/blog/page/69","children":69}],["$","$L6","70",{"className":"","href":"/blog/page/70","children":70}],["$","$L6","71",{"className":"","href":"/blog/page/71","children":71}],["$","$L6","72",{"className":"","href":"/blog/page/72","children":72}],["$","$L6","73",{"className":"","href":"/blog/page/73","children":73}],["$","$L6","74",{"className":"","href":"/blog/page/74","children":74}],["$","$L6","75",{"className":"","href":"/blog/page/75","children":75}],["$","$L6","76",{"className":"","href":"/blog/page/76","children":76}],["$","$L6","77",{"className":"","href":"/blog/page/77","children":77}],["$","$L6","78",{"className":"","href":"/blog/page/78","children":78}],["$","$L6","79",{"className":"","href":"/blog/page/79","children":79}],["$","$L6","80",{"className":"","href":"/blog/page/80","children":80}]]}]]}],null]}]
7:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"Patrick Desjardins Blog - Python Automated Test"}],["$","meta","3",{"name":"description","content":"Python Automated Test"}]]
1:null

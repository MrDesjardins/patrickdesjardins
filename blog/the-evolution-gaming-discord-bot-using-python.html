<!DOCTYPE html><html lang="en" class="layout_htmlstyle__PseMz"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="/images/blog/discord_bot_daily_message.png"/><link rel="preload" as="image" href="/images/blog/discord_bot_user_gaming_session.png"/><link rel="stylesheet" href="/_next/static/css/e7d5f19bb68f1da6.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/dabd5e64a469b0e1.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/43126ea28792c324.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/97e0a79122e618e4.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-ca91015db6105b80.js"/><script src="/_next/static/chunks/751ca6e4-12bba381ae91d3b3.js" async=""></script><script src="/_next/static/chunks/550-8805764b1ec93e0a.js" async=""></script><script src="/_next/static/chunks/main-app-52a6f4f48828866a.js" async=""></script><script src="/_next/static/chunks/216-16b20d9e090a995d.js" async=""></script><script src="/_next/static/chunks/394-f703103b4f0ecf75.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-afa931b67ff12386.js" async=""></script><title>Patrick Desjardins Blog - The Evolution of my Gaming Discord Bot Using Python</title><meta name="description" content="The Evolution of my Gaming Discord Bot Using Python"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="layout_bodystyle__4ncsS"><div class="layout_blogbodystyle___Uc1w"><div class="BlogBody_BlogBody__600mT"><header class="BlogBody_siteTitle__f7uyb">Patrick Desjardins Blog</header><nav><ul class="BlogBody_navLinks__ZV12t"><li class="BlogBody_navLinkItem__Pml2e"><a class="BlogBody_navLinkText__ZtH2y" href="/">Main Page</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog">Blog</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2025">2025</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2024">2024</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2023">2023</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2022">2022</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2021">2021</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2020">2020</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2019">2019</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2018">2018</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2017">2017</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2016">2016</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2015">2015</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2014">2014</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2013">2013</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2012">2012</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2011">2011</a></li></ul></nav><div class="BlogBody_blogPictureContainer__IAbPL"><img alt="Patrick Desjardins picture from a conference" loading="lazy" width="800" height="260" decoding="async" data-nimg="1" class="BlogBody_blogTopPicture__L6lao" style="color:transparent" src="/images/backgrounds/patrickdesjardins_conference_bw.webp"/></div><main class="BlogBody_main__XrdKY"><h1 class="BlogBody_heading__bYRBe">The Evolution of my Gaming Discord Bot Using Python</h1><div class="Page_blogPostContainer__AUIcf"><p class="Page_blogPostDate__wVWWB">Posted on: <!-- -->2025-01-02</p><p>I have been coding a Discord bot for about 6 months now in Python (see this introduction <a href="./blog/python-discord-bot-introduction">here</a>). I have learned a lot about the Discord API, Python, and how to manage a bot. I wanted to share my experience with you. This post will cover few features with a glimpse of the code.</p>
<h1>The Discord Bot Evolution</h1>
<h2>Inception</h2>
<p>The bot&#x27;s initial goal was to send a daily message and have people vote on the time they expected to play. For example, early every day, the bot creates a new message with one emoji per time, and users, throughout the day, vote for the hours they are available.</p>
<h2>The First Iteration: Automate the User Schedule</h2>
<p>Soon, I realized that many people do not plan, but I wanted to channel all the posts to reflect the server activity. Thus, I added a feature that checks the voice channels, collects who is playing, and automatically adds them to the time frame.</p>
<p><img src="/images/blog/discord_bot_daily_message.png" alt="Discord Bot"/></p>
<p>The feature relies mostly on the Discord API, which allows for recurrent tasks.</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line">HOUR_SEND_DAILY_MESSAGE <span class="token operator">=</span> <span class="token number">7</span>
</span><span class="code-line">local_tz <span class="token operator">=</span> pytz<span class="token punctuation">.</span>timezone<span class="token punctuation">(</span><span class="token string">&quot;America/Los_Angeles&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">time_send_daily_message <span class="token operator">=</span> time<span class="token punctuation">(</span>hour<span class="token operator">=</span>HOUR_SEND_DAILY_MESSAGE<span class="token punctuation">,</span> minute<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> second<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> tzinfo<span class="token operator">=</span>local_tz<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token comment">#...</span>
</span><span class="code-line"><span class="token decorator annotation punctuation">@tasks<span class="token punctuation">.</span>loop</span><span class="token punctuation">(</span>time<span class="token operator">=</span>time_send_daily_message<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">send_daily_question_to_all_guild_task</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;
</span></span><span class="code-line"><span class="token triple-quoted-string string"> Send only once every day the question for each guild who has the bot
</span></span><span class="code-line"><span class="token triple-quoted-string string"> &quot;&quot;&quot;</span>
</span><span class="code-line">    print_log<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Sending daily schedule message, current time </span><span class="token interpolation"><span class="token punctuation">{</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">for</span> guild <span class="token keyword">in</span> self<span class="token punctuation">.</span>bot<span class="token punctuation">.</span>guilds<span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">await</span> send_daily_question_to_a_guild<span class="token punctuation">(</span>self<span class="token punctuation">.</span>bot<span class="token punctuation">,</span> guild<span class="token punctuation">)</span>
</span></code></pre>
<p>Using the <code>@task.loop</code> removes a lot of headaches of managing recurrent tasks instead of using another asynchronous library.</p>
<h2>Getting Statistic</h2>
<p>The next natural step was to get a sense of who was playing, who was reducing their time, and other statistical information. I could understand better who to reach out to get some news or understand some dynamics in the group better. It was especially useful once the group reached above 100 members. I started saving the information into a SQLite database. Then, using Panda, I could load the data from a data range and start computing some statistics.</p>
<p>Most of the code looks like this one:</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line"><span class="token comment"># Some fetching code:</span>
</span><span class="code-line">data_user_activity<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">[</span>UserActivity<span class="token punctuation">]</span> <span class="token operator">=</span> fetch_all_user_activities<span class="token punctuation">(</span>from_day<span class="token punctuation">,</span> to_day<span class="token punctuation">)</span>
</span><span class="code-line">data_user_id_name<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">,</span> UserInfo<span class="token punctuation">]</span> <span class="token operator">=</span> fetch_user_info<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">users_by_weekday_dict<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">[</span>UserInfoWithCount<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> users_by_weekday<span class="token punctuation">(</span>data_user_activity<span class="token punctuation">,</span> data_user_id_name<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token comment"># Some matplotlib code here:</span>
</span><span class="code-line"><span class="token comment"># ...</span>
</span></code></pre>
<h2>Admin Tools</h2>
<p>Getting the latest database from the Raspberry PI to my local machine or updating the service running on my Raspberry PI was a pain. I added a few commands to the bot to help me with that. Then, the unit tests, coverage, and integration tests required other commands. Then, more statistic visualization required more commands. Thus, I created this admin tool that I could use to manage the bot.</p>
<video src="/videos/blog/discord_bot_admin_menu.mp4" controls=""></video>
<p>The admin tool relies on a third-party library called <code>simple_term_menu</code>. There are many menus available that allow you to dive deep into options. For example, the admin tool starts asking if you are running the command in the Raspberry PI (prod) or in your local machine (dev). Then, the options are different. In production, when updating the code, the admin tool stops the service, fetches the latest code, installs the dependencies, and starts the service again. In development, options for visualization, tests, or fetching the latest production data are all available.</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line"><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;First menu&quot;&quot;&quot;</span>
</span><span class="code-line"> options <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;[1] Raspberry PI&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;[2] Local&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;[q] Exit&quot;</span><span class="token punctuation">]</span>
</span><span class="code-line"> terminal_menu <span class="token operator">=</span> TerminalMenu<span class="token punctuation">(</span>options<span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">&quot;Environment&quot;</span><span class="token punctuation">,</span> show_shortcut_hints<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</span><span class="code-line"> menu_entry_index <span class="token operator">=</span> terminal_menu<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">if</span> menu_entry_index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
</span><span class="code-line">        raspberry_pi_menu<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">elif</span> menu_entry_index <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
</span><span class="code-line">        local_menu<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">elif</span> menu_entry_index <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
</span><span class="code-line"> sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</span><span class="code-line">    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre>
<h2>Voice Message Channel</h2>
<p>On my journey of adding features, I wanted to let people know they are not alone when joining a voice channel. There is always a first one to join. I added a feature that the bot would join the voice channel and play a dynamically generated message using the user name and then the schedule. The bot was mentioning out loud who was playing in the current hours, and if no one was, it would say the upcoming hour&#x27;s schedule. This feature is temporarily disabled as it was making the false impression that a human had joined the channel.</p>
<p>The feature relies on the <code>gtts</code> library that converts text to speech. The library is easy to use, and the code looks like this:</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line"><span class="token comment"># Convert text to speech using gTTS</span>
</span><span class="code-line">tts <span class="token operator">=</span> gTTS<span class="token punctuation">(</span>text_message<span class="token punctuation">,</span> lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">tts<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&quot;welcome.mp3&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># Connect to the voice channel</span>
</span><span class="code-line"><span class="token keyword">if</span> member<span class="token punctuation">.</span>guild<span class="token punctuation">.</span>voice_client <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>  <span class="token comment"># Bot isn&#x27;t already in a channel</span>
</span><span class="code-line"> voice_client <span class="token operator">=</span> <span class="token keyword">await</span> voice_channel<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">else</span><span class="token punctuation">:</span>
</span><span class="code-line"> voice_client <span class="token operator">=</span> member<span class="token punctuation">.</span>guild<span class="token punctuation">.</span>voice_client
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># Play the audio</span>
</span><span class="code-line">audio_source <span class="token operator">=</span> Discord<span class="token punctuation">.</span>FFmpegPCMAudio<span class="token punctuation">(</span><span class="token string">&quot;welcome.mp3&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">voice_client<span class="token punctuation">.</span>play<span class="token punctuation">(</span>audio_source<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># Wait for the audio to finish playing</span>
</span><span class="code-line"><span class="token keyword">while</span> voice_client<span class="token punctuation">.</span>is_playing<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">await</span> discord<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>sleep_until<span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> timedelta<span class="token punctuation">(</span>seconds<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># Disconnect after playing the audio</span>
</span><span class="code-line"><span class="token keyword">await</span> voice_client<span class="token punctuation">.</span>disconnect<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># Clean up the saved audio file</span>
</span><span class="code-line">os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token string">&quot;welcome.mp3&quot;</span><span class="token punctuation">)</span>
</span></code></pre>
<p>The <code>FFmpegPCMAudio</code> plays the audio like if the bot was talking into a microphone.</p>
<h2>Organizing Voice Channel</h2>
<p>The more people joined, the more organization was required. The game is Siege, and it is a 5v5 game. I added a feature that user, with a command, could set up their account by saying their in-game user name and, using an API on a third-party service, could figure out some statistics about the user, like their maximum rank. Then, the bot can assign a role that opens access to the different voice channels.</p>
<p>The feature relies on a UI, called &quot;View&quot; for Discord. It has a text box for the user to enter their in-game user name and a dropdown to select a time zone.</p>
<h2>Getting Player Statistics</h2>
<p>By touching the API, I found out that it could also give information about the matches. However, the API was not free and required special permission, which was denied (I suspect my bot is too little). I had to rely on the website and scrap the data. I could re-use the session by connecting once and directly accessing the data via a REST API. Then, by hooking the voice channel event, I can see if a user is leaving. In that case, I wait a few minutes to ensure the latest data is available and query the website. I get the last 12 hours&#x27; match data and create an aggregation.</p>
<p><img src="/images/blog/discord_bot_user_gaming_session.png" alt="Discord Bot Gaming Session"/></p>
<p>The feature is one of the more popular ones, as it gives a quick overview of everyone&#x27;s performance without having to leave the server.</p>
<p>Technically, it was challenging because of the many security steps in place to avoid having people scrape. I have contacted the API owner, but the communication was very broken, and I received a denial without any explanation. So, upon disconnect, I accumulate people&#x27;s names. That is a good way to get a list instead of going one by one since we need to actually open a browser. And the website detects a headless browser. Thus, we need a real browser! So, on the disconnect event, the user id is persisted in the memory cache. Then, a Discord task that runs every 5 minutes check if there is any user to query. The task opens a browser and does its job. Using Python context manager, the code is clean:</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line"><span class="token keyword">try</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">with</span> BrowserContextManager<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> context<span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">for</span> user <span class="token keyword">in</span> users<span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">try</span><span class="token punctuation">:</span>
</span><span class="code-line"> matches<span class="token punctuation">:</span> List<span class="token punctuation">[</span>UserMatchInfo<span class="token punctuation">]</span> <span class="token operator">=</span> context<span class="token punctuation">.</span>download_matches<span class="token punctuation">(</span>user<span class="token punctuation">.</span>user_info<span class="token punctuation">.</span>ubisoft_username_active<span class="token punctuation">)</span> <span class="token comment"># &lt;------ HERE it downloads the data</span>
</span><span class="code-line"> all_users_matches<span class="token punctuation">.</span>append<span class="token punctuation">(</span>UserWithUserMatchInfo<span class="token punctuation">(</span>user<span class="token punctuation">,</span> matches<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">                <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Sleep 0.5 to 2 seconds between each request</span>
</span><span class="code-line">            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
</span><span class="code-line">                print_error_log<span class="token punctuation">(</span>
</span><span class="code-line">                    <span class="token string-interpolation"><span class="token string">f&quot;post_queued_user_stats: Error getting the user (</span><span class="token interpolation"><span class="token punctuation">{</span>user<span class="token punctuation">.</span>user_info<span class="token punctuation">.</span>display_name<span class="token punctuation">}</span></span><span class="token string">) stats from R6 tracker: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span>
</span><span class="code-line">                <span class="token punctuation">)</span>
</span><span class="code-line">                <span class="token keyword">continue</span>  <span class="token comment"># Skip to the next user</span>
</span><span class="code-line"><span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
</span><span class="code-line">    print_error_log<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;post_queued_user_stats: Error opening the browser context: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</span></code></pre>
<p>The <code>BrowserContextManager</code> uses <code>selenium</code> and with <code>xvfb</code> open Chrome. The code works locally (WSL on Windows) and on the Raspberry PI.</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line"><span class="token keyword">def</span> <span class="token function">_config_browser</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;Configure the browser for headers and to receive a cookie to call future API endpoints&quot;&quot;&quot;</span>
</span><span class="code-line"> options <span class="token operator">=</span> uc<span class="token punctuation">.</span>ChromeOptions<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"> options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--no-sandbox&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"> options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--disable-dev-shm-usage&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"> options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--disable-blink-features=AutomationControlled&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"> options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--disable-gpu&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"> options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--start-maximized&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"> options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--disable-extensions&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"> options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--disable-background-networking&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"> options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;--disable-sync&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"> options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span>
</span><span class="code-line">        <span class="token string">&quot;user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.93 Safari/537.36&quot;</span>
</span><span class="code-line">    <span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"> environment_var <span class="token operator">=</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">&quot;ENV&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">if</span> environment_var <span class="token operator">==</span> <span class="token string">&quot;prod&quot;</span><span class="token punctuation">:</span>
</span><span class="code-line"> options<span class="token punctuation">.</span>binary_location <span class="token operator">=</span> <span class="token string">&quot;/usr/bin/chromium-browser&quot;</span>
</span><span class="code-line"> driver_path <span class="token operator">=</span> <span class="token string">&quot;/usr/bin/chromedriver&quot;</span>
</span><span class="code-line">        self<span class="token punctuation">.</span>driver <span class="token operator">=</span> uc<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>options<span class="token operator">=</span>options<span class="token punctuation">,</span> driver_executable_path<span class="token operator">=</span>driver_path<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">else</span><span class="token punctuation">:</span>
</span><span class="code-line"> service <span class="token operator">=</span> Service<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"> options<span class="token punctuation">.</span>binary_location <span class="token operator">=</span> <span class="token string">&quot;/usr/bin/google-chrome&quot;</span>
</span><span class="code-line"> options <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>ChromeOptions<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        self<span class="token punctuation">.</span>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>service<span class="token operator">=</span>service<span class="token punctuation">,</span> options<span class="token operator">=</span>options<span class="token punctuation">)</span>
</span><span class="code-line">    print_log<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;_config_browser: Using binary location: </span><span class="token interpolation"><span class="token punctuation">{</span>options<span class="token punctuation">.</span>binary_location<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</span></code></pre>
<p>The <code>download_match</code> uses <code>BeautifulSoup</code> to parse the data using the REST API endpoint while the configuration method uses <code>selenium</code> to open the browser and connect to the login page to get a proper session.</p>
<h2>Asking for Teammate and Information</h2>
<p>The usage of <code>@here</code> is not recommended as the community grows as it spams everyone. I added a command where it looks at who is in the voice channel and calculates the number of people needed (e.g., if two people are in the voice, the command will ask for three). Another command was introduced, which gives the timezone of the users in the voice channel, which helps determine the best host.</p>
<h2>Auto-Requesting Teammate</h2>
<p>I noticed that Discord shows the game you are playing but also provides some additional details, like if you are in a game or in the main menu. So, the bot can capture the change of event and, with a state machine, figure out if the group is missing a teammate and ready for a new match. The bot will then ask for a teammate only if needed, allowing the user to not have to ask for a teammate.</p>
<h2>Tournament</h2>
<p>One member wanted to create a 1-1 tournament. I added a tournament command to create, join, and report a loss. The bot randomly assigns people in a single elimination bracket. Upon reporting a loss, the bot figures out the tournament and match of the user and adjusts the bracket.</p>
<video src="/videos/blog/discord_bot_tournament_creation_report_lost.mp4" controls=""></video>
<p>The most technical aspect was to generate the bracket image. I used <code>pillow</code> to draw the bracket. The code is quite simple compared to my first attempt using <code>matplotlib</code>.</p>
<h1>Conclusion</h1>
<p>I have a lot of fun using Python and the Discord API. The more I use the bot, the more I find ways to improve it. Being a user helps, receiving feedback helps, and seeing the excitement of the user when a new feature is added is motivating.</p></div></main><div class="BlogBody_paginationBar__1gsMc"><div class="BlogBody_paginationTitle__H_eFX">Chronological Blog Articles by Page</div><div class="BlogBody_paginationLinks__nk8zd"><a class="" href="/blog/page/1">1</a><a class="" href="/blog/page/2">2</a><a class="" href="/blog/page/3">3</a><a class="" href="/blog/page/4">4</a><a class="" href="/blog/page/5">5</a><a class="" href="/blog/page/6">6</a><a class="" href="/blog/page/7">7</a><a class="" href="/blog/page/8">8</a><a class="" href="/blog/page/9">9</a><a class="" href="/blog/page/10">10</a><a class="" href="/blog/page/11">11</a><a class="" href="/blog/page/12">12</a><a class="" href="/blog/page/13">13</a><a class="" href="/blog/page/14">14</a><a class="" href="/blog/page/15">15</a><a class="" href="/blog/page/16">16</a><a class="" href="/blog/page/17">17</a><a class="" href="/blog/page/18">18</a><a class="" href="/blog/page/19">19</a><a class="" href="/blog/page/20">20</a><a class="" href="/blog/page/21">21</a><a class="" href="/blog/page/22">22</a><a class="" href="/blog/page/23">23</a><a class="" href="/blog/page/24">24</a><a class="" href="/blog/page/25">25</a><a class="" href="/blog/page/26">26</a><a class="" href="/blog/page/27">27</a><a class="" href="/blog/page/28">28</a><a class="" href="/blog/page/29">29</a><a class="" href="/blog/page/30">30</a><a class="" href="/blog/page/31">31</a><a class="" href="/blog/page/32">32</a><a class="" href="/blog/page/33">33</a><a class="" href="/blog/page/34">34</a><a class="" href="/blog/page/35">35</a><a class="" href="/blog/page/36">36</a><a class="" href="/blog/page/37">37</a><a class="" href="/blog/page/38">38</a><a class="" href="/blog/page/39">39</a><a class="" href="/blog/page/40">40</a><a class="" href="/blog/page/41">41</a><a class="" href="/blog/page/42">42</a><a class="" href="/blog/page/43">43</a><a class="" href="/blog/page/44">44</a><a class="" href="/blog/page/45">45</a><a class="" href="/blog/page/46">46</a><a class="" href="/blog/page/47">47</a><a class="" href="/blog/page/48">48</a><a class="" href="/blog/page/49">49</a><a class="" href="/blog/page/50">50</a><a class="" href="/blog/page/51">51</a><a class="" href="/blog/page/52">52</a><a class="" href="/blog/page/53">53</a><a class="" href="/blog/page/54">54</a><a class="" href="/blog/page/55">55</a><a class="" href="/blog/page/56">56</a><a class="" href="/blog/page/57">57</a><a class="" href="/blog/page/58">58</a><a class="" href="/blog/page/59">59</a><a class="" href="/blog/page/60">60</a><a class="" href="/blog/page/61">61</a><a class="" href="/blog/page/62">62</a><a class="" href="/blog/page/63">63</a><a class="" href="/blog/page/64">64</a><a class="" href="/blog/page/65">65</a><a class="" href="/blog/page/66">66</a><a class="" href="/blog/page/67">67</a><a class="" href="/blog/page/68">68</a><a class="" href="/blog/page/69">69</a><a class="" href="/blog/page/70">70</a><a class="" href="/blog/page/71">71</a><a class="" href="/blog/page/72">72</a><a class="" href="/blog/page/73">73</a><a class="" href="/blog/page/74">74</a><a class="" href="/blog/page/75">75</a><a class="" href="/blog/page/76">76</a><a class="" href="/blog/page/77">77</a><a class="" href="/blog/page/78">78</a><a class="" href="/blog/page/79">79</a></div></div></div></div><script src="/_next/static/chunks/webpack-ca91015db6105b80.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/e7d5f19bb68f1da6.css\",\"style\"]\n2:HL[\"/_next/static/css/dabd5e64a469b0e1.css\",\"style\"]\n3:HL[\"/_next/static/css/43126ea28792c324.css\",\"style\"]\n4:HL[\"/_next/static/css/97e0a79122e618e4.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"5:I[3679,[],\"\"]\n8:I[4670,[],\"\"]\na:I[4491,[],\"\"]\nb:I[2216,[\"216\",\"static/chunks/216-16b20d9e090a995d.js\",\"394\",\"static/chunks/394-f703103b4f0ecf75.js\",\"308\",\"static/chunks/app/blog/%5Bslug%5D/page-afa931b67ff12386.js\"],\"\"]\nd:I[1161,[],\"\"]\n9:[\"slug\",\"the-evolution-gaming-discord-bot-using-python\",\"d\"]\ne:[]\n"])</script><script>self.__next_f.push([1,"0:[\"$\",\"$L5\",null,{\"buildId\":\"sBzI3upCGWGjXb1fPM_Nv\",\"assetPrefix\":\"\",\"urlParts\":[\"\",\"blog\",\"the-evolution-gaming-discord-bot-using-python\"],\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"the-evolution-gaming-discord-bot-using-python\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"the-evolution-gaming-discord-bot-using-python\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"the-evolution-gaming-discord-bot-using-python\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L6\",\"$L7\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/43126ea28792c324.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/97e0a79122e618e4.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]],null],null]},[null,[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$9\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/dabd5e64a469b0e1.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"div\",null,{\"className\":\"layout_blogbodystyle___Uc1w\",\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]}]],null],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/e7d5f19bb68f1da6.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"layout_htmlstyle__PseMz\",\"children\":[\"$\",\"body\",null,{\"className\":\"layout_bodystyle__4ncsS\",\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"div\",null,{\"style\":{\"display\":\"flex\",\"alignItems\":\"center\",\"justifyContent\":\"center\",\"height\":\"100vh\"},\"children\":[\"$\",\"div\",null,{\"style\":{\"width\":\"50%\",\"height\":\"20%\",\"backgroundColor\":\"#ffeded\",\"borderRadius\":12,\"padding\":12,\"textAlign\":\"center\"},\"children\":[[\"$\",\"h1\",null,{\"children\":\"Not Found\"}],[\"$\",\"p\",null,{\"children\":\"Could not find requested resource\"}],[\"$\",\"$Lb\",null,{\"href\":\"/\",\"children\":\"Return Home\"}]]}]}],\"notFoundStyles\":[]}]}]}]],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$Lc\"],\"globalErrorComponent\":\"$d\",\"missingSlots\":\"$We\"}]\n"])</script><script>self.__next_f.push([1,"f:I[4394,[\"216\",\"static/chunks/216-16b20d9e090a995d.js\",\"394\",\"static/chunks/394-f703103b4f0ecf75.js\",\"308\",\"static/chunks/app/blog/%5Bslug%5D/page-afa931b67ff12386.js\"],\"Image\"]\n"])</script><script>self.__next_f.push([1,"7:[\"$\",\"div\",null,{\"className\":\"BlogBody_BlogBody__600mT\",\"children\":[[\"$\",\"header\",null,{\"className\":\"BlogBody_siteTitle__f7uyb\",\"children\":\"Patrick Desjardins Blog\"}],[\"$\",\"nav\",null,{\"children\":[\"$\",\"ul\",null,{\"className\":\"BlogBody_navLinks__ZV12t\",\"children\":[\"$\",\"li\",null,{\"className\":\"BlogBody_navLinkItem__Pml2e\",\"children\":[[\"$\",\"$Lb\",null,{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/\",\"children\":\"Main Page\"}],[\"$\",\"$Lb\",null,{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog\",\"children\":\"Blog\"}],[[\"$\",\"$Lb\",\"2025\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2025\",\"children\":2025}],[\"$\",\"$Lb\",\"2024\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2024\",\"children\":2024}],[\"$\",\"$Lb\",\"2023\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2023\",\"children\":2023}],[\"$\",\"$Lb\",\"2022\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2022\",\"children\":2022}],[\"$\",\"$Lb\",\"2021\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2021\",\"children\":2021}],[\"$\",\"$Lb\",\"2020\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2020\",\"children\":2020}],[\"$\",\"$Lb\",\"2019\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2019\",\"children\":2019}],[\"$\",\"$Lb\",\"2018\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2018\",\"children\":2018}],[\"$\",\"$Lb\",\"2017\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2017\",\"children\":2017}],[\"$\",\"$Lb\",\"2016\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2016\",\"children\":2016}],[\"$\",\"$Lb\",\"2015\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2015\",\"children\":2015}],[\"$\",\"$Lb\",\"2014\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2014\",\"children\":2014}],[\"$\",\"$Lb\",\"2013\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2013\",\"children\":2013}],[\"$\",\"$Lb\",\"2012\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2012\",\"children\":2012}],[\"$\",\"$Lb\",\"2011\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2011\",\"children\":2011}]]]}]}]}],[\"$\",\"div\",null,{\"className\":\"BlogBody_blogPictureContainer__IAbPL\",\"children\":[\"$\",\"$Lf\",null,{\"className\":\"BlogBody_blogTopPicture__L6lao\",\"alt\":\"Patrick Desjardins picture from a conference\",\"src\":\"/images/backgrounds/patrickdesjardins_conference_bw.webp\",\"width\":800,\"height\":260}]}],[\"$\",\"main\",null,{\"className\":\"BlogBody_main__XrdKY\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"BlogBody_heading__bYRBe\",\"children\":\"The Evolution of my Gaming Discord Bot Using Python\"}],[\"$\",\"div\",null,{\"className\":\"Page_blogPostContainer__AUIcf\",\"children\":[[\"$\",\"p\",null,{\"className\":\"Page_blogPostDate__wVWWB\",\"children\":[\"Posted on: \",\"2025-01-02\"]}],[[\"$\",\"p\",null,{\"children\":[\"I have been coding a Discord bot for about 6 months now in Python (see this introduction \",[\"$\",\"a\",null,{\"href\":\"./blog/python-discord-bot-introduction\",\"children\":\"here\"}],\"). I have learned a lot about the Discord API, Python, and how to manage a bot. I wanted to share my experience with you. This post will cover few features with a glimpse of the code.\"]}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"The Discord Bot Evolution\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Inception\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The bot's initial goal was to send a daily message and have people vote on the time they expected to play. For example, early every day, the bot creates a new message with one emoji per time, and users, throughout the day, vote for the hours they are available.\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"The First Iteration: Automate the User Schedule\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Soon, I realized that many people do not plan, but I wanted to channel all the posts to reflect the server activity. Thus, I added a feature that checks the voice channels, collects who is playing, and automatically adds them to the time frame.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/blog/discord_bot_daily_message.png\",\"alt\":\"Discord Bot\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The feature relies mostly on the Discord API, which allows for recurrent tasks.\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-python\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-python code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"HOUR_SEND_DAILY_MESSAGE \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"7\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"local_tz \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" pytz\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"timezone\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"America/Los_Angeles\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"time_send_daily_message \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"hour\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"HOUR_SEND_DAILY_MESSAGE\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" minute\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" second\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" tzinfo\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"local_tz\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"#...\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token decorator annotation punctuation\",\"children\":[\"@tasks\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"loop\"]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"time\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"time_send_daily_message\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"send_daily_question_to_all_guild_task\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token triple-quoted-string string\",\"children\":\"\\\"\\\"\\\"\\n\"}]]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token triple-quoted-string string\",\"children\":\" Send only once every day the question for each guild who has the bot\\n\"}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token triple-quoted-string string\",\"children\":\" \\\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    print_log\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string-interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"f\\\"Sending daily schedule message, current time \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"datetime\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"now\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"for\"}],\" guild \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"bot\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"guilds\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],\" send_daily_question_to_a_guild\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"bot\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" guild\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Using the \",[\"$\",\"code\",null,{\"children\":\"@task.loop\"}],\" removes a lot of headaches of managing recurrent tasks instead of using another asynchronous library.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Getting Statistic\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The next natural step was to get a sense of who was playing, who was reducing their time, and other statistical information. I could understand better who to reach out to get some news or understand some dynamics in the group better. It was especially useful once the group reached above 100 members. I started saving the information into a SQLite database. Then, using Panda, I could load the data from a data range and start computing some statistics.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Most of the code looks like this one:\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-python\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-python code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# Some fetching code:\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"data_user_activity\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"list\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"UserActivity\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" fetch_all_user_activities\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"from_day\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" to_day\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"data_user_id_name\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\" Dict\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"int\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" UserInfo\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" fetch_user_info\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"users_by_weekday_dict\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\" Dict\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"int\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"list\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"UserInfoWithCount\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" users_by_weekday\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"data_user_activity\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" data_user_id_name\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# Some matplotlib code here:\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# ...\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Admin Tools\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Getting the latest database from the Raspberry PI to my local machine or updating the service running on my Raspberry PI was a pain. I added a few commands to the bot to help me with that. Then, the unit tests, coverage, and integration tests required other commands. Then, more statistic visualization required more commands. Thus, I created this admin tool that I could use to manage the bot.\"}],\"\\n\",[\"$\",\"video\",null,{\"src\":\"/videos/blog/discord_bot_admin_menu.mp4\",\"controls\":true}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The admin tool relies on a third-party library called \",[\"$\",\"code\",null,{\"children\":\"simple_term_menu\"}],\". There are many menus available that allow you to dive deep into options. For example, the admin tool starts asking if you are running the command in the Raspberry PI (prod) or in your local machine (dev). Then, the options are different. In production, when updating the code, the admin tool stops the service, fetches the latest code, installs the dependencies, and starts the service again. In development, options for visualization, tests, or fetching the latest production data are all available.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-python\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-python code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"main\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token triple-quoted-string string\",\"children\":\"\\\"\\\"\\\"First menu\\\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" options \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"[1] Raspberry PI\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"[2] Local\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"[q] Exit\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" terminal_menu \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" TerminalMenu\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"options\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" title\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"Environment\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" show_shortcut_hints\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"True\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" menu_entry_index \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" terminal_menu\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"show\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" menu_entry_index \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        raspberry_pi_menu\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"elif\"}],\" menu_entry_index \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        local_menu\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"elif\"}],\" menu_entry_index \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" sys\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"exit\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    main\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Voice Message Channel\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"On my journey of adding features, I wanted to let people know they are not alone when joining a voice channel. There is always a first one to join. I added a feature that the bot would join the voice channel and play a dynamically generated message using the user name and then the schedule. The bot was mentioning out loud who was playing in the current hours, and if no one was, it would say the upcoming hour's schedule. This feature is temporarily disabled as it was making the false impression that a human had joined the channel.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The feature relies on the \",[\"$\",\"code\",null,{\"children\":\"gtts\"}],\" library that converts text to speech. The library is easy to use, and the code looks like this:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-python\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-python code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# Convert text to speech using gTTS\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"tts \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" gTTS\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"text_message\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" lang\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"en\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"tts\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"save\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"welcome.mp3\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# Connect to the voice channel\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" member\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"guild\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"voice_client \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"is\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"None\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# Bot isn't already in a channel\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" voice_client \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],\" voice_channel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"connect\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"else\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" voice_client \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" member\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"guild\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"voice_client\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# Play the audio\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"audio_source \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" Discord\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"FFmpegPCMAudio\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"welcome.mp3\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"voice_client\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"play\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"audio_source\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# Wait for the audio to finish playing\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"while\"}],\" voice_client\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"is_playing\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],\" discord\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"utils\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"sleep_until\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"datetime\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"now\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],\" timedelta\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"seconds\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# Disconnect after playing the audio\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],\" voice_client\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"disconnect\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# Clean up the saved audio file\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"os\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"remove\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"welcome.mp3\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"FFmpegPCMAudio\"}],\" plays the audio like if the bot was talking into a microphone.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Organizing Voice Channel\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The more people joined, the more organization was required. The game is Siege, and it is a 5v5 game. I added a feature that user, with a command, could set up their account by saying their in-game user name and, using an API on a third-party service, could figure out some statistics about the user, like their maximum rank. Then, the bot can assign a role that opens access to the different voice channels.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The feature relies on a UI, called \\\"View\\\" for Discord. It has a text box for the user to enter their in-game user name and a dropdown to select a time zone.\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Getting Player Statistics\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"By touching the API, I found out that it could also give information about the matches. However, the API was not free and required special permission, which was denied (I suspect my bot is too little). I had to rely on the website and scrap the data. I could re-use the session by connecting once and directly accessing the data via a REST API. Then, by hooking the voice channel event, I can see if a user is leaving. In that case, I wait a few minutes to ensure the latest data is available and query the website. I get the last 12 hours' match data and create an aggregation.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/blog/discord_bot_user_gaming_session.png\",\"alt\":\"Discord Bot Gaming Session\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The feature is one of the more popular ones, as it gives a quick overview of everyone's performance without having to leave the server.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Technically, it was challenging because of the many security steps in place to avoid having people scrape. I have contacted the API owner, but the communication was very broken, and I received a denial without any explanation. So, upon disconnect, I accumulate people's names. That is a good way to get a list instead of going one by one since we need to actually open a browser. And the website detects a headless browser. Thus, we need a real browser! So, on the disconnect event, the user id is persisted in the memory cache. Then, a Discord task that runs every 5 minutes check if there is any user to query. The task opens a browser and does its job. Using Python context manager, the code is clean:\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-python\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-python code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"try\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"with\"}],\" BrowserContextManager\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"as\"}],\" context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"for\"}],\" user \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" users\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"try\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" matches\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\" List\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"UserMatchInfo\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" context\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"download_matches\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"user\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"user_info\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"ubisoft_username_active\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# \u003c------ HERE it downloads the data\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" all_users_matches\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"append\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"UserWithUserMatchInfo\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"user\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" matches\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"len\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"users\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],\" asyncio\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"sleep\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"random\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"uniform\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0.5\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# Sleep 0.5 to 2 seconds between each request\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"except\"}],\" Exception \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"as\"}],\" e\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                print_error_log\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                    \",[\"$\",\"span\",null,{\"className\":\"token string-interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"f\\\"post_queued_user_stats: Error getting the user (\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"user\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"user_info\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"display_name\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\") stats from R6 tracker: \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"e\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"continue\"}],\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# Skip to the next user\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"except\"}],\" Exception \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"as\"}],\" e\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    print_error_log\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string-interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"f\\\"post_queued_user_stats: Error opening the browser context: \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"e\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"BrowserContextManager\"}],\" uses \",[\"$\",\"code\",null,{\"children\":\"selenium\"}],\" and with \",[\"$\",\"code\",null,{\"children\":\"xvfb\"}],\" open Chrome. The code works locally (WSL on Windows) and on the Raspberry PI.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-python\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-python code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"_config_browser\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"None\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token triple-quoted-string string\",\"children\":\"\\\"\\\"\\\"Configure the browser for headers and to receive a cookie to call future API endpoints\\\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" options \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" uc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"ChromeOptions\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" options\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"add_argument\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"--no-sandbox\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" options\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"add_argument\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"--disable-dev-shm-usage\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" options\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"add_argument\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"--disable-blink-features=AutomationControlled\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" options\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"add_argument\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"--disable-gpu\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" options\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"add_argument\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"--start-maximized\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" options\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"add_argument\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"--disable-extensions\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" options\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"add_argument\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"--disable-background-networking\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" options\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"add_argument\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"--disable-sync\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" options\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"add_argument\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.93 Safari/537.36\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" environment_var \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" os\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"getenv\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"ENV\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" environment_var \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"prod\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" options\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"binary_location \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"/usr/bin/chromium-browser\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" driver_path \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"/usr/bin/chromedriver\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"driver \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" uc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Chrome\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"options\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"options\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" driver_executable_path\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"driver_path\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"else\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" service \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" Service\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" options\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"binary_location \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"/usr/bin/google-chrome\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" options \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" webdriver\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"ChromeOptions\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"driver \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" webdriver\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Chrome\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"service\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"service\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" options\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"options\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    print_log\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string-interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"f\\\"_config_browser: Using binary location: \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"options\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"binary_location\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"download_match\"}],\" uses \",[\"$\",\"code\",null,{\"children\":\"BeautifulSoup\"}],\" to parse the data using the REST API endpoint while the configuration method uses \",[\"$\",\"code\",null,{\"children\":\"selenium\"}],\" to open the browser and connect to the login page to get a proper session.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Asking for Teammate and Information\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The usage of \",[\"$\",\"code\",null,{\"children\":\"@here\"}],\" is not recommended as the community grows as it spams everyone. I added a command where it looks at who is in the voice channel and calculates the number of people needed (e.g., if two people are in the voice, the command will ask for three). Another command was introduced, which gives the timezone of the users in the voice channel, which helps determine the best host.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Auto-Requesting Teammate\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"I noticed that Discord shows the game you are playing but also provides some additional details, like if you are in a game or in the main menu. So, the bot can capture the change of event and, with a state machine, figure out if the group is missing a teammate and ready for a new match. The bot will then ask for a teammate only if needed, allowing the user to not have to ask for a teammate.\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Tournament\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"One member wanted to create a 1-1 tournament. I added a tournament command to create, join, and report a loss. The bot randomly assigns people in a single elimination bracket. Upon reporting a loss, the bot figures out the tournament and match of the user and adjusts the bracket.\"}],\"\\n\",[\"$\",\"video\",null,{\"src\":\"/videos/blog/discord_bot_tournament_creation_report_lost.mp4\",\"controls\":true}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The most technical aspect was to generate the bracket image. I used \",[\"$\",\"code\",null,{\"children\":\"pillow\"}],\" to draw the bracket. The code is quite simple compared to my first attempt using \",[\"$\",\"code\",null,{\"children\":\"matplotlib\"}],\".\"]}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"Conclusion\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"I have a lot of fun using Python and the Discord API. The more I use the bot, the more I find ways to improve it. Being a user helps, receiving feedback helps, and seeing the excitement of the user when a new feature is added is motivating.\"}]]]}]]}],[\"$\",\"div\",null,{\"className\":\"BlogBody_paginationBar__1gsMc\",\"children\":[[\"$\",\"div\",null,{\"className\":\"BlogBody_paginationTitle__H_eFX\",\"children\":\"Chronological Blog Articles by Page\"}],[\"$\",\"div\",null,{\"className\":\"BlogBody_paginationLinks__nk8zd\",\"children\":[[\"$\",\"$Lb\",\"1\",{\"className\":\"\",\"href\":\"/blog/page/1\",\"children\":1}],[\"$\",\"$Lb\",\"2\",{\"className\":\"\",\"href\":\"/blog/page/2\",\"children\":2}],[\"$\",\"$Lb\",\"3\",{\"className\":\"\",\"href\":\"/blog/page/3\",\"children\":3}],[\"$\",\"$Lb\",\"4\",{\"className\":\"\",\"href\":\"/blog/page/4\",\"children\":4}],[\"$\",\"$Lb\",\"5\",{\"className\":\"\",\"href\":\"/blog/page/5\",\"children\":5}],[\"$\",\"$Lb\",\"6\",{\"className\":\"\",\"href\":\"/blog/page/6\",\"children\":6}],[\"$\",\"$Lb\",\"7\",{\"className\":\"\",\"href\":\"/blog/page/7\",\"children\":7}],[\"$\",\"$Lb\",\"8\",{\"className\":\"\",\"href\":\"/blog/page/8\",\"children\":8}],[\"$\",\"$Lb\",\"9\",{\"className\":\"\",\"href\":\"/blog/page/9\",\"children\":9}],[\"$\",\"$Lb\",\"10\",{\"className\":\"\",\"href\":\"/blog/page/10\",\"children\":10}],[\"$\",\"$Lb\",\"11\",{\"className\":\"\",\"href\":\"/blog/page/11\",\"children\":11}],[\"$\",\"$Lb\",\"12\",{\"className\":\"\",\"href\":\"/blog/page/12\",\"children\":12}],[\"$\",\"$Lb\",\"13\",{\"className\":\"\",\"href\":\"/blog/page/13\",\"children\":13}],[\"$\",\"$Lb\",\"14\",{\"className\":\"\",\"href\":\"/blog/page/14\",\"children\":14}],[\"$\",\"$Lb\",\"15\",{\"className\":\"\",\"href\":\"/blog/page/15\",\"children\":15}],[\"$\",\"$Lb\",\"16\",{\"className\":\"\",\"href\":\"/blog/page/16\",\"children\":16}],[\"$\",\"$Lb\",\"17\",{\"className\":\"\",\"href\":\"/blog/page/17\",\"children\":17}],[\"$\",\"$Lb\",\"18\",{\"className\":\"\",\"href\":\"/blog/page/18\",\"children\":18}],[\"$\",\"$Lb\",\"19\",{\"className\":\"\",\"href\":\"/blog/page/19\",\"children\":19}],[\"$\",\"$Lb\",\"20\",{\"className\":\"\",\"href\":\"/blog/page/20\",\"children\":20}],[\"$\",\"$Lb\",\"21\",{\"className\":\"\",\"href\":\"/blog/page/21\",\"children\":21}],[\"$\",\"$Lb\",\"22\",{\"className\":\"\",\"href\":\"/blog/page/22\",\"children\":22}],[\"$\",\"$Lb\",\"23\",{\"className\":\"\",\"href\":\"/blog/page/23\",\"children\":23}],[\"$\",\"$Lb\",\"24\",{\"className\":\"\",\"href\":\"/blog/page/24\",\"children\":24}],[\"$\",\"$Lb\",\"25\",{\"className\":\"\",\"href\":\"/blog/page/25\",\"children\":25}],[\"$\",\"$Lb\",\"26\",{\"className\":\"\",\"href\":\"/blog/page/26\",\"children\":26}],[\"$\",\"$Lb\",\"27\",{\"className\":\"\",\"href\":\"/blog/page/27\",\"children\":27}],[\"$\",\"$Lb\",\"28\",{\"className\":\"\",\"href\":\"/blog/page/28\",\"children\":28}],[\"$\",\"$Lb\",\"29\",{\"className\":\"\",\"href\":\"/blog/page/29\",\"children\":29}],[\"$\",\"$Lb\",\"30\",{\"className\":\"\",\"href\":\"/blog/page/30\",\"children\":30}],[\"$\",\"$Lb\",\"31\",{\"className\":\"\",\"href\":\"/blog/page/31\",\"children\":31}],[\"$\",\"$Lb\",\"32\",{\"className\":\"\",\"href\":\"/blog/page/32\",\"children\":32}],[\"$\",\"$Lb\",\"33\",{\"className\":\"\",\"href\":\"/blog/page/33\",\"children\":33}],[\"$\",\"$Lb\",\"34\",{\"className\":\"\",\"href\":\"/blog/page/34\",\"children\":34}],[\"$\",\"$Lb\",\"35\",{\"className\":\"\",\"href\":\"/blog/page/35\",\"children\":35}],[\"$\",\"$Lb\",\"36\",{\"className\":\"\",\"href\":\"/blog/page/36\",\"children\":36}],[\"$\",\"$Lb\",\"37\",{\"className\":\"\",\"href\":\"/blog/page/37\",\"children\":37}],[\"$\",\"$Lb\",\"38\",{\"className\":\"\",\"href\":\"/blog/page/38\",\"children\":38}],[\"$\",\"$Lb\",\"39\",{\"className\":\"\",\"href\":\"/blog/page/39\",\"children\":39}],[\"$\",\"$Lb\",\"40\",{\"className\":\"\",\"href\":\"/blog/page/40\",\"children\":40}],[\"$\",\"$Lb\",\"41\",{\"className\":\"\",\"href\":\"/blog/page/41\",\"children\":41}],[\"$\",\"$Lb\",\"42\",{\"className\":\"\",\"href\":\"/blog/page/42\",\"children\":42}],[\"$\",\"$Lb\",\"43\",{\"className\":\"\",\"href\":\"/blog/page/43\",\"children\":43}],[\"$\",\"$Lb\",\"44\",{\"className\":\"\",\"href\":\"/blog/page/44\",\"children\":44}],[\"$\",\"$Lb\",\"45\",{\"className\":\"\",\"href\":\"/blog/page/45\",\"children\":45}],[\"$\",\"$Lb\",\"46\",{\"className\":\"\",\"href\":\"/blog/page/46\",\"children\":46}],[\"$\",\"$Lb\",\"47\",{\"className\":\"\",\"href\":\"/blog/page/47\",\"children\":47}],[\"$\",\"$Lb\",\"48\",{\"className\":\"\",\"href\":\"/blog/page/48\",\"children\":48}],[\"$\",\"$Lb\",\"49\",{\"className\":\"\",\"href\":\"/blog/page/49\",\"children\":49}],[\"$\",\"$Lb\",\"50\",{\"className\":\"\",\"href\":\"/blog/page/50\",\"children\":50}],[\"$\",\"$Lb\",\"51\",{\"className\":\"\",\"href\":\"/blog/page/51\",\"children\":51}],[\"$\",\"$Lb\",\"52\",{\"className\":\"\",\"href\":\"/blog/page/52\",\"children\":52}],[\"$\",\"$Lb\",\"53\",{\"className\":\"\",\"href\":\"/blog/page/53\",\"children\":53}],[\"$\",\"$Lb\",\"54\",{\"className\":\"\",\"href\":\"/blog/page/54\",\"children\":54}],[\"$\",\"$Lb\",\"55\",{\"className\":\"\",\"href\":\"/blog/page/55\",\"children\":55}],[\"$\",\"$Lb\",\"56\",{\"className\":\"\",\"href\":\"/blog/page/56\",\"children\":56}],[\"$\",\"$Lb\",\"57\",{\"className\":\"\",\"href\":\"/blog/page/57\",\"children\":57}],[\"$\",\"$Lb\",\"58\",{\"className\":\"\",\"href\":\"/blog/page/58\",\"children\":58}],[\"$\",\"$Lb\",\"59\",{\"className\":\"\",\"href\":\"/blog/page/59\",\"children\":59}],[\"$\",\"$Lb\",\"60\",{\"className\":\"\",\"href\":\"/blog/page/60\",\"children\":60}],[\"$\",\"$Lb\",\"61\",{\"className\":\"\",\"href\":\"/blog/page/61\",\"children\":61}],[\"$\",\"$Lb\",\"62\",{\"className\":\"\",\"href\":\"/blog/page/62\",\"children\":62}],[\"$\",\"$Lb\",\"63\",{\"className\":\"\",\"href\":\"/blog/page/63\",\"children\":63}],[\"$\",\"$Lb\",\"64\",{\"className\":\"\",\"href\":\"/blog/page/64\",\"children\":64}],[\"$\",\"$Lb\",\"65\",{\"className\":\"\",\"href\":\"/blog/page/65\",\"children\":65}],[\"$\",\"$Lb\",\"66\",{\"className\":\"\",\"href\":\"/blog/page/66\",\"children\":66}],[\"$\",\"$Lb\",\"67\",{\"className\":\"\",\"href\":\"/blog/page/67\",\"children\":67}],[\"$\",\"$Lb\",\"68\",{\"className\":\"\",\"href\":\"/blog/page/68\",\"children\":68}],[\"$\",\"$Lb\",\"69\",{\"className\":\"\",\"href\":\"/blog/page/69\",\"children\":69}],[\"$\",\"$Lb\",\"70\",{\"className\":\"\",\"href\":\"/blog/page/70\",\"children\":70}],[\"$\",\"$Lb\",\"71\",{\"className\":\"\",\"href\":\"/blog/page/71\",\"children\":71}],[\"$\",\"$Lb\",\"72\",{\"className\":\"\",\"href\":\"/blog/page/72\",\"children\":72}],[\"$\",\"$Lb\",\"73\",{\"className\":\"\",\"href\":\"/blog/page/73\",\"children\":73}],[\"$\",\"$Lb\",\"74\",{\"className\":\"\",\"href\":\"/blog/page/74\",\"children\":74}],[\"$\",\"$Lb\",\"75\",{\"className\":\"\",\"href\":\"/blog/page/75\",\"children\":75}],[\"$\",\"$Lb\",\"76\",{\"className\":\"\",\"href\":\"/blog/page/76\",\"children\":76}],[\"$\",\"$Lb\",\"77\",{\"className\":\"\",\"href\":\"/blog/page/77\",\"children\":77}],[\"$\",\"$Lb\",\"78\",{\"className\":\"\",\"href\":\"/blog/page/78\",\"children\":78}],[\"$\",\"$Lb\",\"79\",{\"className\":\"\",\"href\":\"/blog/page/79\",\"children\":79}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Patrick Desjardins Blog - The Evolution of my Gaming Discord Bot Using Python\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"The Evolution of my Gaming Discord Bot Using Python\"}]]\n6:null\n"])</script></body></html>
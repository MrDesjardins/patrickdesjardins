<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/4f3d065c9e2d01e0.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/8ea1dcbe6e4b9929.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-c94468cbefcc94b8.js" crossorigin=""/><script src="/_next/static/chunks/fd9d1056-cc48c28d170fddc2.js" async="" crossorigin=""></script><script src="/_next/static/chunks/69-c7efea4b65083e7f.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-f550f103b66f998a.js" async="" crossorigin=""></script><script src="/_next/static/chunks/250-d7e0a94ebe194dac.js" async=""></script><script src="/_next/static/chunks/79-2d03397107aae3f1.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-6ef1cad01f05dc10.js" async=""></script><title>Patrick Desjardins Blog - How to have MsTest localized by Attribute?</title><meta name="description" content="How to have MsTest localized by Attribute?"/><meta name="next-size-adjust"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body class="layout_bodystyle__4ncsS"><div class="__className_aaf875"><div class="layout_container__Tovb9"><header class="layout_siteTitle__k5U8g">Patrick Desjardins Blog</header><nav><ul class="layout_navLinks__mf70r"><li class="layout_navLinkItem__1L8fB"><a class="layout_navLinkText__bt28R" href="/">Main Page</a><a class="layout_navLinkText__bt28R" href="/blog">Blog</a><a class="layout_navLinkText__bt28R" href="/blog/for/2024">2024</a><a class="layout_navLinkText__bt28R" href="/blog/for/2023">2023</a><a class="layout_navLinkText__bt28R" href="/blog/for/2022">2022</a><a class="layout_navLinkText__bt28R" href="/blog/for/2021">2021</a><a class="layout_navLinkText__bt28R" href="/blog/for/2020">2020</a><a class="layout_navLinkText__bt28R" href="/blog/for/2019">2019</a><a class="layout_navLinkText__bt28R" href="/blog/for/2018">2018</a><a class="layout_navLinkText__bt28R" href="/blog/for/2017">2017</a><a class="layout_navLinkText__bt28R" href="/blog/for/2016">2016</a><a class="layout_navLinkText__bt28R" href="/blog/for/2015">2015</a><a class="layout_navLinkText__bt28R" href="/blog/for/2014">2014</a><a class="layout_navLinkText__bt28R" href="/blog/for/2013">2013</a><a class="layout_navLinkText__bt28R" href="/blog/for/2012">2012</a><a class="layout_navLinkText__bt28R" href="/blog/for/2011">2011</a></li></ul></nav><div class="layout_blogPictureContainer__XC7nK"><img alt="Patrick Desjardins picture from a conference" loading="lazy" width="800" height="260" decoding="async" data-nimg="1" class="layout_blogTopPicture__RJHNN" style="color:transparent" src="/images/backgrounds/patrickdesjardins_conference_bw.jpeg"/></div><main class="layout_main__mXTwS"><h1>How to have MsTest localized by Attribute?</h1><div class="layout_blogPostContainer__WYELx"><p class="layout_blogPostDate__LUvx5">Posted on: <!-- -->2016-01-12</p><p>Working with multiple languages requires to test in multiple languages too. A simple use case is if you have custom Asp.Net routing that you might want to test where an English route goes and the same for a French one. This goes beyond just text, but also how to handle numbers and datetime. The traditional way to do unit test in multiple localisations is to set the current thread at the beginning of the test, do the logic, assert and set the thread back to the original value.</p>
<p>The problem is that in all your code you need to set the thread manually. It would be better to have an attribute on the top of the test method and have this one handling the thread culture. Unfortunately, MSTest &quot;TestMethod&quot; attributes is sealed which mean you cannot inherit of this one. The work around is to create a custom attribute. However, this come with the challenge to hook into MsTest pipeline to have MsTest reads the attribute and act accordingly. This is what we will discuss in this article, how to use <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>ContextAttribute</span></span></code></span>, <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>IMessageSink</span></span></code></span>, <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>IContributeObjectSink</span></span></code></span> and so on.</p>
<p>First, let&#x27;s create a standard attribute that we will use on top of our test that need localization. We will use this one in combination of the TestMethod. The use will looks like this:</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="csharp" data-theme="github-dark-dimmed"><code data-language="csharp" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#ADBAC7"> [</span><span style="color:#F69D50">TestMethod</span><span style="color:#ADBAC7">] [</span><span style="color:#F69D50">LocalizedTest</span><span style="color:#ADBAC7">(LocalizedSection.EN_NAME)] </span><span style="color:#F47067">public</span><span style="color:#F47067"> void</span><span style="color:#DCBDFB"> MyTest</span><span style="color:#ADBAC7">() { </span><span style="color:#768390">//... Your test } </span></span></code></pre></figure>
<p>The attribute has a parameter which is the <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>Culture Name</span></span></code></span> that we want to have the thread. The culture name is &quot;en-us&quot; for USA English or &quot;fr-ca&quot; Canadian French.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="csharp" data-theme="github-dark-dimmed"><code data-language="csharp" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#F47067"> public</span><span style="color:#F47067"> class</span><span style="color:#F69D50"> LocalizedTestAttribute</span><span style="color:#ADBAC7">:</span><span style="color:#F69D50">Attribute</span><span style="color:#ADBAC7"> { </span><span style="color:#F47067">public</span><span style="color:#F47067"> string</span><span style="color:#F69D50"> CultureName</span><span style="color:#ADBAC7"> {</span><span style="color:#F47067">get</span><span style="color:#ADBAC7">; </span><span style="color:#F47067">set</span><span style="color:#ADBAC7">;} </span><span style="color:#F47067">public</span><span style="color:#DCBDFB"> LocalizedTestAttribute</span><span style="color:#ADBAC7">(</span><span style="color:#F47067">string</span><span style="color:#F69D50"> cultureName</span><span style="color:#ADBAC7">) { </span><span style="color:#6CB6FF">this</span><span style="color:#ADBAC7">.CultureName </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> cultureName; } } </span></span></code></pre></figure>
<p>A second attribute is required to be at the top of the class tested. This is the way to notify the Microsoft test framework that we want to hook inside the pipeline of tasks that the testing framework is going while executing tests. This attribute inherit from <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>ContextAttribute</span></span></code></span>, from <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>System.Runtime.Remoting.Contexts</span></span></code></span> namespace. The role of that class is to define a collection of possible hooks. In that case, we have only one hook that we call <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>LocalizedTestMessage</span></span></code></span>. Those hooks are called &quot;messages&quot;. I am using a helper named TestProperty which handle generic code for every message. This generic class is inspired by the <a href="http://mstestextensions.codeplex.com/SourceControl/latest#Trunk/Source/MSTestExtensions/TestAspect.cs">MsTestExtension</a> source code.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="csharp" data-theme="github-dark-dimmed"><code data-language="csharp" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#F47067"> public</span><span style="color:#F47067"> class</span><span style="color:#F69D50"> LocalizedTestContextAttribute</span><span style="color:#ADBAC7">: </span><span style="color:#F69D50">ContextAttribute</span><span style="color:#ADBAC7"> { </span><span style="color:#F47067">public</span><span style="color:#DCBDFB"> LocalizedTestContextAttribute</span><span style="color:#ADBAC7">():</span><span style="color:#6CB6FF">base</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;LocalizedTest&quot;</span><span style="color:#ADBAC7">) {</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#ADBAC7">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">public</span><span style="color:#F47067"> override</span><span style="color:#F47067"> void</span><span style="color:#DCBDFB"> GetPropertiesForNewContext</span><span style="color:#ADBAC7">(</span><span style="color:#F69D50">IConstructionCallMessage</span><span style="color:#F69D50"> msg</span><span style="color:#ADBAC7">) {</span></span>
<span data-line=""><span style="color:#F47067">   if</span><span style="color:#ADBAC7"> (msg </span><span style="color:#F47067">==</span><span style="color:#6CB6FF"> null</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">throw</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> ArgumentNullException</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;msg&quot;</span><span style="color:#ADBAC7">); </span></span>
<span data-line=""><span style="color:#ADBAC7">  msg.ContextProperties.</span><span style="color:#DCBDFB">Add</span><span style="color:#ADBAC7">(</span><span style="color:#F47067">new</span><span style="color:#F69D50"> TestProperty</span><span style="color:#ADBAC7">&lt;</span><span style="color:#F69D50">LocalizedTestMessage</span><span style="color:#ADBAC7">&gt;()); </span><span style="color:#768390">//We add 1 new message into the test pipeline </span></span>
<span data-line=""><span style="color:#ADBAC7">} }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">public</span><span style="color:#F47067"> class</span><span style="color:#F69D50"> TestProperty</span><span style="color:#ADBAC7">&lt;</span><span style="color:#F69D50">T</span><span style="color:#ADBAC7">&gt; : </span><span style="color:#F69D50">IContextProperty</span><span style="color:#ADBAC7">, </span><span style="color:#F69D50">IContributeObjectSink</span><span style="color:#F47067"> where</span><span style="color:#F69D50"> T</span><span style="color:#ADBAC7"> : </span><span style="color:#F69D50">IMessageSink</span><span style="color:#ADBAC7">, </span><span style="color:#F69D50">ITestMessage</span><span style="color:#ADBAC7">, </span><span style="color:#F47067">new</span><span style="color:#ADBAC7">() {</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">private</span><span style="color:#F47067"> readonly</span><span style="color:#ADBAC7"> string_name </span><span style="color:#F47067">=</span><span style="color:#F47067"> typeof</span><span style="color:#ADBAC7">(</span><span style="color:#F69D50">T</span><span style="color:#ADBAC7">).AssemblyQualifiedName;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#ADBAC7">[</span><span style="color:#F69D50">SecurityPermission</span><span style="color:#ADBAC7">(SecurityAction.LinkDemand, </span><span style="color:#F69D50">Flags</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> SecurityPermissionFlag.Infrastructure)] </span><span style="color:#F47067">public</span><span style="color:#F47067"> bool</span><span style="color:#DCBDFB"> IsNewContextOK</span><span style="color:#ADBAC7">(</span><span style="color:#F69D50">Context</span><span style="color:#F69D50"> newCtx</span><span style="color:#ADBAC7">) { </span><span style="color:#F47067">return</span><span style="color:#6CB6FF"> true</span><span style="color:#ADBAC7">; }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#ADBAC7">[</span><span style="color:#F69D50">SecurityPermission</span><span style="color:#ADBAC7">(SecurityAction.LinkDemand, </span><span style="color:#F69D50">Flags</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> SecurityPermissionFlag.Infrastructure)] </span><span style="color:#F47067">public</span><span style="color:#F47067"> void</span><span style="color:#DCBDFB"> Freeze</span><span style="color:#ADBAC7">(</span><span style="color:#F69D50">Context</span><span style="color:#F69D50"> newContext</span><span style="color:#ADBAC7">) { }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">public</span><span style="color:#F47067"> string</span><span style="color:#F69D50"> Name</span><span style="color:#ADBAC7"> { [</span><span style="color:#F69D50">SecurityPermission</span><span style="color:#ADBAC7">(SecurityAction.LinkDemand, </span><span style="color:#F69D50">Flags</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> SecurityPermissionFlag.Infrastructure)] </span><span style="color:#F47067">get</span><span style="color:#ADBAC7"> { return_name; } }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#ADBAC7">[</span><span style="color:#F69D50">SecurityPermission</span><span style="color:#ADBAC7">(SecurityAction.LinkDemand, </span><span style="color:#F69D50">Flags</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> SecurityPermissionFlag.Infrastructure)] </span><span style="color:#F47067">public</span><span style="color:#F69D50"> IMessageSink</span><span style="color:#DCBDFB"> GetObjectSink</span><span style="color:#ADBAC7">(</span><span style="color:#F69D50">MarshalByRefObject</span><span style="color:#F69D50"> obj</span><span style="color:#ADBAC7">, </span><span style="color:#F69D50">IMessageSink</span><span style="color:#F69D50"> nextSink</span><span style="color:#ADBAC7">) { </span><span style="color:#F69D50">T</span><span style="color:#F69D50"> testAspect</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> T</span><span style="color:#ADBAC7">(); testAspect.</span><span style="color:#DCBDFB">AddMessageSink</span><span style="color:#ADBAC7">(nextSink); </span><span style="color:#F47067">return</span><span style="color:#ADBAC7"> testAspect; } }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">public</span><span style="color:#F47067"> interface</span><span style="color:#F69D50"> ITestMessage</span><span style="color:#ADBAC7"> { </span><span style="color:#F47067">void</span><span style="color:#DCBDFB"> AddMessageSink</span><span style="color:#ADBAC7">(</span><span style="color:#F69D50">IMessageSink</span><span style="color:#F69D50"> messageSink</span><span style="color:#ADBAC7">); } </span></span></code></pre></figure>
<p>Finally, we need to have our LocalizedTest message hook (message) defined. This class defines what is done before and after the execution of the test. This class is able to access the tested method to check if <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed" style="background-color:#22272e;color:#adbac7"><span data-line=""><span>LocalizedTest</span></span></code></span> attribute is defined on the class. If yes, it proceeds, otherwise it executes the method without changing anything. When the attribute is present, it backup the current thread culture, get the culture name from the attribute and set it to the test thread. It executes the test, and set back the original thread.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="csharp" data-theme="github-dark-dimmed"><code data-language="csharp" data-theme="github-dark-dimmed" style="display:grid"><span data-line=""><span style="color:#F47067"> public</span><span style="color:#F47067"> class</span><span style="color:#F69D50"> LocalizedTestMessage</span><span style="color:#ADBAC7"> : </span><span style="color:#F69D50">BaseTestMessage</span><span style="color:#ADBAC7">&lt;</span><span style="color:#F69D50">LocalizedTestAttribute</span><span style="color:#ADBAC7">&gt;, </span><span style="color:#F69D50">IMessageSink</span><span style="color:#ADBAC7">, </span><span style="color:#F69D50">ITestMessage</span><span style="color:#ADBAC7"> { </span><span style="color:#F47067">private</span><span style="color:#F69D50"> IMessageSink</span><span style="color:#F69D50"> nextSink</span><span style="color:#ADBAC7">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#ADBAC7">[</span><span style="color:#F69D50">SecurityPermission</span><span style="color:#ADBAC7">(SecurityAction.LinkDemand, </span><span style="color:#F69D50">Flags</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> SecurityPermissionFlag.Infrastructure)] </span><span style="color:#F47067">public</span><span style="color:#F69D50"> IMessage</span><span style="color:#DCBDFB"> SyncProcessMessage</span><span style="color:#ADBAC7">(</span><span style="color:#F69D50">IMessage</span><span style="color:#F69D50"> msg</span><span style="color:#ADBAC7">) { </span><span style="color:#F47067">if</span><span style="color:#ADBAC7"> (msg </span><span style="color:#F47067">==</span><span style="color:#6CB6FF"> null</span><span style="color:#ADBAC7">) </span><span style="color:#F47067">throw</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> ArgumentNullException</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;msg&quot;</span><span style="color:#ADBAC7">); </span><span style="color:#F69D50">CultureInfo</span><span style="color:#F69D50"> currentCultureInfo</span><span style="color:#F47067"> =</span><span style="color:#6CB6FF"> null</span><span style="color:#ADBAC7">; </span><span style="color:#F69D50">CultureInfo</span><span style="color:#F69D50"> currentUICultureInfo</span><span style="color:#F47067"> =</span><span style="color:#6CB6FF"> null</span><span style="color:#ADBAC7">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#768390">//Before test get value to set back after test </span></span>
<span data-line=""><span style="color:#F69D50">LocalizedTestAttribute</span><span style="color:#F69D50"> localizationAttribute</span><span style="color:#F47067"> =</span><span style="color:#6CB6FF"> base</span><span style="color:#ADBAC7">.</span><span style="color:#DCBDFB">GetAttribute</span><span style="color:#ADBAC7">(msg); </span><span style="color:#F47067">if</span><span style="color:#ADBAC7"> (localizationAttribute </span><span style="color:#F47067">!=</span><span style="color:#6CB6FF"> null</span><span style="color:#ADBAC7">) { currentCultureInfo </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> System.Threading.Thread.CurrentThread.CurrentCulture; currentUICultureInfo </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> System.Threading.Thread.CurrentThread.CurrentUICulture; System.Threading.Thread.CurrentThread.CurrentCulture </span><span style="color:#F47067">=</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> System</span><span style="color:#ADBAC7">.</span><span style="color:#F69D50">Globalization</span><span style="color:#ADBAC7">.</span><span style="color:#F69D50">CultureInfo</span><span style="color:#ADBAC7">(localizationAttribute.CultureName); System.Threading.Thread.CurrentThread.CurrentUICulture </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> System.Threading.Thread.CurrentThread.CurrentCulture; }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#768390">//Execute test </span></span>
<span data-line=""><span style="color:#F69D50">IMessage</span><span style="color:#F69D50"> returnMessage</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> nextSink.</span><span style="color:#DCBDFB">SyncProcessMessage</span><span style="color:#ADBAC7">(msg);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#768390">//After test set back value </span></span>
<span data-line=""><span style="color:#F47067">if</span><span style="color:#ADBAC7"> (localizationAttribute </span><span style="color:#F47067">!=</span><span style="color:#6CB6FF"> null</span><span style="color:#F47067"> &amp;&amp;</span><span style="color:#ADBAC7"> currentCultureInfo</span><span style="color:#F47067">!=</span><span style="color:#6CB6FF"> null</span><span style="color:#F47067"> &amp;&amp;</span><span style="color:#ADBAC7"> currentUICultureInfo</span><span style="color:#F47067">!=</span><span style="color:#6CB6FF">null</span><span style="color:#ADBAC7">) { System.Threading.Thread.CurrentThread.CurrentCulture </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> currentCultureInfo; System.Threading.Thread.CurrentThread.CurrentUICulture </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> currentUICultureInfo; } </span><span style="color:#F47067">return</span><span style="color:#ADBAC7"> returnMessage; }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#ADBAC7">[</span><span style="color:#F69D50">SecurityPermission</span><span style="color:#ADBAC7">(SecurityAction.LinkDemand, </span><span style="color:#F69D50">Flags</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> SecurityPermissionFlag.Infrastructure)] </span><span style="color:#F47067">public</span><span style="color:#F69D50"> IMessageCtrl</span><span style="color:#DCBDFB"> AsyncProcessMessage</span><span style="color:#ADBAC7">(</span><span style="color:#F69D50">IMessage</span><span style="color:#F69D50"> msg</span><span style="color:#ADBAC7">, </span><span style="color:#F69D50">IMessageSink</span><span style="color:#F69D50"> replySink</span><span style="color:#ADBAC7">) { </span><span style="color:#F47067">throw</span><span style="color:#F47067"> new</span><span style="color:#F69D50"> InvalidOperationException</span><span style="color:#ADBAC7">(); }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">public</span><span style="color:#F69D50"> IMessageSink</span><span style="color:#F69D50"> NextSink</span><span style="color:#ADBAC7"> { [</span><span style="color:#F69D50">SecurityPermission</span><span style="color:#ADBAC7">(SecurityAction.LinkDemand, </span><span style="color:#F69D50">Flags</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> SecurityPermissionFlag.Infrastructure)] </span><span style="color:#F47067">get</span><span style="color:#ADBAC7"> { </span><span style="color:#F47067">return</span><span style="color:#ADBAC7"> nextSink; } }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">public</span><span style="color:#F47067"> void</span><span style="color:#DCBDFB"> AddMessageSink</span><span style="color:#ADBAC7">(</span><span style="color:#F69D50">IMessageSink</span><span style="color:#F69D50"> messageSink</span><span style="color:#ADBAC7">) { nextSink </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> messageSink; } }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F47067">public</span><span style="color:#F47067"> abstract</span><span style="color:#F47067"> class</span><span style="color:#F69D50"> BaseTestMessage</span><span style="color:#ADBAC7">&lt;</span><span style="color:#F69D50">TAttribute</span><span style="color:#ADBAC7">&gt; </span><span style="color:#F47067">where</span><span style="color:#F69D50"> TAttribute</span><span style="color:#ADBAC7"> : </span><span style="color:#F69D50">Attribute</span><span style="color:#ADBAC7"> {</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#ADBAC7">[</span><span style="color:#F69D50">SecurityPermission</span><span style="color:#ADBAC7">(SecurityAction.LinkDemand, </span><span style="color:#F69D50">Flags</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> SecurityPermissionFlag.Infrastructure)] </span><span style="color:#F47067">protected</span><span style="color:#F69D50"> TAttribute</span><span style="color:#DCBDFB"> GetAttribute</span><span style="color:#ADBAC7">(</span><span style="color:#F69D50">IMessage</span><span style="color:#F69D50"> message</span><span style="color:#ADBAC7">) { </span><span style="color:#F47067">string</span><span style="color:#F69D50"> typeName</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">string</span><span style="color:#ADBAC7">)message.Properties[</span><span style="color:#96D0FF">&quot;__TypeName&quot;</span><span style="color:#ADBAC7">]; </span><span style="color:#F47067">string</span><span style="color:#F69D50"> methodName</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> (</span><span style="color:#F47067">string</span><span style="color:#ADBAC7">)message.Properties[</span><span style="color:#96D0FF">&quot;__MethodName&quot;</span><span style="color:#ADBAC7">]; </span><span style="color:#F69D50">Type</span><span style="color:#F69D50"> callingType</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> Type.</span><span style="color:#DCBDFB">GetType</span><span style="color:#ADBAC7">(typeName); </span><span style="color:#F69D50">MethodInfo</span><span style="color:#F69D50"> methodInfo</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> callingType.</span><span style="color:#DCBDFB">GetMethod</span><span style="color:#ADBAC7">(methodName); </span><span style="color:#F47067">object</span><span style="color:#ADBAC7">[] </span><span style="color:#F69D50">attributes</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> methodInfo.</span><span style="color:#DCBDFB">GetCustomAttributes</span><span style="color:#ADBAC7">(</span><span style="color:#F47067">typeof</span><span style="color:#ADBAC7">(</span><span style="color:#F69D50">TAttribute</span><span style="color:#ADBAC7">), </span><span style="color:#6CB6FF">true</span><span style="color:#ADBAC7">); </span><span style="color:#F69D50">TAttribute</span><span style="color:#F69D50"> attribute</span><span style="color:#F47067"> =</span><span style="color:#6CB6FF"> null</span><span style="color:#ADBAC7">; </span><span style="color:#F47067">if</span><span style="color:#ADBAC7"> (attributes.Length </span><span style="color:#F47067">&gt;</span><span style="color:#6CB6FF"> 0</span><span style="color:#ADBAC7">) { attribute </span><span style="color:#F47067">=</span><span style="color:#ADBAC7"> attributes[</span><span style="color:#6CB6FF">0</span><span style="color:#ADBAC7">] </span><span style="color:#F47067">as</span><span style="color:#F69D50"> TAttribute</span><span style="color:#ADBAC7">; } </span><span style="color:#F47067">return</span><span style="color:#ADBAC7"> attribute; } } </span></span></code></pre></figure>
<p>It would be even better if we could avoid having two different attributes on each test but this is a solution that still let us avoid having to handle thread on every test. It&#x27;s also important to notice that this is only good for MsTest. If you are using other testing framework like nUnit or xUnit that this will not work. However, these frameworks have other mechanism to handle pre and post tests too. The documentation is very slim on Microsoft about there infrastructure classes. It comes from a pre-era where Microsoft where less open that it is now.</p></div></main><div class="layout_paginationBar__jnuuR"><div class="layout_paginationTitle__PsOw5">Chronological Blog Articles by Page</div><div class="layout_paginationLinks__LdBaH"><a class="" href="/blog/page/1">1</a><a class="" href="/blog/page/2">2</a><a class="" href="/blog/page/3">3</a><a class="" href="/blog/page/4">4</a><a class="" href="/blog/page/5">5</a><a class="" href="/blog/page/6">6</a><a class="" href="/blog/page/7">7</a><a class="" href="/blog/page/8">8</a><a class="" href="/blog/page/9">9</a><a class="" href="/blog/page/10">10</a><a class="" href="/blog/page/11">11</a><a class="" href="/blog/page/12">12</a><a class="" href="/blog/page/13">13</a><a class="" href="/blog/page/14">14</a><a class="" href="/blog/page/15">15</a><a class="" href="/blog/page/16">16</a><a class="" href="/blog/page/17">17</a><a class="" href="/blog/page/18">18</a><a class="" href="/blog/page/19">19</a><a class="" href="/blog/page/20">20</a><a class="" href="/blog/page/21">21</a><a class="" href="/blog/page/22">22</a><a class="" href="/blog/page/23">23</a><a class="" href="/blog/page/24">24</a><a class="" href="/blog/page/25">25</a><a class="" href="/blog/page/26">26</a><a class="" href="/blog/page/27">27</a><a class="" href="/blog/page/28">28</a><a class="" href="/blog/page/29">29</a><a class="" href="/blog/page/30">30</a><a class="" href="/blog/page/31">31</a><a class="" href="/blog/page/32">32</a><a class="" href="/blog/page/33">33</a><a class="" href="/blog/page/34">34</a><a class="" href="/blog/page/35">35</a><a class="" href="/blog/page/36">36</a><a class="" href="/blog/page/37">37</a><a class="" href="/blog/page/38">38</a><a class="" href="/blog/page/39">39</a><a class="" href="/blog/page/40">40</a><a class="" href="/blog/page/41">41</a><a class="" href="/blog/page/42">42</a><a class="" href="/blog/page/43">43</a><a class="" href="/blog/page/44">44</a><a class="" href="/blog/page/45">45</a><a class="" href="/blog/page/46">46</a><a class="" href="/blog/page/47">47</a><a class="" href="/blog/page/48">48</a><a class="" href="/blog/page/49">49</a><a class="" href="/blog/page/50">50</a><a class="" href="/blog/page/51">51</a><a class="" href="/blog/page/52">52</a><a class="" href="/blog/page/53">53</a><a class="" href="/blog/page/54">54</a><a class="" href="/blog/page/55">55</a><a class="" href="/blog/page/56">56</a><a class="" href="/blog/page/57">57</a><a class="" href="/blog/page/58">58</a><a class="" href="/blog/page/59">59</a><a class="" href="/blog/page/60">60</a><a class="" href="/blog/page/61">61</a><a class="" href="/blog/page/62">62</a><a class="" href="/blog/page/63">63</a><a class="" href="/blog/page/64">64</a><a class="" href="/blog/page/65">65</a><a class="" href="/blog/page/66">66</a><a class="" href="/blog/page/67">67</a><a class="" href="/blog/page/68">68</a><a class="" href="/blog/page/69">69</a><a class="" href="/blog/page/70">70</a><a class="" href="/blog/page/71">71</a><a class="" href="/blog/page/72">72</a><a class="" href="/blog/page/73">73</a><a class="" href="/blog/page/74">74</a><a class="" href="/blog/page/75">75</a><a class="" href="/blog/page/76">76</a><a class="" href="/blog/page/77">77</a></div></div></div></div><script src="/_next/static/chunks/webpack-c94468cbefcc94b8.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/4f3d065c9e2d01e0.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:HL[\"/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n4:HL[\"/_next/static/css/8ea1dcbe6e4b9929.css\",\"style\",{\"crossOrigin\":\"\"}]\n"])</script><script>self.__next_f.push([1,"5:I[7690,[],\"\"]\n8:I[5613,[],\"\"]\na:I[1778,[],\"\"]\nb:I[5250,[\"250\",\"static/chunks/250-d7e0a94ebe194dac.js\",\"79\",\"static/chunks/79-2d03397107aae3f1.js\",\"308\",\"static/chunks/app/blog/%5Bslug%5D/page-6ef1cad01f05dc10.js\"],\"\"]\nd:I[8955,[],\"\"]\n9:[\"slug\",\"how-to-have-mstest-localized-by-attribute\",\"d\"]\ne:[]\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/4f3d065c9e2d01e0.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L5\",null,{\"buildId\":\"pQvqCOvKm2LGzk0s7VKrc\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/blog/how-to-have-mstest-localized-by-attribute\",\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"how-to-have-mstest-localized-by-attribute\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"how-to-have-mstest-localized-by-attribute\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"how-to-have-mstest-localized-by-attribute\",\"d\"],{\"children\":[\"__PAGE__\",{},[\"$L6\",\"$L7\",null]]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$9\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/8ea1dcbe6e4b9929.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}]]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[null,[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"layout_bodystyle__4ncsS\",\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"div\",null,{\"style\":{\"display\":\"flex\",\"alignItems\":\"center\",\"justifyContent\":\"center\",\"height\":\"100vh\"},\"children\":[\"$\",\"div\",null,{\"style\":{\"width\":\"50%\",\"height\":\"20%\",\"backgroundColor\":\"#ffeded\",\"borderRadius\":12,\"padding\":12,\"textAlign\":\"center\"},\"children\":[[\"$\",\"h1\",null,{\"children\":\"Not Found\"}],[\"$\",\"p\",null,{\"children\":\"Could not find requested resource\"}],[\"$\",\"$Lb\",null,{\"href\":\"/\",\"children\":\"Return Home\"}]]}]}],\"notFoundStyles\":[],\"styles\":null}]}]}],null]],\"initialHead\":[false,\"$Lc\"],\"globalErrorComponent\":\"$d\",\"missingSlots\":\"$We\"}]]\n"])</script><script>self.__next_f.push([1,"f:I[1749,[\"250\",\"static/chunks/250-d7e0a94ebe194dac.js\",\"79\",\"static/chunks/79-2d03397107aae3f1.js\",\"308\",\"static/chunks/app/blog/%5Bslug%5D/page-6ef1cad01f05dc10.js\"],\"Image\"]\nc:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Patrick Desjardins Blog - How to have MsTest localized by Attribute?\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"How to have MsTest localized by Attribute?\"}],[\"$\",\"meta\",\""])</script><script>self.__next_f.push([1,"4\",{\"name\":\"next-size-adjust\"}]]\n6:null\n"])</script><script>self.__next_f.push([1,"7:[\"$\",\"div\",null,{\"className\":\"__className_aaf875\",\"children\":[\"$\",\"div\",null,{\"className\":\"layout_container__Tovb9\",\"children\":[[\"$\",\"header\",null,{\"className\":\"layout_siteTitle__k5U8g\",\"children\":\"Patrick Desjardins Blog\"}],[\"$\",\"nav\",null,{\"children\":[\"$\",\"ul\",null,{\"className\":\"layout_navLinks__mf70r\",\"children\":[\"$\",\"li\",null,{\"className\":\"layout_navLinkItem__1L8fB\",\"children\":[[\"$\",\"$Lb\",null,{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/\",\"children\":\"Main Page\"}],[\"$\",\"$Lb\",null,{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog\",\"children\":\"Blog\"}],[[\"$\",\"$Lb\",\"2024\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2024\",\"children\":2024}],[\"$\",\"$Lb\",\"2023\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2023\",\"children\":2023}],[\"$\",\"$Lb\",\"2022\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2022\",\"children\":2022}],[\"$\",\"$Lb\",\"2021\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2021\",\"children\":2021}],[\"$\",\"$Lb\",\"2020\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2020\",\"children\":2020}],[\"$\",\"$Lb\",\"2019\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2019\",\"children\":2019}],[\"$\",\"$Lb\",\"2018\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2018\",\"children\":2018}],[\"$\",\"$Lb\",\"2017\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2017\",\"children\":2017}],[\"$\",\"$Lb\",\"2016\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2016\",\"children\":2016}],[\"$\",\"$Lb\",\"2015\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2015\",\"children\":2015}],[\"$\",\"$Lb\",\"2014\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2014\",\"children\":2014}],[\"$\",\"$Lb\",\"2013\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2013\",\"children\":2013}],[\"$\",\"$Lb\",\"2012\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2012\",\"children\":2012}],[\"$\",\"$Lb\",\"2011\",{\"className\":\"layout_navLinkText__bt28R\",\"href\":\"/blog/for/2011\",\"children\":2011}]]]}]}]}],[\"$\",\"div\",null,{\"className\":\"layout_blogPictureContainer__XC7nK\",\"children\":[\"$\",\"$Lf\",null,{\"className\":\"layout_blogTopPicture__RJHNN\",\"alt\":\"Patrick Desjardins picture from a conference\",\"src\":\"/images/backgrounds/patrickdesjardins_conference_bw.jpeg\",\"width\":800,\"height\":260}]}],[\"$\",\"main\",null,{\"className\":\"layout_main__mXTwS\",\"children\":[[\"$\",\"h1\",null,{\"children\":\"How to have MsTest localized by Attribute?\"}],[\"$\",\"div\",null,{\"className\":\"layout_blogPostContainer__WYELx\",\"children\":[[\"$\",\"p\",null,{\"className\":\"layout_blogPostDate__LUvx5\",\"children\":[\"Posted on: \",\"2016-01-12\"]}],[[\"$\",\"p\",null,{\"children\":\"Working with multiple languages requires to test in multiple languages too. A simple use case is if you have custom Asp.Net routing that you might want to test where an English route goes and the same for a French one. This goes beyond just text, but also how to handle numbers and datetime. The traditional way to do unit test in multiple localisations is to set the current thread at the beginning of the test, do the logic, assert and set the thread back to the original value.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The problem is that in all your code you need to set the thread manually. It would be better to have an attribute on the top of the test method and have this one handling the thread culture. Unfortunately, MSTest \\\"TestMethod\\\" attributes is sealed which mean you cannot inherit of this one. The work around is to create a custom attribute. However, this come with the challenge to hook into MsTest pipeline to have MsTest reads the attribute and act accordingly. This is what we will discuss in this article, how to use \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"ContextAttribute\"}]}]}]}],\", \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"IMessageSink\"}]}]}]}],\", \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"IContributeObjectSink\"}]}]}]}],\" and so on.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"First, let's create a standard attribute that we will use on top of our test that need localization. We will use this one in combination of the TestMethod. The use will looks like this:\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"TestMethod\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"] [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"LocalizedTest\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(LocalizedSection.EN_NAME)] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"public\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" void\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" MyTest\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"() { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"//... Your test } \"}]]}]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The attribute has a parameter which is the \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"Culture Name\"}]}]}]}],\" that we want to have the thread. The culture name is \\\"en-us\\\" for USA English or \\\"fr-ca\\\" Canadian French.\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" public\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" class\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" LocalizedTestAttribute\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"Attribute\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"public\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" CultureName\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"get\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"; \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"set\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\";} \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"public\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" LocalizedTestAttribute\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" cultureName\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".CultureName \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" cultureName; } } \"}]]}]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"A second attribute is required to be at the top of the class tested. This is the way to notify the Microsoft test framework that we want to hook inside the pipeline of tasks that the testing framework is going while executing tests. This attribute inherit from \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"ContextAttribute\"}]}]}]}],\", from \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"System.Runtime.Remoting.Contexts\"}]}]}]}],\" namespace. The role of that class is to define a collection of possible hooks. In that case, we have only one hook that we call \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"LocalizedTestMessage\"}]}]}]}],\". Those hooks are called \\\"messages\\\". I am using a helper named TestProperty which handle generic code for every message. This generic class is inspired by the \",[\"$\",\"a\",null,{\"href\":\"http://mstestextensions.codeplex.com/SourceControl/latest#Trunk/Source/MSTestExtensions/TestAspect.cs\",\"children\":\"MsTestExtension\"}],\" source code.\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" public\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" class\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" LocalizedTestContextAttribute\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"ContextAttribute\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"public\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" LocalizedTestContextAttribute\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"():\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"base\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"LocalizedTest\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"public\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" override\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" void\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" GetPropertiesForNewContext\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"IConstructionCallMessage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" msg\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"   if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (msg \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"==\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"throw\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" ArgumentNullException\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"msg\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"); \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  msg.ContextProperties.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"Add\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" TestProperty\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"LocalizedTestMessage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e()); \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"//We add 1 new message into the test pipeline \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"} }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"public\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" class\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" TestProperty\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"T\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e : \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"IContextProperty\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"IContributeObjectSink\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" where\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" T\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" : \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"IMessageSink\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"ITestMessage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"() {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"private\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" readonly\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" string_name \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" typeof\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"T\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\").AssemblyQualifiedName;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"SecurityPermission\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(SecurityAction.LinkDemand, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"Flags\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" SecurityPermissionFlag.Infrastructure)] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"public\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" bool\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" IsNewContextOK\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"Context\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" newCtx\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"; }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"SecurityPermission\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(SecurityAction.LinkDemand, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"Flags\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" SecurityPermissionFlag.Infrastructure)] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"public\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" void\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" Freeze\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"Context\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" newContext\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") { }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"public\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" Name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" { [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"SecurityPermission\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(SecurityAction.LinkDemand, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"Flags\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" SecurityPermissionFlag.Infrastructure)] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"get\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" { return_name; } }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"SecurityPermission\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(SecurityAction.LinkDemand, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"Flags\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" SecurityPermissionFlag.Infrastructure)] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"public\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" IMessageSink\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" GetObjectSink\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"MarshalByRefObject\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" obj\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"IMessageSink\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" nextSink\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"T\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" testAspect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" T\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); testAspect.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"AddMessageSink\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(nextSink); \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" testAspect; } }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"public\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" interface\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" ITestMessage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"void\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" AddMessageSink\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"IMessageSink\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" messageSink\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"); } \"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Finally, we need to have our LocalizedTest message hook (message) defined. This class defines what is done before and after the execution of the test. This class is able to access the tested method to check if \",[\"$\",\"span\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"plaintext\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"children\":\"LocalizedTest\"}]}]}]}],\" attribute is defined on the class. If yes, it proceeds, otherwise it executes the method without changing anything. When the attribute is present, it backup the current thread culture, get the culture name from the attribute and set it to the test thread. It executes the test, and set back the original thread.\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"csharp\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" public\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" class\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" LocalizedTestMessage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" : \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"BaseTestMessage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"LocalizedTestAttribute\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"IMessageSink\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"ITestMessage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"private\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" IMessageSink\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" nextSink\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"SecurityPermission\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(SecurityAction.LinkDemand, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"Flags\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" SecurityPermissionFlag.Infrastructure)] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"public\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" IMessage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" SyncProcessMessage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"IMessage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" msg\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (msg \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"==\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"throw\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" ArgumentNullException\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"msg\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"); \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"CultureInfo\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" currentCultureInfo\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"; \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"CultureInfo\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" currentUICultureInfo\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"//Before test get value to set back after test \"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"LocalizedTestAttribute\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" localizationAttribute\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" base\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"GetAttribute\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(msg); \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (localizationAttribute \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"!=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") { currentCultureInfo \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" System.Threading.Thread.CurrentThread.CurrentCulture; currentUICultureInfo \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" System.Threading.Thread.CurrentThread.CurrentUICulture; System.Threading.Thread.CurrentThread.CurrentCulture \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" System\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"Globalization\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"CultureInfo\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(localizationAttribute.CultureName); System.Threading.Thread.CurrentThread.CurrentUICulture \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" System.Threading.Thread.CurrentThread.CurrentCulture; }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"//Execute test \"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"IMessage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" returnMessage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" nextSink.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"SyncProcessMessage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(msg);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"//After test set back value \"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (localizationAttribute \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"!=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" \u0026\u0026\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" currentCultureInfo\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"!=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" \u0026\u0026\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" currentUICultureInfo\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"!=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") { System.Threading.Thread.CurrentThread.CurrentCulture \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" currentCultureInfo; System.Threading.Thread.CurrentThread.CurrentUICulture \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" currentUICultureInfo; } \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" returnMessage; }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"SecurityPermission\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(SecurityAction.LinkDemand, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"Flags\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" SecurityPermissionFlag.Infrastructure)] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"public\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" IMessageCtrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" AsyncProcessMessage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"IMessage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" msg\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"IMessageSink\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" replySink\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"throw\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" InvalidOperationException\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(); }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"public\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" IMessageSink\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" NextSink\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" { [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"SecurityPermission\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(SecurityAction.LinkDemand, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"Flags\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" SecurityPermissionFlag.Infrastructure)] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"get\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" nextSink; } }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"public\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" void\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" AddMessageSink\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"IMessageSink\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" messageSink\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") { nextSink \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" messageSink; } }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"public\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" abstract\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" class\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" BaseTestMessage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"TAttribute\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"where\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" TAttribute\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" : \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"Attribute\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"SecurityPermission\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(SecurityAction.LinkDemand, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"Flags\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" SecurityPermissionFlag.Infrastructure)] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"protected\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" TAttribute\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" GetAttribute\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"IMessage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" message\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" typeName\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\")message.Properties[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"__TypeName\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"]; \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" methodName\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\")message.Properties[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"__MethodName\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"]; \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"Type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" callingType\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" Type.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"GetType\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(typeName); \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"MethodInfo\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" methodInfo\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" callingType.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"GetMethod\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(methodName); \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"object\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"[] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"attributes\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" methodInfo.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"GetCustomAttributes\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"typeof\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"TAttribute\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"), \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"); \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"TAttribute\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" attribute\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"; \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (attributes.Length \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" 0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") { attribute \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" attributes[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" TAttribute\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"; } \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" attribute; } } \"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"It would be even better if we could avoid having two different attributes on each test but this is a solution that still let us avoid having to handle thread on every test. It's also important to notice that this is only good for MsTest. If you are using other testing framework like nUnit or xUnit that this will not work. However, these frameworks have other mechanism to handle pre and post tests too. The documentation is very slim on Microsoft about there infrastructure classes. It comes from a pre-era where Microsoft where less open that it is now.\"}]]]}]]}],[\"$\",\"div\",null,{\"className\":\"layout_paginationBar__jnuuR\",\"children\":[[\"$\",\"div\",null,{\"className\":\"layout_paginationTitle__PsOw5\",\"children\":\"Chronological Blog Articles by Page\"}],[\"$\",\"div\",null,{\"className\":\"layout_paginationLinks__LdBaH\",\"children\":[[\"$\",\"$Lb\",\"1\",{\"className\":\"\",\"href\":\"/blog/page/1\",\"children\":1}],[\"$\",\"$Lb\",\"2\",{\"className\":\"\",\"href\":\"/blog/page/2\",\"children\":2}],[\"$\",\"$Lb\",\"3\",{\"className\":\"\",\"href\":\"/blog/page/3\",\"children\":3}],[\"$\",\"$Lb\",\"4\",{\"className\":\"\",\"href\":\"/blog/page/4\",\"children\":4}],[\"$\",\"$Lb\",\"5\",{\"className\":\"\",\"href\":\"/blog/page/5\",\"children\":5}],[\"$\",\"$Lb\",\"6\",{\"className\":\"\",\"href\":\"/blog/page/6\",\"children\":6}],[\"$\",\"$Lb\",\"7\",{\"className\":\"\",\"href\":\"/blog/page/7\",\"children\":7}],[\"$\",\"$Lb\",\"8\",{\"className\":\"\",\"href\":\"/blog/page/8\",\"children\":8}],[\"$\",\"$Lb\",\"9\",{\"className\":\"\",\"href\":\"/blog/page/9\",\"children\":9}],[\"$\",\"$Lb\",\"10\",{\"className\":\"\",\"href\":\"/blog/page/10\",\"children\":10}],[\"$\",\"$Lb\",\"11\",{\"className\":\"\",\"href\":\"/blog/page/11\",\"children\":11}],[\"$\",\"$Lb\",\"12\",{\"className\":\"\",\"href\":\"/blog/page/12\",\"children\":12}],[\"$\",\"$Lb\",\"13\",{\"className\":\"\",\"href\":\"/blog/page/13\",\"children\":13}],[\"$\",\"$Lb\",\"14\",{\"className\":\"\",\"href\":\"/blog/page/14\",\"children\":14}],[\"$\",\"$Lb\",\"15\",{\"className\":\"\",\"href\":\"/blog/page/15\",\"children\":15}],[\"$\",\"$Lb\",\"16\",{\"className\":\"\",\"href\":\"/blog/page/16\",\"children\":16}],[\"$\",\"$Lb\",\"17\",{\"className\":\"\",\"href\":\"/blog/page/17\",\"children\":17}],[\"$\",\"$Lb\",\"18\",{\"className\":\"\",\"href\":\"/blog/page/18\",\"children\":18}],[\"$\",\"$Lb\",\"19\",{\"className\":\"\",\"href\":\"/blog/page/19\",\"children\":19}],[\"$\",\"$Lb\",\"20\",{\"className\":\"\",\"href\":\"/blog/page/20\",\"children\":20}],[\"$\",\"$Lb\",\"21\",{\"className\":\"\",\"href\":\"/blog/page/21\",\"children\":21}],[\"$\",\"$Lb\",\"22\",{\"className\":\"\",\"href\":\"/blog/page/22\",\"children\":22}],[\"$\",\"$Lb\",\"23\",{\"className\":\"\",\"href\":\"/blog/page/23\",\"children\":23}],[\"$\",\"$Lb\",\"24\",{\"className\":\"\",\"href\":\"/blog/page/24\",\"children\":24}],[\"$\",\"$Lb\",\"25\",{\"className\":\"\",\"href\":\"/blog/page/25\",\"children\":25}],[\"$\",\"$Lb\",\"26\",{\"className\":\"\",\"href\":\"/blog/page/26\",\"children\":26}],[\"$\",\"$Lb\",\"27\",{\"className\":\"\",\"href\":\"/blog/page/27\",\"children\":27}],[\"$\",\"$Lb\",\"28\",{\"className\":\"\",\"href\":\"/blog/page/28\",\"children\":28}],[\"$\",\"$Lb\",\"29\",{\"className\":\"\",\"href\":\"/blog/page/29\",\"children\":29}],[\"$\",\"$Lb\",\"30\",{\"className\":\"\",\"href\":\"/blog/page/30\",\"children\":30}],[\"$\",\"$Lb\",\"31\",{\"className\":\"\",\"href\":\"/blog/page/31\",\"children\":31}],[\"$\",\"$Lb\",\"32\",{\"className\":\"\",\"href\":\"/blog/page/32\",\"children\":32}],[\"$\",\"$Lb\",\"33\",{\"className\":\"\",\"href\":\"/blog/page/33\",\"children\":33}],[\"$\",\"$Lb\",\"34\",{\"className\":\"\",\"href\":\"/blog/page/34\",\"children\":34}],[\"$\",\"$Lb\",\"35\",{\"className\":\"\",\"href\":\"/blog/page/35\",\"children\":35}],[\"$\",\"$Lb\",\"36\",{\"className\":\"\",\"href\":\"/blog/page/36\",\"children\":36}],[\"$\",\"$Lb\",\"37\",{\"className\":\"\",\"href\":\"/blog/page/37\",\"children\":37}],[\"$\",\"$Lb\",\"38\",{\"className\":\"\",\"href\":\"/blog/page/38\",\"children\":38}],[\"$\",\"$Lb\",\"39\",{\"className\":\"\",\"href\":\"/blog/page/39\",\"children\":39}],[\"$\",\"$Lb\",\"40\",{\"className\":\"\",\"href\":\"/blog/page/40\",\"children\":40}],[\"$\",\"$Lb\",\"41\",{\"className\":\"\",\"href\":\"/blog/page/41\",\"children\":41}],[\"$\",\"$Lb\",\"42\",{\"className\":\"\",\"href\":\"/blog/page/42\",\"children\":42}],[\"$\",\"$Lb\",\"43\",{\"className\":\"\",\"href\":\"/blog/page/43\",\"children\":43}],[\"$\",\"$Lb\",\"44\",{\"className\":\"\",\"href\":\"/blog/page/44\",\"children\":44}],[\"$\",\"$Lb\",\"45\",{\"className\":\"\",\"href\":\"/blog/page/45\",\"children\":45}],[\"$\",\"$Lb\",\"46\",{\"className\":\"\",\"href\":\"/blog/page/46\",\"children\":46}],[\"$\",\"$Lb\",\"47\",{\"className\":\"\",\"href\":\"/blog/page/47\",\"children\":47}],[\"$\",\"$Lb\",\"48\",{\"className\":\"\",\"href\":\"/blog/page/48\",\"children\":48}],[\"$\",\"$Lb\",\"49\",{\"className\":\"\",\"href\":\"/blog/page/49\",\"children\":49}],[\"$\",\"$Lb\",\"50\",{\"className\":\"\",\"href\":\"/blog/page/50\",\"children\":50}],[\"$\",\"$Lb\",\"51\",{\"className\":\"\",\"href\":\"/blog/page/51\",\"children\":51}],[\"$\",\"$Lb\",\"52\",{\"className\":\"\",\"href\":\"/blog/page/52\",\"children\":52}],[\"$\",\"$Lb\",\"53\",{\"className\":\"\",\"href\":\"/blog/page/53\",\"children\":53}],[\"$\",\"$Lb\",\"54\",{\"className\":\"\",\"href\":\"/blog/page/54\",\"children\":54}],[\"$\",\"$Lb\",\"55\",{\"className\":\"\",\"href\":\"/blog/page/55\",\"children\":55}],[\"$\",\"$Lb\",\"56\",{\"className\":\"\",\"href\":\"/blog/page/56\",\"children\":56}],[\"$\",\"$Lb\",\"57\",{\"className\":\"\",\"href\":\"/blog/page/57\",\"children\":57}],[\"$\",\"$Lb\",\"58\",{\"className\":\"\",\"href\":\"/blog/page/58\",\"children\":58}],[\"$\",\"$Lb\",\"59\",{\"className\":\"\",\"href\":\"/blog/page/59\",\"children\":59}],[\"$\",\"$Lb\",\"60\",{\"className\":\"\",\"href\":\"/blog/page/60\",\"children\":60}],[\"$\",\"$Lb\",\"61\",{\"className\":\"\",\"href\":\"/blog/page/61\",\"children\":61}],[\"$\",\"$Lb\",\"62\",{\"className\":\"\",\"href\":\"/blog/page/62\",\"children\":62}],[\"$\",\"$Lb\",\"63\",{\"className\":\"\",\"href\":\"/blog/page/63\",\"children\":63}],[\"$\",\"$Lb\",\"64\",{\"className\":\"\",\"href\":\"/blog/page/64\",\"children\":64}],[\"$\",\"$Lb\",\"65\",{\"className\":\"\",\"href\":\"/blog/page/65\",\"children\":65}],[\"$\",\"$Lb\",\"66\",{\"className\":\"\",\"href\":\"/blog/page/66\",\"children\":66}],[\"$\",\"$Lb\",\"67\",{\"className\":\"\",\"href\":\"/blog/page/67\",\"children\":67}],[\"$\",\"$Lb\",\"68\",{\"className\":\"\",\"href\":\"/blog/page/68\",\"children\":68}],[\"$\",\"$Lb\",\"69\",{\"className\":\"\",\"href\":\"/blog/page/69\",\"children\":69}],[\"$\",\"$Lb\",\"70\",{\"className\":\"\",\"href\":\"/blog/page/70\",\"children\":70}],[\"$\",\"$Lb\",\"71\",{\"className\":\"\",\"href\":\"/blog/page/71\",\"children\":71}],[\"$\",\"$Lb\",\"72\",{\"className\":\"\",\"href\":\"/blog/page/72\",\"children\":72}],[\"$\",\"$Lb\",\"73\",{\"className\":\"\",\"href\":\"/blog/page/73\",\"children\":73}],[\"$\",\"$Lb\",\"74\",{\"className\":\"\",\"href\":\"/blog/page/74\",\"children\":74}],[\"$\",\"$Lb\",\"75\",{\"className\":\"\",\"href\":\"/blog/page/75\",\"children\":75}],[\"$\",\"$Lb\",\"76\",{\"className\":\"\",\"href\":\"/blog/page/76\",\"children\":76}],[\"$\",\"$Lb\",\"77\",{\"className\":\"\",\"href\":\"/blog/page/77\",\"children\":77}]]}]]}]]}]}]\n"])</script><script>self.__next_f.push([1,""])</script></body></html>
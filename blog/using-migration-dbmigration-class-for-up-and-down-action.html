<!DOCTYPE html><html lang="en" class="layout_htmlstyle__PseMz"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/4cb872a2a77e328a.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/dabd5e64a469b0e1.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/be8a59717d6d5849.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/97e0a79122e618e4.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-3bbba27772baeadb.js"/><script src="/_next/static/chunks/2200cc46-73d9c2dcf2e9794f.js" async=""></script><script src="/_next/static/chunks/657-3551bff086733983.js" async=""></script><script src="/_next/static/chunks/main-app-67ffb56f87b9fb11.js" async=""></script><script src="/_next/static/chunks/156-2b9f703633e98ef7.js" async=""></script><script src="/_next/static/chunks/836-7e37630a3372363c.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-2829e3c199d313ca.js" async=""></script><title>Patrick Desjardins Blog - Using Migration DbMigration class for Up and Down action</title><meta name="description" content="Using Migration DbMigration class for Up and Down action"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="layout_bodystyle__4ncsS"><div class="layout_blogbodystyle___Uc1w"><div class="BlogBody_BlogBody__600mT"><header class="BlogBody_siteTitle__f7uyb">Patrick Desjardins Blog</header><nav><ul class="BlogBody_navLinks__ZV12t"><li class="BlogBody_navLinkItem__Pml2e"><a class="BlogBody_navLinkText__ZtH2y" href="/">Main Page</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog">Blog</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/search">Search</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2026">2026</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2025">2025</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2024">2024</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2023">2023</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2022">2022</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2021">2021</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2020">2020</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2019">2019</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2018">2018</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2017">2017</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2016">2016</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2015">2015</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2014">2014</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2013">2013</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2012">2012</a><a class="BlogBody_navLinkText__ZtH2y" href="/blog/for/2011">2011</a></li></ul></nav><div class="BlogBody_blogPictureContainer__IAbPL"><img alt="Patrick Desjardins picture from a conference" loading="lazy" width="800" height="260" decoding="async" data-nimg="1" class="BlogBody_blogTopPicture__L6lao" style="color:transparent" src="/images/backgrounds/patrickdesjardins_conference_bw.webp"/></div><main class="BlogBody_main__XrdKY"><h1 class="BlogBody_heading__bYRBe">Using Migration DbMigration class for Up and Down action</h1><div class="Page_blogPostContainer__AUIcf"><p class="Page_blogPostDate__wVWWB">Posted on: <!-- -->2014-02-06</p><p>Entity Framework (EF) and Migration tools can be used in several ways. The most effective and complete one is to generate <code>DbMigration</code> class by the Entity Framework Migration Tools. It allows to have the creation of the table with all attributes like foreign key, size, primary key and so on. It allows to rollback in the situation that you have to get an older release. Often, this is possible with a source control but it is harder to have the database to be restored in time. Migration tools let you restore the database in the time which is a big plus. Also, it has the advantage to create a a database quickly which is very important for automatically testing or to simply create a new database for a developer. Migration also let you seed data into the database. Instead of having a database empty every time, you can have a database with minimal values.</p>
<p>Before talking about commands that you will use during the development. One command is required to be executed once. It is the one that configure the migration tool.</p>
<pre class="language-csharp"><code class="language-csharp code-highlight"><span class="code-line"> Enable<span class="token operator">-</span>Migrations 
</span></code></pre>
<p>You can have help by using : get-help Enable-Migrations</p>
<p>You can specify the folder</p>
<p>First of all, there are commands that you will use often. You can create a solution items folder and create power shell scripts with them. This will simplify the use of them. In both case, these commands needs to be executed in the <code>Package Manager Console</code>.</p>
<pre class="language-powershell"><code class="language-powershell code-highlight"><span class="code-line"><span class="token keyword">param</span><span class="token punctuation">(</span><span class="token namespace">[String]</span><span class="token variable">$migrationName</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token function">Write-Host</span> <span class="token string">&quot;MigrationName: <span class="token variable">$migrationName</span>&quot;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token function">Add-Migration</span> <span class="token operator">-</span>Name <span class="token variable">$migrationName</span> ` <span class="token operator">-</span>ConfigurationType YourDLL<span class="token punctuation">.</span>Migration<span class="token punctuation">.</span>YourDBContextConfiguration ` <span class="token operator">-</span>StartUpProjectName YourStartupDLL ` <span class="token operator">-</span>ProjectName YourDLL<span class="token punctuation">.</span>Migration ` <span class="token operator">-</span>Verbose 
</span></code></pre>
<p>Usage:</p>
<pre class="language-powershell"><code class="language-powershell code-highlight"><span class="code-line"> <span class="token punctuation">.</span>\\AddMigration<span class="token punctuation">.</span>ps1 TheMigrationClassToBeGenerated 
</span></code></pre>
<p>This first script calls the <code>Add-Migration</code> command. It takes a configuration type. This file inherit from DbMigrationsConfiguration which is generic. The generic type is the DbContext class. This DbContext must have all entities so if you have split your context is several files than you must create a specific one for the migration. Your DbMigrationsConfiguration allows you to override a seeding method. This is where you can specify values to be inserted into your tables. It works by giving in parameter the DbContext that let you insert entity and SaveChanges.</p>
<p>The project name is the parameter that let you specify the migration project. That should be the same project where you have the configuration type. The StatUpProjectName allows the migration tool to know where to search for config file. This is needed to get the connection string.</p>
<p>The power shell script let you configure all these setting once and then just let you specify the file name that contains the generated creation command. The file generated will be prefixed by the data and the time. This allows Entity Framework Migration tool to know the order of the execution of the file.</p>
<p>The second script is to update the database. Let say that your team has created some script with the Add-Migration. The one that executed the code is up-to-date but not you. This is why, to update your database, you need to get the code (from your source control) and then execute a command to update.</p>
<p>The update command is <code>Update-Database</code>. To make it simpler, like the Add-Migration, a small power script can be used.</p>
<pre class="language-powershell"><code class="language-powershell code-highlight"><span class="code-line"> <span class="token function">Update-Database</span> <span class="token operator">-</span>ConfigurationTypeName <span class="token string">&quot;YourDLL.Migration.YourDBContextConfiguration&quot;</span> ` <span class="token operator">-</span>ProjectName <span class="token string">&quot;YourDLL.Migration&quot;</span> ` <span class="token operator">-</span>StartUpProject <span class="token string">&quot;YourStartupDLL&quot;</span> ` <span class="token operator">-</span>Verbose 
</span></code></pre>
<p>Parameters are pretty much the same. This time, it will execute migration file. If you want to update not every file but just few files you can set the <code>-TargetMigration</code>. It takes after this command the file name to be the last file to be executed. If you have 10 migrations file and that you want to migrate up to the third file, than you need to target the third file. This can be useful if you need to rollback.</p>
<p>This is almost for it. You could remove all the files creation and use automatic migration. However, you have less control over what is executed. With migration file, you can always edit them to add additional instructions which is handy in the case of complex situation. This is almost all the time the case for enterprise application where rollback method needs to handle foreign key manipulations.</p></div></main><div class="BlogBody_paginationBar__1gsMc"><div class="BlogBody_paginationTitle__H_eFX">Chronological Blog Articles by Page</div><div class="BlogBody_paginationLinks__nk8zd"><a class="" href="/blog/page/1">1</a><a class="" href="/blog/page/2">2</a><a class="" href="/blog/page/3">3</a><a class="" href="/blog/page/4">4</a><a class="" href="/blog/page/5">5</a><a class="" href="/blog/page/6">6</a><a class="" href="/blog/page/7">7</a><a class="" href="/blog/page/8">8</a><a class="" href="/blog/page/9">9</a><a class="" href="/blog/page/10">10</a><a class="" href="/blog/page/11">11</a><a class="" href="/blog/page/12">12</a><a class="" href="/blog/page/13">13</a><a class="" href="/blog/page/14">14</a><a class="" href="/blog/page/15">15</a><a class="" href="/blog/page/16">16</a><a class="" href="/blog/page/17">17</a><a class="" href="/blog/page/18">18</a><a class="" href="/blog/page/19">19</a><a class="" href="/blog/page/20">20</a><a class="" href="/blog/page/21">21</a><a class="" href="/blog/page/22">22</a><a class="" href="/blog/page/23">23</a><a class="" href="/blog/page/24">24</a><a class="" href="/blog/page/25">25</a><a class="" href="/blog/page/26">26</a><a class="" href="/blog/page/27">27</a><a class="" href="/blog/page/28">28</a><a class="" href="/blog/page/29">29</a><a class="" href="/blog/page/30">30</a><a class="" href="/blog/page/31">31</a><a class="" href="/blog/page/32">32</a><a class="" href="/blog/page/33">33</a><a class="" href="/blog/page/34">34</a><a class="" href="/blog/page/35">35</a><a class="" href="/blog/page/36">36</a><a class="" href="/blog/page/37">37</a><a class="" href="/blog/page/38">38</a><a class="" href="/blog/page/39">39</a><a class="" href="/blog/page/40">40</a><a class="" href="/blog/page/41">41</a><a class="" href="/blog/page/42">42</a><a class="" href="/blog/page/43">43</a><a class="" href="/blog/page/44">44</a><a class="" href="/blog/page/45">45</a><a class="" href="/blog/page/46">46</a><a class="" href="/blog/page/47">47</a><a class="" href="/blog/page/48">48</a><a class="" href="/blog/page/49">49</a><a class="" href="/blog/page/50">50</a><a class="" href="/blog/page/51">51</a><a class="" href="/blog/page/52">52</a><a class="" href="/blog/page/53">53</a><a class="" href="/blog/page/54">54</a><a class="" href="/blog/page/55">55</a><a class="" href="/blog/page/56">56</a><a class="" href="/blog/page/57">57</a><a class="" href="/blog/page/58">58</a><a class="" href="/blog/page/59">59</a><a class="" href="/blog/page/60">60</a><a class="" href="/blog/page/61">61</a><a class="" href="/blog/page/62">62</a><a class="" href="/blog/page/63">63</a><a class="" href="/blog/page/64">64</a><a class="" href="/blog/page/65">65</a><a class="" href="/blog/page/66">66</a><a class="" href="/blog/page/67">67</a><a class="" href="/blog/page/68">68</a><a class="" href="/blog/page/69">69</a><a class="" href="/blog/page/70">70</a><a class="" href="/blog/page/71">71</a><a class="" href="/blog/page/72">72</a><a class="" href="/blog/page/73">73</a><a class="" href="/blog/page/74">74</a><a class="" href="/blog/page/75">75</a><a class="" href="/blog/page/76">76</a><a class="" href="/blog/page/77">77</a><a class="" href="/blog/page/78">78</a><a class="" href="/blog/page/79">79</a><a class="" href="/blog/page/80">80</a><a class="" href="/blog/page/81">81</a></div></div></div></div><script src="/_next/static/chunks/webpack-3bbba27772baeadb.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/4cb872a2a77e328a.css\",\"style\"]\n2:HL[\"/_next/static/css/dabd5e64a469b0e1.css\",\"style\"]\n3:HL[\"/_next/static/css/be8a59717d6d5849.css\",\"style\"]\n4:HL[\"/_next/static/css/97e0a79122e618e4.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"5:I[1200,[],\"\"]\n8:I[6405,[],\"\"]\na:I[5337,[],\"\"]\nb:I[156,[\"156\",\"static/chunks/156-2b9f703633e98ef7.js\",\"836\",\"static/chunks/836-7e37630a3372363c.js\",\"308\",\"static/chunks/app/blog/%5Bslug%5D/page-2829e3c199d313ca.js\"],\"\"]\nd:I[4688,[],\"\"]\n9:[\"slug\",\"using-migration-dbmigration-class-for-up-and-down-action\",\"d\"]\ne:[]\n"])</script><script>self.__next_f.push([1,"0:[\"$\",\"$L5\",null,{\"buildId\":\"X3FHakB9s-_reohF_o_t1\",\"assetPrefix\":\"\",\"urlParts\":[\"\",\"blog\",\"using-migration-dbmigration-class-for-up-and-down-action\"],\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"using-migration-dbmigration-class-for-up-and-down-action\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"using-migration-dbmigration-class-for-up-and-down-action\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"using-migration-dbmigration-class-for-up-and-down-action\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L6\",\"$L7\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/be8a59717d6d5849.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/97e0a79122e618e4.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]],null],null]},[null,[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$9\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/dabd5e64a469b0e1.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"div\",null,{\"className\":\"layout_blogbodystyle___Uc1w\",\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]}]],null],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/4cb872a2a77e328a.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"layout_htmlstyle__PseMz\",\"children\":[\"$\",\"body\",null,{\"className\":\"layout_bodystyle__4ncsS\",\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"div\",null,{\"style\":{\"display\":\"flex\",\"alignItems\":\"center\",\"justifyContent\":\"center\",\"height\":\"100vh\"},\"children\":[\"$\",\"div\",null,{\"style\":{\"width\":\"50%\",\"height\":\"20%\",\"backgroundColor\":\"#ffeded\",\"borderRadius\":12,\"padding\":12,\"textAlign\":\"center\"},\"children\":[[\"$\",\"h1\",null,{\"children\":\"Not Found\"}],[\"$\",\"p\",null,{\"children\":\"Could not find requested resource\"}],[\"$\",\"$Lb\",null,{\"href\":\"/\",\"children\":\"Return Home\"}]]}]}],\"notFoundStyles\":[]}]}]}]],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$Lc\"],\"globalErrorComponent\":\"$d\",\"missingSlots\":\"$We\"}]\n"])</script><script>self.__next_f.push([1,"f:I[836,[\"156\",\"static/chunks/156-2b9f703633e98ef7.js\",\"836\",\"static/chunks/836-7e37630a3372363c.js\",\"308\",\"static/chunks/app/blog/%5Bslug%5D/page-2829e3c199d313ca.js\"],\"Image\"]\n"])</script><script>self.__next_f.push([1,"7:[\"$\",\"div\",null,{\"className\":\"BlogBody_BlogBody__600mT\",\"children\":[[\"$\",\"header\",null,{\"className\":\"BlogBody_siteTitle__f7uyb\",\"children\":\"Patrick Desjardins Blog\"}],[\"$\",\"nav\",null,{\"children\":[\"$\",\"ul\",null,{\"className\":\"BlogBody_navLinks__ZV12t\",\"children\":[\"$\",\"li\",null,{\"className\":\"BlogBody_navLinkItem__Pml2e\",\"children\":[[\"$\",\"$Lb\",null,{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/\",\"children\":\"Main Page\"}],[\"$\",\"$Lb\",null,{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog\",\"children\":\"Blog\"}],[\"$\",\"$Lb\",null,{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/search\",\"children\":\"Search\"}],[[\"$\",\"$Lb\",\"2026\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2026\",\"children\":2026}],[\"$\",\"$Lb\",\"2025\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2025\",\"children\":2025}],[\"$\",\"$Lb\",\"2024\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2024\",\"children\":2024}],[\"$\",\"$Lb\",\"2023\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2023\",\"children\":2023}],[\"$\",\"$Lb\",\"2022\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2022\",\"children\":2022}],[\"$\",\"$Lb\",\"2021\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2021\",\"children\":2021}],[\"$\",\"$Lb\",\"2020\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2020\",\"children\":2020}],[\"$\",\"$Lb\",\"2019\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2019\",\"children\":2019}],[\"$\",\"$Lb\",\"2018\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2018\",\"children\":2018}],[\"$\",\"$Lb\",\"2017\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2017\",\"children\":2017}],[\"$\",\"$Lb\",\"2016\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2016\",\"children\":2016}],[\"$\",\"$Lb\",\"2015\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2015\",\"children\":2015}],[\"$\",\"$Lb\",\"2014\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2014\",\"children\":2014}],[\"$\",\"$Lb\",\"2013\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2013\",\"children\":2013}],[\"$\",\"$Lb\",\"2012\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2012\",\"children\":2012}],[\"$\",\"$Lb\",\"2011\",{\"className\":\"BlogBody_navLinkText__ZtH2y\",\"href\":\"/blog/for/2011\",\"children\":2011}]]]}]}]}],[\"$\",\"div\",null,{\"className\":\"BlogBody_blogPictureContainer__IAbPL\",\"children\":[\"$\",\"$Lf\",null,{\"className\":\"BlogBody_blogTopPicture__L6lao\",\"alt\":\"Patrick Desjardins picture from a conference\",\"src\":\"/images/backgrounds/patrickdesjardins_conference_bw.webp\",\"width\":800,\"height\":260}]}],[\"$\",\"main\",null,{\"className\":\"BlogBody_main__XrdKY\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"BlogBody_heading__bYRBe\",\"children\":\"Using Migration DbMigration class for Up and Down action\"}],[\"$\",\"div\",null,{\"className\":\"Page_blogPostContainer__AUIcf\",\"children\":[[\"$\",\"p\",null,{\"className\":\"Page_blogPostDate__wVWWB\",\"children\":[\"Posted on: \",\"2014-02-06\"]}],[[\"$\",\"p\",null,{\"children\":[\"Entity Framework (EF) and Migration tools can be used in several ways. The most effective and complete one is to generate \",[\"$\",\"code\",null,{\"children\":\"DbMigration\"}],\" class by the Entity Framework Migration Tools. It allows to have the creation of the table with all attributes like foreign key, size, primary key and so on. It allows to rollback in the situation that you have to get an older release. Often, this is possible with a source control but it is harder to have the database to be restored in time. Migration tools let you restore the database in the time which is a big plus. Also, it has the advantage to create a a database quickly which is very important for automatically testing or to simply create a new database for a developer. Migration also let you seed data into the database. Instead of having a database empty every time, you can have a database with minimal values.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Before talking about commands that you will use during the development. One command is required to be executed once. It is the one that configure the migration tool.\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-csharp\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-csharp code-highlight\",\"children\":[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" Enable\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\"Migrations \\n\"]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"You can have help by using : get-help Enable-Migrations\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"You can specify the folder\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"First of all, there are commands that you will use often. You can create a solution items folder and create power shell scripts with them. This will simplify the use of them. In both case, these commands needs to be executed in the \",[\"$\",\"code\",null,{\"children\":\"Package Manager Console\"}],\".\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-powershell\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-powershell code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"param\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token namespace\",\"children\":\"[String]\"}],[\"$\",\"span\",null,{\"className\":\"token variable\",\"children\":\"$$migrationName\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Write-Host\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":[\"\\\"MigrationName: \",[\"$\",\"span\",null,{\"className\":\"token variable\",\"children\":\"$$migrationName\"}],\"\\\"\"]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Add-Migration\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\"Name \",[\"$\",\"span\",null,{\"className\":\"token variable\",\"children\":\"$$migrationName\"}],\" ` \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\"ConfigurationType YourDLL\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Migration\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"YourDBContextConfiguration ` \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\"StartUpProjectName YourStartupDLL ` \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\"ProjectName YourDLL\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Migration ` \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\"Verbose \\n\"]}]]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Usage:\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-powershell\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-powershell code-highlight\",\"children\":[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"\\\\\\\\AddMigration\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"ps1 TheMigrationClassToBeGenerated \\n\"]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This first script calls the \",[\"$\",\"code\",null,{\"children\":\"Add-Migration\"}],\" command. It takes a configuration type. This file inherit from DbMigrationsConfiguration which is generic. The generic type is the DbContext class. This DbContext must have all entities so if you have split your context is several files than you must create a specific one for the migration. Your DbMigrationsConfiguration allows you to override a seeding method. This is where you can specify values to be inserted into your tables. It works by giving in parameter the DbContext that let you insert entity and SaveChanges.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The project name is the parameter that let you specify the migration project. That should be the same project where you have the configuration type. The StatUpProjectName allows the migration tool to know where to search for config file. This is needed to get the connection string.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The power shell script let you configure all these setting once and then just let you specify the file name that contains the generated creation command. The file generated will be prefixed by the data and the time. This allows Entity Framework Migration tool to know the order of the execution of the file.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The second script is to update the database. Let say that your team has created some script with the Add-Migration. The one that executed the code is up-to-date but not you. This is why, to update your database, you need to get the code (from your source control) and then execute a command to update.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The update command is \",[\"$\",\"code\",null,{\"children\":\"Update-Database\"}],\". To make it simpler, like the Add-Migration, a small power script can be used.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-powershell\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-powershell code-highlight\",\"children\":[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"Update-Database\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\"ConfigurationTypeName \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"YourDLL.Migration.YourDBContextConfiguration\\\"\"}],\" ` \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\"ProjectName \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"YourDLL.Migration\\\"\"}],\" ` \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\"StartUpProject \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"YourStartupDLL\\\"\"}],\" ` \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\"Verbose \\n\"]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Parameters are pretty much the same. This time, it will execute migration file. If you want to update not every file but just few files you can set the \",[\"$\",\"code\",null,{\"children\":\"-TargetMigration\"}],\". It takes after this command the file name to be the last file to be executed. If you have 10 migrations file and that you want to migrate up to the third file, than you need to target the third file. This can be useful if you need to rollback.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"This is almost for it. You could remove all the files creation and use automatic migration. However, you have less control over what is executed. With migration file, you can always edit them to add additional instructions which is handy in the case of complex situation. This is almost all the time the case for enterprise application where rollback method needs to handle foreign key manipulations.\"}]]]}]]}],[\"$\",\"div\",null,{\"className\":\"BlogBody_paginationBar__1gsMc\",\"children\":[[\"$\",\"div\",null,{\"className\":\"BlogBody_paginationTitle__H_eFX\",\"children\":\"Chronological Blog Articles by Page\"}],[\"$\",\"div\",null,{\"className\":\"BlogBody_paginationLinks__nk8zd\",\"children\":[[\"$\",\"$Lb\",\"1\",{\"className\":\"\",\"href\":\"/blog/page/1\",\"children\":1}],[\"$\",\"$Lb\",\"2\",{\"className\":\"\",\"href\":\"/blog/page/2\",\"children\":2}],[\"$\",\"$Lb\",\"3\",{\"className\":\"\",\"href\":\"/blog/page/3\",\"children\":3}],[\"$\",\"$Lb\",\"4\",{\"className\":\"\",\"href\":\"/blog/page/4\",\"children\":4}],[\"$\",\"$Lb\",\"5\",{\"className\":\"\",\"href\":\"/blog/page/5\",\"children\":5}],[\"$\",\"$Lb\",\"6\",{\"className\":\"\",\"href\":\"/blog/page/6\",\"children\":6}],[\"$\",\"$Lb\",\"7\",{\"className\":\"\",\"href\":\"/blog/page/7\",\"children\":7}],[\"$\",\"$Lb\",\"8\",{\"className\":\"\",\"href\":\"/blog/page/8\",\"children\":8}],[\"$\",\"$Lb\",\"9\",{\"className\":\"\",\"href\":\"/blog/page/9\",\"children\":9}],[\"$\",\"$Lb\",\"10\",{\"className\":\"\",\"href\":\"/blog/page/10\",\"children\":10}],[\"$\",\"$Lb\",\"11\",{\"className\":\"\",\"href\":\"/blog/page/11\",\"children\":11}],[\"$\",\"$Lb\",\"12\",{\"className\":\"\",\"href\":\"/blog/page/12\",\"children\":12}],[\"$\",\"$Lb\",\"13\",{\"className\":\"\",\"href\":\"/blog/page/13\",\"children\":13}],[\"$\",\"$Lb\",\"14\",{\"className\":\"\",\"href\":\"/blog/page/14\",\"children\":14}],[\"$\",\"$Lb\",\"15\",{\"className\":\"\",\"href\":\"/blog/page/15\",\"children\":15}],[\"$\",\"$Lb\",\"16\",{\"className\":\"\",\"href\":\"/blog/page/16\",\"children\":16}],[\"$\",\"$Lb\",\"17\",{\"className\":\"\",\"href\":\"/blog/page/17\",\"children\":17}],[\"$\",\"$Lb\",\"18\",{\"className\":\"\",\"href\":\"/blog/page/18\",\"children\":18}],[\"$\",\"$Lb\",\"19\",{\"className\":\"\",\"href\":\"/blog/page/19\",\"children\":19}],[\"$\",\"$Lb\",\"20\",{\"className\":\"\",\"href\":\"/blog/page/20\",\"children\":20}],[\"$\",\"$Lb\",\"21\",{\"className\":\"\",\"href\":\"/blog/page/21\",\"children\":21}],[\"$\",\"$Lb\",\"22\",{\"className\":\"\",\"href\":\"/blog/page/22\",\"children\":22}],[\"$\",\"$Lb\",\"23\",{\"className\":\"\",\"href\":\"/blog/page/23\",\"children\":23}],[\"$\",\"$Lb\",\"24\",{\"className\":\"\",\"href\":\"/blog/page/24\",\"children\":24}],[\"$\",\"$Lb\",\"25\",{\"className\":\"\",\"href\":\"/blog/page/25\",\"children\":25}],[\"$\",\"$Lb\",\"26\",{\"className\":\"\",\"href\":\"/blog/page/26\",\"children\":26}],[\"$\",\"$Lb\",\"27\",{\"className\":\"\",\"href\":\"/blog/page/27\",\"children\":27}],[\"$\",\"$Lb\",\"28\",{\"className\":\"\",\"href\":\"/blog/page/28\",\"children\":28}],[\"$\",\"$Lb\",\"29\",{\"className\":\"\",\"href\":\"/blog/page/29\",\"children\":29}],[\"$\",\"$Lb\",\"30\",{\"className\":\"\",\"href\":\"/blog/page/30\",\"children\":30}],[\"$\",\"$Lb\",\"31\",{\"className\":\"\",\"href\":\"/blog/page/31\",\"children\":31}],[\"$\",\"$Lb\",\"32\",{\"className\":\"\",\"href\":\"/blog/page/32\",\"children\":32}],[\"$\",\"$Lb\",\"33\",{\"className\":\"\",\"href\":\"/blog/page/33\",\"children\":33}],[\"$\",\"$Lb\",\"34\",{\"className\":\"\",\"href\":\"/blog/page/34\",\"children\":34}],[\"$\",\"$Lb\",\"35\",{\"className\":\"\",\"href\":\"/blog/page/35\",\"children\":35}],[\"$\",\"$Lb\",\"36\",{\"className\":\"\",\"href\":\"/blog/page/36\",\"children\":36}],[\"$\",\"$Lb\",\"37\",{\"className\":\"\",\"href\":\"/blog/page/37\",\"children\":37}],[\"$\",\"$Lb\",\"38\",{\"className\":\"\",\"href\":\"/blog/page/38\",\"children\":38}],[\"$\",\"$Lb\",\"39\",{\"className\":\"\",\"href\":\"/blog/page/39\",\"children\":39}],[\"$\",\"$Lb\",\"40\",{\"className\":\"\",\"href\":\"/blog/page/40\",\"children\":40}],[\"$\",\"$Lb\",\"41\",{\"className\":\"\",\"href\":\"/blog/page/41\",\"children\":41}],[\"$\",\"$Lb\",\"42\",{\"className\":\"\",\"href\":\"/blog/page/42\",\"children\":42}],[\"$\",\"$Lb\",\"43\",{\"className\":\"\",\"href\":\"/blog/page/43\",\"children\":43}],[\"$\",\"$Lb\",\"44\",{\"className\":\"\",\"href\":\"/blog/page/44\",\"children\":44}],[\"$\",\"$Lb\",\"45\",{\"className\":\"\",\"href\":\"/blog/page/45\",\"children\":45}],[\"$\",\"$Lb\",\"46\",{\"className\":\"\",\"href\":\"/blog/page/46\",\"children\":46}],[\"$\",\"$Lb\",\"47\",{\"className\":\"\",\"href\":\"/blog/page/47\",\"children\":47}],[\"$\",\"$Lb\",\"48\",{\"className\":\"\",\"href\":\"/blog/page/48\",\"children\":48}],[\"$\",\"$Lb\",\"49\",{\"className\":\"\",\"href\":\"/blog/page/49\",\"children\":49}],[\"$\",\"$Lb\",\"50\",{\"className\":\"\",\"href\":\"/blog/page/50\",\"children\":50}],[\"$\",\"$Lb\",\"51\",{\"className\":\"\",\"href\":\"/blog/page/51\",\"children\":51}],[\"$\",\"$Lb\",\"52\",{\"className\":\"\",\"href\":\"/blog/page/52\",\"children\":52}],[\"$\",\"$Lb\",\"53\",{\"className\":\"\",\"href\":\"/blog/page/53\",\"children\":53}],[\"$\",\"$Lb\",\"54\",{\"className\":\"\",\"href\":\"/blog/page/54\",\"children\":54}],[\"$\",\"$Lb\",\"55\",{\"className\":\"\",\"href\":\"/blog/page/55\",\"children\":55}],[\"$\",\"$Lb\",\"56\",{\"className\":\"\",\"href\":\"/blog/page/56\",\"children\":56}],[\"$\",\"$Lb\",\"57\",{\"className\":\"\",\"href\":\"/blog/page/57\",\"children\":57}],[\"$\",\"$Lb\",\"58\",{\"className\":\"\",\"href\":\"/blog/page/58\",\"children\":58}],[\"$\",\"$Lb\",\"59\",{\"className\":\"\",\"href\":\"/blog/page/59\",\"children\":59}],[\"$\",\"$Lb\",\"60\",{\"className\":\"\",\"href\":\"/blog/page/60\",\"children\":60}],[\"$\",\"$Lb\",\"61\",{\"className\":\"\",\"href\":\"/blog/page/61\",\"children\":61}],[\"$\",\"$Lb\",\"62\",{\"className\":\"\",\"href\":\"/blog/page/62\",\"children\":62}],[\"$\",\"$Lb\",\"63\",{\"className\":\"\",\"href\":\"/blog/page/63\",\"children\":63}],[\"$\",\"$Lb\",\"64\",{\"className\":\"\",\"href\":\"/blog/page/64\",\"children\":64}],[\"$\",\"$Lb\",\"65\",{\"className\":\"\",\"href\":\"/blog/page/65\",\"children\":65}],[\"$\",\"$Lb\",\"66\",{\"className\":\"\",\"href\":\"/blog/page/66\",\"children\":66}],[\"$\",\"$Lb\",\"67\",{\"className\":\"\",\"href\":\"/blog/page/67\",\"children\":67}],[\"$\",\"$Lb\",\"68\",{\"className\":\"\",\"href\":\"/blog/page/68\",\"children\":68}],[\"$\",\"$Lb\",\"69\",{\"className\":\"\",\"href\":\"/blog/page/69\",\"children\":69}],[\"$\",\"$Lb\",\"70\",{\"className\":\"\",\"href\":\"/blog/page/70\",\"children\":70}],[\"$\",\"$Lb\",\"71\",{\"className\":\"\",\"href\":\"/blog/page/71\",\"children\":71}],[\"$\",\"$Lb\",\"72\",{\"className\":\"\",\"href\":\"/blog/page/72\",\"children\":72}],[\"$\",\"$Lb\",\"73\",{\"className\":\"\",\"href\":\"/blog/page/73\",\"children\":73}],[\"$\",\"$Lb\",\"74\",{\"className\":\"\",\"href\":\"/blog/page/74\",\"children\":74}],[\"$\",\"$Lb\",\"75\",{\"className\":\"\",\"href\":\"/blog/page/75\",\"children\":75}],[\"$\",\"$Lb\",\"76\",{\"className\":\"\",\"href\":\"/blog/page/76\",\"children\":76}],[\"$\",\"$Lb\",\"77\",{\"className\":\"\",\"href\":\"/blog/page/77\",\"children\":77}],[\"$\",\"$Lb\",\"78\",{\"className\":\"\",\"href\":\"/blog/page/78\",\"children\":78}],[\"$\",\"$Lb\",\"79\",{\"className\":\"\",\"href\":\"/blog/page/79\",\"children\":79}],[\"$\",\"$Lb\",\"80\",{\"className\":\"\",\"href\":\"/blog/page/80\",\"children\":80}],[\"$\",\"$Lb\",\"81\",{\"className\":\"\",\"href\":\"/blog/page/81\",\"children\":81}]]}]]}],null]}]\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Patrick Desjardins Blog - Using Migration DbMigration class for Up and Down action\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"Using Migration DbMigration class for Up and Down action\"}]]\n6:null\n"])</script></body></html>